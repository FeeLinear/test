var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.arrayFromIterator=function(a){for(var b,f=[];!(b=a.next()).done;)f.push(b.value);return f};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,f){if(a==Array.prototype||a==Object.prototype)return a;a[b]=f.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var f=a[b];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var f=$jscomp.propertyToPolyfillSymbol[b];if(null==f)return a[b];f=a[f];return void 0!==f?f:a[b]};$jscomp.polyfill=function(a,b,f,g){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,f,g):$jscomp.polyfillUnisolated(a,b,f,g))};
$jscomp.polyfillUnisolated=function(a,b,f,g){f=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var e=a[g];if(!(e in f))return;f=f[e]}a=a[a.length-1];g=f[a];b=b(g);b!=g&&null!=b&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,f,g){var e=a.split(".");a=1===e.length;g=e[0];g=!a&&g in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var h=0;h<e.length-1;h++){var m=e[h];if(!(m in g))return;g=g[m]}e=e[e.length-1];f=$jscomp.IS_SYMBOL_NATIVE&&"es6"===f?g[e]:null;b=b(f);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==f&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):
$jscomp.POLYFILL_PREFIX+e),$jscomp.defineProperty(g,$jscomp.propertyToPolyfillSymbol[e],{configurable:!0,writable:!0,value:b})))};
$jscomp.getConstructImplementation=function(){function a(){function f(){}new f;Reflect.construct(f,[],function(){});return new f instanceof f}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(f,g,e){f=b(f,g);e&&Reflect.setPrototypeOf(f,e.prototype);return f}}return function(f,g,e){void 0===e&&(e=f);e=$jscomp.objectCreate(e.prototype||Object.prototype);return Function.prototype.apply.call(f,e,g)||
e}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(f){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var f=$jscomp.setPrototypeOf;f(a,b)}else for(f in b)if("prototype"!=f)if(Object.defineProperties){var g=Object.getOwnPropertyDescriptor(b,f);g&&Object.defineProperty(a,f,g)}else a[f]=b[f];a.superClass_=b.prototype};$jscomp.generator={};
$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};
$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};
$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype.return=function(a){this.abruptCompletion_={return:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};
$jscomp.generator.Context.prototype.yieldAll=function(a,b){a=$jscomp.makeIterator(a);var f=a.next();$jscomp.generator.ensureIteratorResultIsObject_(f);if(f.done)this.yieldResult=f.value,this.nextAddress=b;else return this.yieldAllIterator_=a,this.yield(f.value,b)};$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};
$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,f){f?this.finallyContexts_[f]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){b=this.finallyContexts_.splice(b||0)[0];if(b=this.abruptCompletion_=this.abruptCompletion_||b){if(b.isException)return this.jumpToErrorHandler_();void 0!=b.jumpTo&&this.finallyAddress_<b.jumpTo?(this.nextAddress=b.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(f){return{value:f,done:!0}},a,this.context_.return);this.context_.return(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,f){try{var g=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(g);if(!g.done)return this.context_.stop_(),g;var e=g.value}catch(h){return this.context_.yieldAllIterator_=null,this.context_.throw_(h),this.nextStep_()}this.context_.yieldAllIterator_=null;f.call(this.context_,e);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a.return,done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this.throw=function(b){return a.throw_(b)};this.return=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){b=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(b,a.prototype);return b};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(g){return a.next(g)}function f(g){return a.throw(g)}return new Promise(function(g,e){function h(m){m.done?g(m.value):Promise.resolve(m.value).then(b,f).then(h,e)}h(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(f,g){try{return b(f,g),!0}catch(e){return!1}}}return null},"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(e,h){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:h})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var f=0,g=function(e){if(this instanceof g)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+f++,e)};return g},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<b.length;f++){var g=$jscomp.global[b[f]];"function"===typeof g&&"function"!=typeof g.prototype[a]&&$jscomp.defineProperty(g.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function f(m){return m instanceof e?m:new e(function(l,n){l(m)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(m){if(null==this.batch_){this.batch_=[];var l=this;this.asyncExecuteFunction(function(){l.executeBatch_()})}this.batch_.push(m)};
var g=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(m){g(m,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var m=this.batch_;this.batch_=[];for(var l=0;l<m.length;++l){var n=m[l];m[l]=null;try{n()}catch(p){this.asyncThrow_(p)}}}this.batch_=null};b.prototype.asyncThrow_=function(m){this.asyncExecuteFunction(function(){throw m;})};var e=function(m){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var l=this.createResolveAndReject_();
try{m(l.resolve,l.reject)}catch(n){l.reject(n)}};e.prototype.createResolveAndReject_=function(){function m(p){return function(q){n||(n=!0,p.call(l,q))}}var l=this,n=!1;return{resolve:m(this.resolveTo_),reject:m(this.reject_)}};e.prototype.resolveTo_=function(m){if(m===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(m instanceof e)this.settleSameAsPromise_(m);else{a:switch(typeof m){case "object":var l=null!=m;break a;case "function":l=!0;break a;default:l=!1}l?this.resolveToNonPromiseObj_(m):
this.fulfill_(m)}};e.prototype.resolveToNonPromiseObj_=function(m){var l=void 0;try{l=m.then}catch(n){this.reject_(n);return}"function"==typeof l?this.settleSameAsThenable_(l,m):this.fulfill_(m)};e.prototype.reject_=function(m){this.settle_(2,m)};e.prototype.fulfill_=function(m){this.settle_(1,m)};e.prototype.settle_=function(m,l){if(0!=this.state_)throw Error("Cannot settle("+m+", "+l+"): Promise already settled in state"+this.state_);this.state_=m;this.result_=l;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};e.prototype.scheduleUnhandledRejectionCheck_=function(){var m=this;g(function(){if(m.notifyUnhandledRejection_()){var l=$jscomp.global.console;"undefined"!==typeof l&&l.error(m.result_)}},1)};e.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var m=$jscomp.global.CustomEvent,l=$jscomp.global.Event,n=$jscomp.global.dispatchEvent;if("undefined"===typeof n)return!0;"function"===typeof m?m=new m("unhandledrejection",{cancelable:!0}):
"function"===typeof l?m=new l("unhandledrejection",{cancelable:!0}):(m=$jscomp.global.document.createEvent("CustomEvent"),m.initCustomEvent("unhandledrejection",!1,!0,m));m.promise=this;m.reason=this.result_;return n(m)};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var m=0;m<this.onSettledCallbacks_.length;++m)h.asyncExecute(this.onSettledCallbacks_[m]);this.onSettledCallbacks_=null}};var h=new b;e.prototype.settleSameAsPromise_=function(m){var l=this.createResolveAndReject_();
m.callWhenSettled_(l.resolve,l.reject)};e.prototype.settleSameAsThenable_=function(m,l){var n=this.createResolveAndReject_();try{m.call(l,n.resolve,n.reject)}catch(p){n.reject(p)}};e.prototype.then=function(m,l){function n(u,D){return"function"==typeof u?function(F){try{p(u(F))}catch(z){q(z)}}:D}var p,q,v=new e(function(u,D){p=u;q=D});this.callWhenSettled_(n(m,p),n(l,q));return v};e.prototype.catch=function(m){return this.then(void 0,m)};e.prototype.callWhenSettled_=function(m,l){function n(){switch(p.state_){case 1:m(p.result_);
break;case 2:l(p.result_);break;default:throw Error("Unexpected state: "+p.state_);}}var p=this;null==this.onSettledCallbacks_?h.asyncExecute(n):this.onSettledCallbacks_.push(n);this.isRejectionHandled_=!0};e.resolve=f;e.reject=function(m){return new e(function(l,n){n(m)})};e.race=function(m){return new e(function(l,n){for(var p=$jscomp.makeIterator(m),q=p.next();!q.done;q=p.next())f(q.value).callWhenSettled_(l,n)})};e.all=function(m){var l=$jscomp.makeIterator(m),n=l.next();return n.done?f([]):new e(function(p,
q){function v(F){return function(z){u[F]=z;D--;0==D&&p(u)}}var u=[],D=0;do u.push(void 0),D++,f(n.value).callWhenSettled_(v(u.length-1),q),n=l.next();while(!n.done)})};return e},"es6","es3");$jscomp.checkStringArgs=function(a,b,f){if(null==a)throw new TypeError("The 'this' value for String.prototype."+f+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+f+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,f){var g=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var e=g.length,h=b.length;f=Math.max(0,Math.min(f|0,g.length));for(var m=0;m<h&&f<e;)if(g[f++]!=b[m++])return!1;return m>=h}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(b,f){return b===f?0!==b||1/b===1/f:b!==b&&f!==f}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,f){var g=this;g instanceof String&&(g=String(g));var e=g.length;f=f||0;for(0>f&&(f=Math.max(f+e,0));f<e;f++){var h=g[f];if(h===b||Object.is(h,b))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,f){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,f||0)}},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var f=0,g=!1,e={next:function(){if(!g&&f<a.length){var h=f++;return{value:b(h,a[h]),done:!1}}g=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,f){var g=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===f&&(f=g.length);f=Math.max(0,Math.min(f|0,g.length));for(var e=b.length;0<e&&0<f;)if(g[--f]!=b[--e])return!1;return 0>=e}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(b,f,g){var e=this.length||0;0>f&&(f=Math.max(0,e+f));if(null==g||g>e)g=e;g=Number(g);0>g&&(g=Math.max(0,e+g));for(f=Number(f||0);f<g;f++)this[f]=b;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Array.from",function(a){return a?a:function(b,f,g){f=null!=f?f:function(l){return l};var e=[],h="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];if("function"==typeof h){b=h.call(b);for(var m=0;!(h=b.next()).done;)e.push(f.call(g,h.value,m++))}else for(h=b.length,m=0;m<h;m++)e.push(f.call(g,b[m],m));return e}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(f,g,e){return f==a&&"q"==g&&e==b}}));return!0===b.q}catch(f){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var p=Object.seal({}),q=Object.seal({}),v=new a([[p,2],[q,3]]);if(2!=v.get(p)||3!=v.get(q))return!1;v.delete(p);v.set(q,4);return!v.has(p)&&4==v.get(q)}catch(u){return!1}}function f(){}function g(p){var q=typeof p;return"object"===q&&null!==p||"function"===q}function e(p){if(!$jscomp.owns(p,m)){var q=new f;$jscomp.defineProperty(p,m,{value:q})}}function h(p){if(!$jscomp.ISOLATE_POLYFILLS){var q=Object[p];q&&(Object[p]=
function(v){if(v instanceof f)return v;Object.isExtensible(v)&&e(v);return q(v)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var m="$jscomp_hidden_"+Math.random();h("freeze");h("preventExtensions");h("seal");var l=0,n=function(p){this.id_=(l+=Math.random()+1).toString();if(p){p=$jscomp.makeIterator(p);for(var q;!(q=p.next()).done;)q=q.value,this.set(q[0],q[1])}};n.prototype.set=function(p,q){if(!g(p))throw Error("Invalid WeakMap key");
e(p);if(!$jscomp.owns(p,m))throw Error("WeakMap key fail: "+p);p[m][this.id_]=q;return this};n.prototype.get=function(p){return g(p)&&$jscomp.owns(p,m)?p[m][this.id_]:void 0};n.prototype.has=function(p){return g(p)&&$jscomp.owns(p,m)&&$jscomp.owns(p[m],this.id_)};n.prototype.delete=function(p){return g(p)&&$jscomp.owns(p,m)&&$jscomp.owns(p[m],this.id_)?delete p[m][this.id_]:!1};return n},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var n=Object.seal({x:4}),p=new a($jscomp.makeIterator([[n,"s"]]));if("s"!=p.get(n)||1!=p.size||p.get({x:4})||p.set({x:4},"t")!=p||2!=p.size)return!1;var q=p.entries(),v=q.next();if(v.done||v.value[0]!=n||"s"!=v.value[1])return!1;v=q.next();return v.done||4!=v.value[0].x||"t"!=v.value[1]||!q.next().done?!1:!0}catch(u){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f=new WeakMap,g=function(n){this.data_={};this.head_=m();this.size=0;if(n){n=$jscomp.makeIterator(n);for(var p;!(p=n.next()).done;)p=p.value,this.set(p[0],p[1])}};g.prototype.set=function(n,p){n=0===n?0:n;var q=e(this,n);q.list||(q.list=this.data_[q.id]=[]);q.entry?q.entry.value=p:(q.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:n,value:p},q.list.push(q.entry),
this.head_.previous.next=q.entry,this.head_.previous=q.entry,this.size++);return this};g.prototype.delete=function(n){n=e(this,n);return n.entry&&n.list?(n.list.splice(n.index,1),n.list.length||delete this.data_[n.id],n.entry.previous.next=n.entry.next,n.entry.next.previous=n.entry.previous,n.entry.head=null,this.size--,!0):!1};g.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=m();this.size=0};g.prototype.has=function(n){return!!e(this,n).entry};g.prototype.get=function(n){return(n=
e(this,n).entry)&&n.value};g.prototype.entries=function(){return h(this,function(n){return[n.key,n.value]})};g.prototype.keys=function(){return h(this,function(n){return n.key})};g.prototype.values=function(){return h(this,function(n){return n.value})};g.prototype.forEach=function(n,p){for(var q=this.entries(),v;!(v=q.next()).done;)v=v.value,n.call(p,v[1],v[0],this)};g.prototype[Symbol.iterator]=g.prototype.entries;var e=function(n,p){var q=p&&typeof p;"object"==q||"function"==q?f.has(p)?q=f.get(p):
(q=""+ ++l,f.set(p,q)):q="p_"+p;var v=n.data_[q];if(v&&$jscomp.owns(n.data_,q))for(n=0;n<v.length;n++){var u=v[n];if(p!==p&&u.key!==u.key||p===u.key)return{id:q,list:v,index:n,entry:u}}return{id:q,list:v,index:-1,entry:void 0}},h=function(n,p){var q=n.head_;return $jscomp.iteratorPrototype(function(){if(q){for(;q.head!=n.head_;)q=q.previous;for(;q.next!=q.head;)return q=q.next,{done:!1,value:p(q)};q=null}return{done:!0,value:void 0}})},m=function(){var n={};return n.previous=n.next=n.head=n},l=0;
return g},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),e=new a($jscomp.makeIterator([g]));if(!e.has(g)||1!=e.size||e.add(g)!=e||1!=e.size||e.add({x:4})!=e||2!=e.size)return!1;var h=e.entries(),m=h.next();if(m.done||m.value[0]!=g||m.value[1]!=g)return!1;m=h.next();return m.done||m.value[0]==g||4!=m.value[0].x||m.value[1]!=m.value[0]?!1:h.next().done}catch(l){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var f=function(g){this.map_=new Map;if(g){g=$jscomp.makeIterator(g);for(var e;!(e=g.next()).done;)this.add(e.value)}this.size=this.map_.size};f.prototype.add=function(g){g=0===g?0:g;this.map_.set(g,g);this.size=this.map_.size;return this};f.prototype.delete=function(g){g=this.map_.delete(g);this.size=this.map_.size;return g};f.prototype.clear=function(){this.map_.clear();this.size=0};f.prototype.has=
function(g){return this.map_.has(g)};f.prototype.entries=function(){return this.map_.entries()};f.prototype.values=function(){return this.map_.values()};f.prototype.keys=f.prototype.values;f.prototype[Symbol.iterator]=f.prototype.values;f.prototype.forEach=function(g,e){var h=this;this.map_.forEach(function(m){return g.call(e,m,m,h)})};return f},"es6","es3");
$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var f=1;f<arguments.length;f++){var g=arguments[f];if(g)for(var e in g)$jscomp.owns(g,e)&&(a[e]=g[e])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(b){return"number"!==typeof b?!1:!isNaN(b)&&Infinity!==b&&-Infinity!==b}},"es6","es3");
$jscomp.polyfill("Number.isInteger",function(a){return a?a:function(b){return Number.isFinite(b)?b===Math.floor(b):!1}},"es6","es3");$jscomp.polyfill("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var f=Math.floor(Math.abs(b));return 0>b?-f:f}},"es6","es3");$jscomp.findInternal=function(a,b,f){a instanceof String&&(a=String(a));for(var g=a.length,e=0;e<g;e++){var h=a[e];if(b.call(f,h,e,a))return{i:e,v:h}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(b,f){return $jscomp.findInternal(this,b,f).i}},"es6","es3");$jscomp.polyfill("Object.values",function(a){return a?a:function(b){var f=[],g;for(g in b)$jscomp.owns(b,g)&&f.push(b[g]);return f}},"es8","es3");$jscomp.polyfill("Reflect.has",function(a){return a?a:function(b,f){return f in b}},"es6","es3");$jscomp.polyfill("Math.log2",function(a){return a?a:function(b){return Math.log(b)/Math.LN2}},"es6","es3");
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(a){return a?a:function(){return[]}},"es6","es5");$jscomp.polyfill("Reflect.ownKeys",function(a){return a?a:function(b){var f=[],g=Object.getOwnPropertyNames(b);b=Object.getOwnPropertySymbols(b);for(var e=0;e<g.length;e++)("jscomp_symbol_"==g[e].substring(0,14)?b:f).push(g[e]);return f.concat(b)}},"es6","es5");
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var f=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var g="";b;)if(b&1&&(g+=f),b>>>=1)f+=f;return g}},"es6","es3");$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};
$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(b,f){var g=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(f,b-g.length)+g}},"es8","es3");
function GLink_servlet(){function a(){this.header={frameId:null,pageId:null,indexId:null};this.body={result:null}}var b=this,f=this;NSDK.getConnect().addEventListener("status",function(e){console.log(e);var h=e.value;if(0==e.oldValue&&1==h)for(var m in g)f.service(g[m])});var g={};this.service=function(e){var h=JSON.parse(e),m=h.body,l=h.header.function,n=h=null,p=null,q=null;if("send_wsQuerys"==l||"send_httpQuerys"==l){e=m.packge;for(var v=0;v<e.length;v++){var u=e[v].querys;if(null!=u)for(var D=
0;D<u.length;D++)u[D].callback=b.serviceResponse}}else{h=m.frameId;n=m.pageId;p=m.index;q=h+"-"+n+"-"+p;if(1!=NSDK.getConnect().status){g[q]=e;return}e=null!=g[q]?!0:!1;1==e&&null!=g[q]&&delete g[q]}switch(l){case "sendMessage":l=m.type;m=m.queryInfo;G_HeartbeatManager.sharedInstance().addHeartbeatObj(h,q);sendMessage(l,h,n,p,m,b.serviceResponse);break;case "postHttpMessage":postHttpMessage(m.type,h,n,p,m.queryInfo,m.queryIndex,b.serviceResponse);break;case "send_wsQuerys":send_wsQuerys(m.packge);
break;case "send_httpQuerys":send_httpQuerys(m.packge)}};this.serviceResponse=function(e){var h=e.gid,m=h.fm,l=h.pg;h=h.idx;var n=new a;n.header.frameId=m;n.header.pageId=l;n.header.indexId=h;n.body.result=e.data.result;"undefined"!=typeof GLink_client&&"undefined"!=typeof window&&"undefined"!=typeof window.GUIFrameCounter&&window.GUIFrameCounter==m?GLink_client.sharedInstance().receiveMessage(n):"undefined"!=typeof GLink_client&&"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&"GUI_Widget"==
m?GLink_client.sharedInstance().receiveMessage(n):"undefined"!=typeof GLink_client&&"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&"cpp"==getEnvInfo()?GLink_client.sharedInstance().receiveMessage(n):"undefined"!=typeof GLink_client&&"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&-1!=m.indexOf("3")?GLink_client.sharedInstance().receiveMessage(n):localStorage.setItem("G_Response",JSON.stringify(n))};G_HeartbeatManager.sharedInstance().start()}
GLink_servlet.sharedInstance=function(){null==this.instance&&(this.instance=new GLink_servlet);return this.instance};
function G_HeartbeatManager(){function a(){var e=this;this.ExpireTime=(new Date).getTime()+6E4;this.fmId=null;this.idMap={};this.setId=function(h){e.idMap[h]=!0};this.delId=function(h){null!=e.idMap[h]&&delete e.idMap[h]}}function b(){for(var e in g){var h=g[e],m=(new Date).getTime();if(("undefined"==typeof window||"undefined"==typeof window.GUIFrameCounter||null==window.GUIFrameCounter||window.GUIFrameCounter!=e)&&"GUI_Widget"!=e&&h.ExpireTime<m){m=void 0;var l=h.idMap;for(m in l)l=m.split("-"),
sendMessage("cancel",l[0],l[1],l[2]);f.delHeartbeatObj(h.fmId)}}}var f=this,g={};this.addHeartbeatObj=function(e,h){var m=g[e];null==m&&(g[e]=new a,m=g[e],m.fmId=e);m.setId(h)};this.delHeartbeatObj=function(e){null!=g[e]&&delete g[e]};this.setExpireTimeWithFmId=function(e){e=g[e];if(null!=e){var h=(new Date).getTime();e.ExpireTime=parseInt(h)+6E4}};this.start=function(){"undefined"!=typeof window?window.setInterval(b,1E4):console.log("\u627e\u4e0d\u5230window\u5bf9\u8c61")}}
G_HeartbeatManager.sharedInstance=function(){null==this.instance&&(this.instance=new G_HeartbeatManager);return this.instance};
if("undefined"!=typeof window){var androidGetStorage=function(){0==window.storageCanUse&&setTimeout(function(){var a=localStorage.getItem("G_Request"),b=localStorage.getItem("G_Heartbeat");null!=a&&window.oldG_RequestValue!=a&&(window.oldG_RequestValue=a,GLink_servlet.sharedInstance().service(a));null!=b&&window.oldG_HeartbeatValue!=b&&(a=b.split("#")[0],window.oldG_HeartbeatValue=b,G_HeartbeatManager.sharedInstance().setExpireTimeWithFmId(a));androidGetStorage()},1)};window.storageCanUse=!1;window.addEventListener("storage",
function(a){window.storageCanUse=!0;"G_Request"==a.key?GLink_servlet.sharedInstance().service(a.newValue):"G_Heartbeat"==a.key&&(a=a.newValue,a=a.split("#")[0],G_HeartbeatManager.sharedInstance().setExpireTimeWithFmId(a))});window.addEventListener("beforeunload",function(a){clear_sdk_storage()});window.addEventListener("pagehide",function(){clear_sdk_storage()});var ua=navigator.userAgent;if(0<=ua.indexOf("Android")){var androidversion=parseFloat(ua.slice(ua.indexOf("Android")+8));10>androidversion&&
androidGetStorage()}}function clear_sdk_storage(){localStorage.setItem("G_Close",!0);localStorage.removeItem("G_Close");localStorage.removeItem("G_Response");localStorage.removeItem("G_Request");localStorage.removeItem("G_frameCounter")};function XEnDecoder(a){var b=this,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";if(a){a+="";for(var g=0,e=0;e<a.length;e++)g+=a.charCodeAt(e)+e;for(a=0;2>a;a++){var h=3.141592653589793;for(e=0;8>e;e++){h*=h;var m=(g*h+"").split(".");m=(m[0]+m[1]).substr(0,16);m=parseInt(m);for(var l=0;8>l;l++){var n=m%100;n%=f.length;m=parseInt(m/100);var p=m%100;m=parseInt(m/100);if(0<n&&n<f.length-1)if(n+p>=f.length){p=f.length-n;var q=f.substr(0,n),v=f.substr(n,p);f=v+q}else q=f.substr(0,
n),v=f.substr(n,p),n=f.substr(n+p),f=v+q+n}}}}this.encode=function(B){var t="",G,x=0;B=B.replace(/\r\n/g,"\n");var J="";for(G=0;G<B.length;G++){var A=B.charCodeAt(G);128>A?J+=String.fromCharCode(A):(127<A&&2048>A?J+=String.fromCharCode(A>>6|192):(J+=String.fromCharCode(A>>12|224),J+=String.fromCharCode(A>>6&63|128)),J+=String.fromCharCode(A&63|128))}for(B=J;x<B.length;){var H=B.charCodeAt(x++);J=B.charCodeAt(x++);G=B.charCodeAt(x++);A=H>>2;H=(H&3)<<4|J>>4;var I=(J&15)<<2|G>>6;var N=G&63;isNaN(J)?
I=N=64:isNaN(G)&&(N=64);t=t+f.charAt(A)+f.charAt(H)+f.charAt(I)+f.charAt(N)}return t};this.decode=function(B){var t="",G=0;for(B=B.replace(/[^A-Za-z0-9\+\/=]/g,"");G<B.length;){var x=f.indexOf(B.charAt(G++));var J=f.indexOf(B.charAt(G++));var A=f.indexOf(B.charAt(G++));var H=f.indexOf(B.charAt(G++));x=x<<2|J>>4;J=(J&15)<<4|A>>2;var I=(A&3)<<6|H;t+=String.fromCharCode(x);64!=A&&(t+=String.fromCharCode(J));64!=H&&(t+=String.fromCharCode(I))}B=t;t="";for(A=0;A<B.length;)H=B.charCodeAt(A),128>H?(t+=String.fromCharCode(H),
A++):191<H&&224>H?(G=B.charCodeAt(A+1),t+=String.fromCharCode((H&31)<<6|G&63),A+=2):(G=B.charCodeAt(A+1),x=B.charCodeAt(A+2),isNaN(x)||(t+=String.fromCharCode((H&15)<<12|(G&63)<<6|x&63)),A+=3);return t};var u=function(B,t,G){"("==G?G=")":"["==G&&(G="]");for(t++;t<B.length;t++)if("("==B[t]||"["==B[t]){if(t=u(B,t,B[t]),null==t)break}else if(B[t]==G)return t},D=function(B,t,G){for(t++;t<B.length;t++)if(B[t]==G)return t},F=function(B,t){a:{for(;t<B.length&&(" "==B[t]||"\t"!=B[t]);)break a;t=void 0}var G;
for(G=t;t<B.length;t++)if("["==B[t])t=u(B,t,B[t]);else if(" "==B[t]||"\t"==B[t]||"\n"==B[t]||";"==B[t]||","==B[t]||"?"==B[t]||":"==B[t]||"{"==B[t]||"("==B[t]||'"'==B[t]||"'"==B[t])return{i:t,word:B.substr(G,t-G)};return{i:t,word:B.substr(G)}},z=function(){var B=parseInt(64*Math.random())%16;10>B&&(B=10);for(var t="",G=0;G<B;G++){var x=parseInt(100*Math.random())%54;t+="ABuvwxyz_456CDEFG$123HIJKLMWXYZabcdefgNOPQRSTUVhijklmnopqrst7890"[x]}return"0"<=t[0]&&"9">=t[0]?z():t},y=function(B){for(var t="",
G=0,x=0;x<B.length;x++)if("("==B[x]||"["==B[x]){t+=B.substr(G,x-G+1);G=x;x=u(B,x,B[x]);if(null==x)return;G=y(B.substr(G+1,x-G-1));t+=G.code;G=x}else if('"'==B[x]||"'"==B[x]){var J=B[x],A="";t+=B.substr(G,x-G+1);for(x++;x<B.length;x++){if(B[x]==J){G=x;t+=A;break}A+="\\x"+B.charCodeAt(x).toString(16)}}x>G&&(t+=B.substr(G,x-G));return{i:x,code:t}};this.obfuscateJsCode=function(B){for(var t="",G=0,x,J=[],A=0;A<B.length;A++)if("("==B[A]||"["==B[A]){if(A=u(B,A,B[A]),null==A)return}else if('"'==B[A]||"'"==
B[A]){if(A=D(B,A,B[A]),null==A)return}else if("/"!=B[A]||"/"!=B[A+1]&&"*"!=B[A+1])if("\n"==B[A]||" "==B[A]||"\t"==B[A])t+=B.substr(G,A-G),G=A+1;else{x=F(B,A);if(null==x)return;A=x.i;if("var"==x.word){A++;x=F(B,A);if(null==x)return;J.push({word:x.word,name:z()});A=x.i}("a"<=x.word[0]&&"z">=x.word[0]||"A"<=x.word[0]&&"Z">=x.word[0])&&"("==B[A]&&(G=b.encode(x.word),t+=G,G=A)}else if(x=A,"/"==B[A+1])for(A+=2;A<B.length;A++){if("\n"==B[A]){t+=B.substr(G,x-G);G=A+2;break}}else for(A+=2;A<B.length;A++)if("*"==
B[A]&&"/"==B[A+1]){t+=B.substr(G,x-G);G=A+2;break}A>G&&(t+=B.substr(G,A-G));for(A=0;A<J.length;A++)x="newCode = newCode.replace(/(\\b"+J[A].word+"\\b)/g,'"+J[A].name+"')",eval(x);if(t=y(t))return t.code}};function XGtsJason(a){function b(t){var G=h[t++],x=-1;if(1!=G&&13!=G&&8!=G&&3!=G){x=0;if(28==h[t]){var J=1;var A=0;for(t++;2>A;t++,A++)x+=(h[t]-32)*J,J*=223}else if(29==h[t])for(J=1,A=0,t++;3>A;t++,A++)x+=(h[t]-32)*J,J*=223;else x=h[t++]-32;if(2==G||4==G)return e=g?e+('"'+g[x][1]+'"'):e+'""',t}J="";if(14!=G&&9!=G)for(;t<h.length&&27<=h[t]&&30!=h[t];t++){A=h[t].toString(2);var H=A.match(/^1+?(?=0)/);if(H&&8==A.length){A=H[0].length;H=h[t].toString(2).slice(7-A);for(var I=1;I<A;I++)H+=h[I+t].toString(2).slice(2);
J+=String.fromCharCode(parseInt(H,2));t+=A-1}else 27==h[t]?(J="r"==h[t+1]?J+"\r":"n"==h[t+1]?J+"\n":"t"==h[t+1]?J+"\t":J+" ",t++):J+=String.fromCharCode(h[t])}if(g)switch(G){case 14:case 9:e+='"'+g[x][1]+'"';break;case 15:case 10:e=g[x]&&g[x][1]&&g[x][2]?e+('"'+g[x][1]+J+g[x][2]+'"'):e+'""';break;case 16:case 11:e+='"'+g[x][1]+J+'"';break;case 17:case 12:e+='"'+J+g[x][1]+'"';break;default:e+='"'+J+'"'}else e+='"'+J+'"';return t}function f(t){for(e+="{";t<h.length;){t=b(t);e+=":";switch(h[t]){case 6:case 8:case 9:case 10:case 11:case 12:case 18:case 19:case 20:case 21:t=
l(t);break;case 1:case 2:t=f(t);break;case 13:case 14:case 15:case 16:case 17:t=b(t);break;case 7:e+="[]";t++;break;case 5:e+="{}";t++;break;default:t=m(t)}if(-1==t)break;if(5==h[t]){e+="}";t++;break}else e+=","}return t}var g=a,e,h,m=function(t){var G=h[t],x=0,J=1,A=1,H=1;t++;switch(G){case 21:case 25:J=-1;case 19:case 23:A=100;break;case 20:case 24:J=-1;break;case 30:return e+="null",t}if(26==h[t]){x=h[t+1];x-=32;H=10;for(G=1;G<x;G++)H*=10;x=h[t+1]-32;t+=2}G=h[t]-32;var I=223;for(t++;32<=h[t];t++)G+=
(h[t]-32)*I,I*=223;G*=A;-1==J&&(G*=-1);e=0==x?e+G:e+(G/H).toFixed(x);return t},l=function(t){e+="[";switch(h[t]){case 6:t++;if(7==h[t])return t++,e+="]",t;break;case 8:case 9:case 10:case 11:case 12:t=b(t);if(-1==t)return-1;if(7==h[t])return e+="]",t++,t;e+=",";break;case 18:case 19:case 20:case 21:t=m(t);if(-1==t)return-1;if(7==h[t])return e+="]",t++,t;e+=",";break;case 7:return e+="[]",t++,t;case 5:return e+="{}",t++,t;default:return t}for(;t<h.length;){switch(h[t]){case 6:case 8:case 9:case 10:case 11:case 12:case 18:case 19:case 20:case 21:t=
l(t);break;case 1:case 2:t=f(t);break;case 13:case 14:case 15:case 16:case 17:t=b(t);break;case 7:e+="[]";t++;break;case 5:e+="{}";t++;break;default:t=m(t)}if(-1==t)break;if(7==h[t])return e+="]",t++,t;e+=","}return-1};this.decompress_json=function(t){e="";h=t;for(t=0;t<h.length;t++){if(6==h[t])t=l(t);else if(1==h[t]||2==h[t])t=f(t);if(-1==t)break}return e};var n=function(t,G){for(var x=0;x<G;x++)if(13==t[x]||10==t[x]||9==t[x]){for(var J=G;J>x;J--)t[J]=t[J-1];t[x+1]=13==t[x]?"r":10==t[x]?"n":9==t[x]?
"t":" ";t[x]=27;G++}return G},p=function(t){if(223>t)e.push(t+32);else for(49729>t?e.push(28):e.push(29),offset=1;0<t;offset++)e.push(t%223+32),t=parseInt(t/223)},q=function(t){for(var G=0;G<t.length;G++)e.push(t[G])},v=function(t,G){if(3<=t.length){if(g){if(g.s&&g.s.key&&null!=g.s[t]&&(G=g.s[t],-1!=G))return p(G),14;if(g.h)for(G=0;G<g.h.length;G++){var x=g[g.h[G]][1].length;if(t.substr(0,x)==g[g.h[G]][1])return p(g.h[G]),q(B(t.substr(x))),n(e),16}if(g.t)for(G=0;G<g.t.length;G++)if(x=g[g.t[G]][1].length,
t.length>=x&&t.substr(t.length-x)==g[g.t[G]][1])return p(g.t[G]),q(B(t.substr(0,t.length-x))),n(e),17;if(g.ht)for(G=0;G<g.ht.length;G++){var J=g[g.ht[G]][1],A=g[g.ht[G]][2],H=J.length;x=A.length;if(t.length>H&&t.substr(0,H)==J&&t.length>x&&t.substr(t.length-x)==A)return p(g.ht[G]),q(B(t.substr(H,t.length-x-H))),n(e),15}}q(B(t));n(e)}else q(B(t));return 13},u=function(t){for(;t<h.length&&(" "==h[t]||"\t"==h[t]||"\r"==h[t]||"\n"==h[t]);t++);return t},D=function(t,G){var x=G;for(G++;G<h.length;G++)if('"'==
h[G]){var J=e.length;e.push(0);G++;x=v(h.substr(x+1,G-x-2),G);if("["==t)switch(x){case 16:e[J]=11;break;case 17:e[J]=12;break;case 15:e[J]=10;break;case 14:e[J]=9;break;default:e[J]=8}else e[J]=x;return G}return-1},F=function(t,G){G=u(G);if("null"==h.substr(G,4))return"["==t&&e.push(6),e.push(30),G+4;var x=G,J=0,A=0,H=1;for("-"==h[G]&&(H=-1);G<h.length;G++)if("."==h[G]?(J=1,x=G+1):J&&(J*=10,A++),","==h[G]||"}"==h[G]||"]"==h[G]){var I=parseInt(h.substr(x,G-x));J&&A&&(0>I&&(I*=-1),I*=J/10,I+=parseInt(h.substr(x)));
"["==t?0>H?(0>I&&(I*=-1),0==I%100?(e.push(21),I=parseInt(I/100)):e.push(20)):0==I%100?(e.push(19),I=parseInt(I/100)):e.push(18):0>H?(0>I&&(I*=-1),0==I%100?(e.push(25),I=parseInt(I/100)):e.push(24)):0==I%100?(e.push(23),I=parseInt(I/100)):e.push(22);J&&A&&(e.push(26),e.push(32+A-1));for(t=0;e.push(32+I%223),I=parseInt(I/223),0!=I;t++);return G}return-1},z=function(t){t=u(t);var G="[";if("]"==h[t])return e.push(6),e.push(7),t++,t;for(;t<h.length;){"["==h[t]?(t++,"["==G&&e.push(6),t=z(t)):"{"==h[t]?
(t++,"["==G&&e.push(6),t=y(t)):t='"'==h[t]?D(G,t):F(G,t);if(-1==t)break;G=0;t=u(t);if(","==h[t])t++,t=u(t);else{if("]"==h[t])return t++,e.push(7),t;break}}return-1},y=function(t){var G="{";var x=t;if("}"==h[t])return e.push(5),t++,t;for(t++;t<h.length;t++)if('"'==h[t]){var J=e.length;e.push(0);t++;x=h.substr(x+1,t-x-2);x=v(x,t);if("{"==G)switch(x){case 15:case 16:case 17:case 14:e[J]=2;break;default:e[J]=1}else switch(x){case 15:case 16:case 17:case 14:e[J]=4;break;default:e[J]=3}t=u(t);if(":"!=h[t])break;
t++;t=u(t);"["==h[t]?(t++,t=z(t)):"{"==h[t]?(t++,t=y(t)):t='"'==h[t]?D(":",t):F(":",t);if(-1==t)break;G=0;t=u(t);if(","==h[t]){t++;t=u(t);if('"'!=h[t])break;x=t}else{if("}"==h[t])return t++,e.push(5),t;break}}return-1};this.compress_json=function(t,G){if(null==G||0>G)G=0;var x=0;h=t;for(e=[];x<h.length;x++)if("["==h[x]?(x++,x=z(x)):"{"==h[x]&&(x++,x=y(x)),-1==x)return null;t=new ArrayBuffer(e.length+G);t=new Uint8Array(t);for(x=0;x<e.length;x++)t[x+G]=e[x]%255;return t};var B=function(t){for(var G=
[],x,J=0;J<t.length;J++)x=t.charCodeAt(J),65536<=x&&1114111>=x?(G.push(x>>18&7|240),G.push(x>>12&63|128),G.push(x>>6&63|128),G.push(x&63|128)):2048<=x&&65535>=x?(G.push(x>>12&15|224),G.push(x>>6&63|128),G.push(x&63|128)):128<=x&&2047>=x?(G.push(x>>6&31|192),G.push(x&63|128)):G.push(x&255);return G};(function(){if(g&&null==g.s)for(var t=0;t<g.length;t++)switch(g[t][0]){case 0:null==g.s&&(g.s={});null==g.s[g[t][1]]&&(g.s[g[t][1]]=t);break;case 1:null==g.h&&(g.h=[]);g.h.push(t);break;case 2:null==g.t&&
(g.t=[]);g.t.push(t);break;case 3:null==g.ht&&(g.ht=[]);g.ht.push(t);break;case 4:null==g.a&&(g.a=[]),g.a.push(t)}})()};function XLocalCache(){var a={},b=0;this.save=function(f){var g=f.result;if(g)for(var e=f.nameList,h=0;h<g.length;h++){var m=!1;if(e[h]&&e[h].query&&e[h].query.parse){var l=e[h].query.parse,n=l.tableName;l.at&&(n+=" at "+l.at);l.resample&&(n+=" "+l.resample);l=""+l.tableKeys+" @ "+l.fieldKey;a&&a[n]&&a[n][l]&&(m=!0)}if((m||g[h]&&1!=g[h].localCache&&g[h].table&&g[h].table.info&&"col"==g[h].table.info.rank&&g[h].table.info.q&2)&&e[h].query&&e[h].query.parse)if(l=e[h].query.parse,n=l.tableName,l.at&&
(n+=" at "+l.at),l.resample&&(n+=" "+l.resample),l=""+l.tableKeys+" @ "+l.fieldKey,null==a[n]&&(a[n]={}),m=g[h].table,m.clear)delete a[n][l];else{if(null==a[n][l]||null==a[n][l].data||0==a[n][l].data.length){b++;if(100<b){b--;var p=void 0,q=void 0,v=void 0,u=void 0;for(p in a)for(var D in a[p])null==u?(u=a[p][D].last_access_time,v=p,q=D):u>a[p][D].last_access_time&&(u=a[p][D].last_access_time,v=p,q=D);delete a[v][q]}a[n][l]=xDeepCopy(m)}else{p=a[n][l];if(null==p||null==p.data)a[n][l]=xDeepCopy(m);
else if(m.info.d==p.info.d&&m.info.ldt==p.info.ldt&&m.info.totalRows>=p.info.totalRows){q=p.info;v=m.field;u=p.field;var F=m.data,z=p.data,y=m.flags,B=p.flags,t,G;if(m.info.dataBegin>=p.info.dataBegin)if(m.info.dataBegin>p.info.dataBegin+p.info.dataRows)a[n][l]=xDeepCopy(m);else{var x=m.info.dataBegin-p.info.dataBegin;var J=p.info.dataBegin+p.info.dataRows-(m.info.dataBegin+m.info.dataRows);for(t=0;t<u.length;t++)for(G=0;G<v.length;G++){var A=v[G][0].toLowerCase();if(A==u[t][0].toLowerCase()){G=z[t].slice(0,
x).concat(F[G]);var H=null;B&&B[A]&&(H=B[A].slice(0,x),y&&y[A]&&(H=H.concat(y[A])));0<J&&(G=G.concat(z[t].slice(-J)),B&&B[A]&&(H=H.concat(B[A].slice(-J))));z[t]=G;B&&B[A]&&(B[A]=H);break}}q.begin=p.info.dataBegin;q.rows=z[0].length;q.dataRows=z[0].length;q.totalRows=m.info.totalRows}else if(m.info.dataBegin+m.info.dataRows<p.info.dataBegin||m.info.dataBegin+m.info.dataRows>=p.info.dataBegin+p.info.dataRows)a[n][l]=xDeepCopy(m);else{x=m.info.dataRows;for(t=0;t<u.length;t++)for(G=0;G<v.length;G++)if(A=
v[G][0].toLowerCase(),A==u[t][0].toLowerCase()){G=F[G].concat(z[t].slice(x,z[t].length));z[t]=G;B&&B[A]&&y&&y[A]&&(B[A]=y[A].concat(B[A].slice(x,B[A].length)));break}q.begin=m.info.dataBegin;q.rows=z[0].length;q.dataBegin=m.info.dataBegin;q.dataRows=z[0].length;q.totalRows=m.info.totalRows}}else if(m.info.d!=p.info.d||m.info.ldt!=p.info.ldt||m.info.totalRows<p.info.totalRows||m.info.begin==p.info.begin&&m.info.rows==p.info.rows&&m.info.totalRows==p.info.totalRows)a[n][l]=xDeepCopy(m);else if(m.info.totalRows>=
p.info.totalRows&&m.info.dataBegin<=p.info.dataBegin||null==p.data)a[n][l]=xDeepCopy(m);else if(m.info.dataBegin+m.info.dataRows<p.info.dataBegin||m.info.dataBegin>p.info.dataBegin+p.info.dataRows)a[n][l]=xDeepCopy(m);else if(x=m.info,q=p.info,v=m.field,u=p.field,F=m.data,z=p.data,y=m.flags,B=p.flags,x.dataBegin<q.dataBegin||x.dataBegin+x.dataRows>q.dataBegin+q.dataRows){for(t=0;t<u.length;t++)for(G=0;G<v.length;G++)if(A=v[G][0].toLowerCase(),A==u[t][0].toLowerCase()){G=F[G];x.begin<q.begin&&x.begin+
x.rows==q.begin+q.rows&&(z[t]=G,B&&B[A]&&y&&y[A]&&(B[A]=y[A]));break}q.begin=x.begin;q.rows=x.rows;q.dataBegin=x.dataBegin;q.dataRows=x.dataRows;for(t=0;t<u.length;t++){for(G=0;G<v.length&&v[G][0].toLowerCase()!=u[t][0].toLowerCase();G++);G==v.length&&u.push(v[G])}}g[h].cacheAll&&(f.result[h].table=xDeepCopy(a[n][l]),f.result[h].updateCounter=createUpdateCounter(f.result[h].updateCounter))}a[n][l].push&&delete a[n][l].push;a[n][l].last_access_time=(new Date).getTime()}}};this.read=function(f,g,e){if(f.callback&&
g&&e<g.length&&g[e]&&g[e].query&&g[e].query.parse){var h=g[e].query.parse,m=h.tableName;h.at&&(m+=" at "+h.at);h.resample&&(m+=" "+h.resample);var l=""+h.tableKeys+" @ "+h.fieldKey;if(a[m]&&a[m][l]){ok=!0;var n=a[m][l];null==f.result&&(f.result=[]);null==f.result[e]&&(f.result[e]={});f.result[e].table=xDeepCopy(n);f.result[e].cacheAll=void 0==g[e].query.cacheAll||1==g[e].query.cacheAll?!0:!1;f.result[e].updateCounter=createUpdateCounter(f.result[e].updateCounter);g[e].query.buffer={data:{totalRows:n.info.totalRows,
begin:n.info.dataBegin,rows:n.info.rows,diskRows:n.info.d,diskLastTime:n.info.ldt},relation:""};for(var p in n)"data"!=p&&"info"!=p&&"flags"!=p&&"field"!=p&&"push"!=p&&"dataStatus"!=p&&"last_access_time"!=p&&(g[e].query.buffer.relation&&(g[e].query.buffer.relation+=","),g[e].query.buffer.relation+=p);f.result[e].table.push&&delete f.result[e].table.push;f.result[e].subscribe=!1;if(null==n.data||0==n.data.length){g[e].query.buffer&&delete g[e].query.buffer;return}a[m][l].last_access_time=(new Date).getTime();
return!0}g[e].query.buffer&&delete g[e].query.buffer;if(f.result&&f.result[e]&&f.result[e].table){f.result[e].subscribe=!1;n=f.result[e].table;f=!0;for(g=0;g<h.field.length;g++){for(e=0;e<n.field.length&&h.field[g].toLowerCase()!=n.field[e][0].toLowerCase();e++);if(e==n.field.length){f=!1;break}}for(g=0;g<h.tableKeys.length;g++)if("'"==h.tableKeys[g][0]){if(h.tableKeys[g]!="'"+n.info.key+"'"){f=!1;break}}else if(h.tableKeys[g]!=n.info.key){f=!1;break}0==f&&(n.data&&delete n.data,n.flags&&delete n.flags,
n.info.dataBegin=0,n.info.dataRows=0,n.info.totalRows=0)}}};this.clearAll=function(){a={};b=0}};function XLocalCache(){this.save=function(a){};this.read=function(a,b,f){};this.clearAll=function(){}};var XNetwork=function(){this.env="web";this.localSend=null;"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&(this.env=getEnvInfo());this.sendCount=0;this.XMLHttpRequest="cpp"==this.env?new gwebGHttp:"undefined"!==typeof NSDK?new gwebGHttp:new XMLHttpRequest};XNetwork.pushHttpQueue=function(a,b){null==XNetwork.httpQueueList&&(XNetwork.httpQueueList=[]);XNetwork.httpQueueList.push({message:b,obj:a})};XNetwork.getHttpQueue=function(){return XNetwork.httpQueueList};
XNetwork.clearHttpQueue=function(){null!=XNetwork.httpQueueList&&(XNetwork.httpQueueList=[])};XNetwork.executeHttpQueue=function(){for(var a=0;a<XNetwork.httpQueueList.length;a++){var b=XNetwork.httpQueueList[a];b.obj.send(b.message)}XNetwork.clearHttpQueue()};XNetwork.getSendStatus=function(){return XNetwork.queueStatus};
XNetwork.prototype.setRequestHeader=function(a,b){"undefined"!==typeof NSDK?this.XMLHttpRequest.setHeader(a,b):0==this.applyLocalServer("setRequestHeader")?this.XMLHttpRequest.setRequestHeader(a,b):(this.header||(this.header={}),this.header[a]=b)};
XNetwork.prototype.open=function(a){for(var b=[],f=0;f<arguments.length;++f)b[f-0]=arguments[f];"undefined"!==typeof NSDK?(this.XMLHttpRequest.setType(b[0]),this.XMLHttpRequest.setUrl(b[1])):0==this.checkOpen.apply(this,$jscomp.arrayFromIterable(b))&&this.XMLHttpRequest.open.apply(this.XMLHttpRequest,$jscomp.arrayFromIterable(b))};
XNetwork.prototype.checkOpen=function(a){for(var b=[],f=0;f<arguments.length;++f)b[f-0]=arguments[f];return b[1]&&b[1].startsWith("proxy")?(this.protocol="proxy",this.openValues=b,!0):!1};
XNetwork.prototype.send=function(a){if("undefined"!==typeof NSDK){var b=function(f,g){var e=g.XMLHttpRequest;XNetwork.waitBackQueue.push(g);e.setBody(f);e.send().then(function(h){console.log(e,h);e.readyState=4;e.status=200;e.responseText=JSON.stringify(h);e.onreadystatechange(4);h=XNetwork.waitBackQueue.indexOf(g);XNetwork.waitBackQueue.splice(h,1);XNetwork.queueStatus=!1;h=XNetwork.getHttpQueue();null!=h&&0<h.length&&XNetwork.executeHttpQueue()}).catch(function(h){var m,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){if(1==
n.nextAddress){console.log(h);XNetwork.queueStatus=!0;null==XNetwork.curTryLoopRequest&&(XNetwork.curTryLoopRequest=g);m=XNetwork.waitBackQueue.indexOf(g);-1!=m&&XNetwork.waitBackQueue.splice(m,1);for(l=0;l<XNetwork.waitBackQueue.length;l++)XNetwork.waitBackQueue[l].XMLHttpRequest.stop();XNetwork.waitBackQueue=[];return XNetwork.curTryLoopRequest!==g?(XNetwork.pushHttpQueue(g,f),g.sendCount=0,n.return()):3==g.sendCount?("undefined"!=typeof GSession&&GSession.sharedInstance().reHttpLogin().then(function(){g.sendCount=
0;var p=e.getUrl().replace(/.*application\//i,GSession.sharedInstance().getHttpUrl());e.setUrl(p);e.setHeader("Authorization","Bearer "+GTenant.sharedInstance().getUserData().access_token);null==XNetwork.httpQueueList&&(XNetwork.httpQueueList=[]);for(var q=$jscomp.makeIterator(XNetwork.httpQueueList),v=q.next();!v.done;v=q.next())v=v.value.obj.XMLHttpRequest,v.setUrl(p),v.setHeader("Authorization","Bearer "+GTenant.sharedInstance().getUserData().access_token);b(f,g)}).catch(function(){XNetwork.clearHttpQueue();
XNetwork.queueStatus=!1;XNetwork.curTryLoopRequest=null;NSDKLog.error("SZSE:(XNetwork.send)HTTP\u8bf7\u6c42\u5931\u8d25")}),n.jumpTo(0)):[0,503].includes(e.getHttpStatus())?n.yield(new Promise(function(p){return setTimeout(p,1E3)}),4):(XNetwork.curTryLoopRequest=null,XNetwork.queueStatus=!1,e.readyState=4,e.status=h.code,e.onreadystatechange(4),n.jumpTo(0))}NSDKLog.error("SZSE:(XNetwork.send)HTTP\u8bf7\u6c42\u5f02\u5e38\uff0c\u6b63\u5728\u91cd\u8bd5");b(f,g);g.sendCount++;n.jumpToEnd()})})};1==XNetwork.getSendStatus()?
XNetwork.pushHttpQueue(this,a):b(a,this)}else 0==this.applyLocalServer("send",a)&&this.XMLHttpRequest.send(a)};
XNetwork.prototype.applyLocalServer=function(a){for(var b=[],f=0;f<arguments.length;++f)b[f-0]=arguments[f];if(this.protocol&&"proxy"==this.protocol&&xLocalSever.publicLocal)switch(b[0]){case "send":f=this.openValues[1];var g=f.substring(17,f.length);if(null!=xLocalSever.publicLocal[g])return this.localRequest={type:this.openValues[0],route:g,url:f,body:b[1],header:this.header},null!=this.localSend&&this.localSend(),!0;break;case "onreadystatechange":if(null!=this.localRequest){var e=this;xLocalSever.publicLocal[this.localRequest.route].sp(this.localRequest,
{send:function(h){e.localResponseTexts=h;e.localReadyNetState=4;e.localHttpStatus=200;e.XMLHttpRequest.onreadystatechange()}});return!0}null==this.localSend&&(this.localSend=function(){if(null!=this.localRequest){var h=this;xLocalSever.publicLocal[this.localRequest.route].sp(this.localRequest,{send:function(m){h.localResponseTexts=m;h.localReadyNetState=4;h.localHttpStatus=200;h.XMLHttpRequest.onreadystatechange()}});return!0}});break;case "setRequestHeader":if("proxy"==this.protocol)return!0}return!1};
$jscomp.global.Object.defineProperties(XNetwork.prototype,{onreadystatechanges:{configurable:!0,enumerable:!0,set:function(a){this.XMLHttpRequest.onreadystatechange=a;this.applyLocalServer("onreadystatechange")}},readyNetState:{configurable:!0,enumerable:!0,get:function(){return null!=this.localReadyNetState?this.localReadyNetState:this.XMLHttpRequest.readyState}},httpStatus:{configurable:!0,enumerable:!0,get:function(){return null!=this.localHttpStatus?this.localHttpStatus:this.XMLHttpRequest.status}},
responseTexts:{configurable:!0,enumerable:!0,get:function(){return null!=this.localResponseTexts?this.localResponseTexts:this.XMLHttpRequest.responseText}}});XNetwork.curTryLoopRequest=null;XNetwork.waitBackQueue=[];var xLocalSever=function(){};xLocalSever.get=function(a,b){xLocalSever.loadRoute("GET",a,b)};xLocalSever.post=function(a,b){xLocalSever.loadRoute("POST",a,b)};
xLocalSever.loadRoute=function(a,b,f){xLocalSever.publicLocal||(xLocalSever.publicLocal={});xLocalSever.publicLocal[b]||(xLocalSever.publicLocal[b]={type:a,route:b,sp:f})};
var XWebSocket=function(a,b){this.isWeb=XWebSocket.safeFnction();this.env="web";"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&(this.env=getEnvInfo());"cpp"==this.env?this.webSocket=new net.WebSocket(a,b):1==this.isWeb?(NSDKLog.info("\u65b0\u5efa Websocket \u5bf9\u8c61\uff1a "+a),this.webSocket=new WebSocket(a,b)):this.Platform=this.isWeb};
XWebSocket.prototype.send=function(a){1==this.isWeb?this.webSocket.send(a):"Electron"==this.Platform&&"undefined"!=typeof electronLink&&electronLink.shareInstance().send("sql",JSON.parse(a))};XWebSocket.setToken=function(a){1==XWebSocket.safeFnction()?"undefined"!=typeof mainWebServer&&null!=mainWebServer&&null!=mainWebServer.setToken&&mainWebServer.setToken(a):console.log("\u5176\u4ed6\u65b9\u5f0f\u8bbe\u7f6etoken.")};
XWebSocket.safeFnction=function(){var a=XWebSocket.getPlatform();return"Web"==a?!0:a};XWebSocket.getPlatform=function(){var a=XWebSocket.UrlGetParams();return null!=a&&"web"==a.platform||"undefined"!=typeof navigator&&navigator&&navigator.userAgent&&-1<navigator.userAgent.indexOf("Electron")||!xGlobal.environment||"Web"==xGlobal.environment.frame?"Web":xGlobal.environment.frame};
XWebSocket.UrlGetParams=function(){if("undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&"cpp"==getEnvInfo())return{};var a=window.document.location.href.toString().split("?");if("string"==typeof a[1]){a=a[1].split("&");var b={},f;for(f in a){var g=a[f].split("=");b[g[0]]=g[1]}return b}return{}};
$jscomp.global.Object.defineProperties(XWebSocket.prototype,{readyState:{configurable:!0,enumerable:!0,get:function(){return 1==this.isWeb?this.webSocket.readyState:1}},onmessage:{configurable:!0,enumerable:!0,set:function(a){if(1==this.isWeb)if("cpp"==this.env)this.webSocket.onmessage(a);else this.webSocket.onmessage=a;else this._onmessage=a}},onopen:{configurable:!0,enumerable:!0,set:function(a){if(1==this.isWeb)if("cpp"==this.env)this.webSocket.onopen(a);else this.webSocket.onopen=a;else this._onopen=
a,"Electron"==this.Platform&&"undefined"!=typeof electronLink&&(a={frameCounter:frameCounter,url:location.href},electronLink.shareInstance().send("startNetWork",a))}},onclose:{configurable:!0,enumerable:!0,set:function(a){if(1==this.isWeb)if("cpp"==this.env)this.webSocket.onclose(a);else this.webSocket.onclose=a;else this._onclose=a}},onerror:{configurable:!0,enumerable:!0,set:function(a){if(1==this.isWeb)if("cpp"==this.env)this.webSocket.onerror(a);else this.webSocket.onerror=a;else this._onerror=
a}},binaryType:{configurable:!0,enumerable:!0,set:function(a){1==this.isWeb&&(this.webSocket.binaryType=a)}}});function XPushSubscribe(){var a=!1,b=0,f={},g=COMPRESSED_1_BASEDATE;this.setSubscribe=function(u){for(var D=a=!1,F=u.frameId+"-"+u.pageId+"-"+u.index,z=0;z<u.result.length;z++)if(u.result[z]&&u.result[z].table&&u.result[z].table.push){u.hasPushScribeServer=!0;var y=u.result[z].table;y.push.name=y.push.n;y.push.key=y.push.k;y.push.s&&(y.push.subtable=y.push.s,y.push.s=null);for(var B=y.push.name,t=[],G={},x=0;x<y.field.length;x++)y.field[x][3]?(y.field[x][3].at?G[y.field[x][3].at.toLowerCase()]=1:
G[y.field[x][0].toLowerCase()]=1,y.field[x][3].adj&&(G[y.field[x][3].adj.toLowerCase()]=1),y.field[x][3].mdy&&(G[y.field[x][3].mdy.toLowerCase()]=1)):G[y.field[x][0].toLowerCase()]=1;for(var J in G)t.push(J);G=[];if(y.push.key&&"String"==y.push.key.constructor.name)return;if(null!=y.push.key&&0<=y.push.key&&y.push.key<y.field.length&&y.data){x=y.push.key;for(var A=0;A<y.data.length;A++)y.data[A]&&y.data[A][x]&&G.push(y.data[A][x])}null==f[B]&&(f[B]={});null==f[B].widgets&&(f[B].widgets={});y=f[B];
null==y.widgets[F]&&(y.widgets[F]=[]);y.widgets[F].packets=u;null==y.widgets[F][z]&&(y.widgets[F][z]={});y.widgets[F][z].result=u.result[z];0==a&&y.widgets[F][z].field&&y.widgets[F][z].keys?y.widgets[F].reset?(y.widgets[F].reset=!1,a=y.widgets[F].subscribeChanged=!0):xIsSame(y.widgets[F][z].field,t)&&xIsSame(y.widgets[F][z].keys,G)?a=!1:(a=!0,y.widgets[F].subscribeChanged=!0):(a=!0,y.widgets[F].subscribeChanged=!0);y.widgets[F][z].field=t;y.widgets[F][z].keys=G;y.widgets[F][z].fieldIndex=null;y.widgets[F][z].subscribe=
u.lastMessage&&u.lastMessage[z]&&u.lastMessage[z].subscribe?1:u.lastMessage&&u.lastMessage[z]?-1:0;y.field&&y.data&&v(y.widgets[F],y.field,y.data,y.flags)&&(D=!0)}if(D&&u.callback)try{callback_result(u,"sql subscribe")}catch(H){}};var e=function(u){for(var D in f){var F=f[D];if(F.name.toLowerCase()==u.toLowerCase())return{name:D,sub:F};if(F.alias)for(var z=0;z<F.alias.length;z++)if(F.alias[z]==u)return{name:D,sub:F};if(F.tables)for(z=0;z<F.tables.length;z++)if(F.tables[z]==u)return{name:D,sub:F}}},
h=function(u){function D(T,R){return R[0]>T[0]?1:-1}var F=function(T,R){for(;R<T.length&&(" "==T[R]||"\n"==T[R]||"\r"==T[R]||"\t"==T[R]);R++);return R},z=function(T,R){for(var W=R=F(T,R);R<T.length&&" "!=T[R]&&","!=T[R]&&"="!=T[R]&&"<"!=T[R]&&">"!=T[R]&&"!"!=T[R]&&"("!=T[R]&&")"!=T[R]&&"["!=T[R]&&"]"!=T[R];R++);return{word:T.substr(W,R-W),pos:R}},y=function(T,R){var W="("==T[R]?")":"["==T[R]?"]":"}";for(R++;R<T.length;R++){if("("==T[R]||"["==T[R]||"{"==T[R])R=y(T,R);else if("'"==T[R]||'"'==T[R])R=
B(T,R);if(T[R]==W){R++;break}}return R},B=function(T,R){var W=T[R];for(R++;R<T.length;R++)if("("==T[R]||"["==T[R]||"{"==T[R])R=B(T,R);else if(T[R]==W){R++;break}return R},t=function(T,R){var W="date";R=F(T,R);">"==T[R]?"="==T[R+1]?(W+=">=",R++):W+=">":"<"==T[R]?"="==T[R+1]?(W+="<=",R++):W+="<":"="==T[R]&&("="==T[R+1]&&R++,W+="==");R++;T=z(T,R);W+=parseInt(T.word);R=T.pos;return{date:W,pos:R}},G=function(T,R){R=F(T,R);var W=z(T,R);R=W.pos;switch(W.word.toLowerCase()){case "last":W=z(T,R);var aa="last="+
parseInt(T.substr(R));R+=W.pos;break;case "date":var Z="";W=t(T,R);Z+=W.date;R=W.pos;W=z(T,R);"and"==W.word.toLowerCase()&&(R+=W.pos,W=z(T,R),"date"==W.word.toLowerCase()&&(R+=W.pos,Z+=" and ",W=t(T,R),Z+=W.date,R+=W.pos))}return{pos:R,date:Z,last:aa}};w=z(u,0);if("select"==w.word.toLowerCase()){var x=w.pos;for(var J=[],A=[];x<u.length;x++)if(w=z(u,x),J.push(w.word.toLowerCase()),x=w.pos,x=F(u,x),","!=u[x]){w=z(u,x);if("as"!=w.word.toLowerCase())break;x=w.pos;w=z(u,x);A[J.length-1]=[J[J.length-1].toLowerCase(),
w.word];x=w.pos;x=F(u,x);if(","!=u[x])break}var H=xDeepCopy(J);H.sort(function(T,R){return T[1]&&R[1]?T[1]>R[1]?1:T[1]<R[1]?-1:0:T[1]?1:R[1]?-1:0});w=z(u,x);if("from"==w.word.toLowerCase()){x=w.pos;w=function(T,R){for(var W=R=F(T,R);R<T.length;R++)if("'"==T[R]||'"'==T[R])R=B(T,R)-1;else if("("==T[R])R=y(T,R)-1;else if(" "==T[R])break;T=T.substr(W,R-W);for(var aa="",Z="",ba=[],ca=0,Y=W=0;Y<T.length;Y++)if("/"==T[Y])for(Y++;Y<T.length;Y++)if("("==T[Y]){var da=B(T,Y);ba[ca++]=T.substr(Y+1,da-Y-2);Z+=
T.substr(W,Y).toLowerCase();aa+=T.substr(W,Y).toLowerCase()+T.substr(Y,da-Y)}""==Z&&(aa=Z=T);return{tableName:Z,fullTableName:aa,keys:ba,pos:R}}(u,x);var I=w.tableName,N=w.fullTableName,M=w.keys;x=w.pos;var C=[],E=[],K=[],Q=null;w=z(u,x);if("at"==w.word.toLowerCase()){x=w.pos;w=G(u,x);x=w.pos;var O=w.date?w.date:w.last;w=z(u,x)}if("where"==w.word.toLowerCase()){x=w.pos;for(var L=!1;x<u.length;x++)if(w=z(u,x),w.word=w.word.toLowerCase(),"order"==w.word)L=!0,x=w.pos,w=z(u,x),w.word=w.word.toLowerCase(),
x=w.pos,w=z(u,x),w.word=w.word.toLowerCase(),Q=w.word;else if(1==L||"include"==w.word||"sub"==w.word||"subscribe"==w.word||"relation"==w.word||"limit"==w.word){if(0==L){var P=x;L=!0}x=w.pos}else if(C.push(w.word),x=w.pos,x=F(u,x),"="==u[x]||">"==u[x]||"<"==u[x]||"!"==u[x])"="==u[x+1]?(E.push(u.substr(x,2)),x+=2):(E.push(u.substr(x,1)),x++),x=F(u,x),'"'==u[x]||"'"==u[x]?(G=B(u,x),K.push([u.substr(x+1,G-x-2)]),x=G):(w=z(u,x),K.push([w.word]),x=w.pos);else if(w=z(u,x),"in"==w.word.toLowerCase()){E.push("in");
x+=2;x=F(u,x);if("("!=u[x])return;G=x+1;x=y(u,x);for(var S=[];G<x;G++){G=F(u,G);if("'"==u[G]||'"'==u[G]){var U=B(u,G);S.push(u.substr(G+1,U-G-2));G=U}else{w=z(u,G);if("{{"==w.word.toLowerCase()||"select"==w.word.toLowerCase())return;S.push(u.substr(w.pos-G));G=w.pos}G=F(u,G);if(","!=u[G])break}K.push(S)}else return;P&&(x=P)}for(var V,X;x<u.length;x++)switch(w=z(u,x),x=w.pos,w.word.toLowerCase()){case "resample":x=F(u,x);P=y(u,x);V=u.substr(x+1,P-x-2).toLowerCase();x=V.split(",");G=[];for(V=U=0;V<
x.length;V++,U++){x[V]=x[V].trim();G[U]=x[V].split("=");if("how"==x[V].substr(0,3))for(L=V+1;L<x.length;L++)if(G[U][1]+=","+x[L].trim(),"'"==x[L][x[L].length-1]||'"'==x[L][x[L].length-1]){V=L+1;break}if("'"==G[U][1][0]||'"'==G[U][1][0])G[U][1]=G[U][1].substr(1,G[U][1].length-2),L=G[U][1].split(","),1<L.length&&(L.sort(D),G[U][1]=""+L)}G.sort(D);V="resample(";for(U=0;U<G.length;U++)0<U&&(V+=","),V+=G[U][0]+"='"+G[U][1]+"'";V+=")";x=P;break;case "relation":x=F(u,x);P=y(u,x);X=u.substr(x+1,P-x-2).toLowerCase();
x=X.split(",");for(L=0;L<x.length;L++)x[L]=x[L].trim().toLowerCase();X=""+x;x=P}return{field:J,fieldAs:A,fieldKey:""+H,tableName:I,whereKey:K,whereOprtator:E,whereField:C,orderBy:Q,at:O,resample:V,relation:X,fullTableName:N,tableKeys:M}}}};this.checkPushSubscribe=function(u,D,F){if(F.query.script){var z=h(F.query.script),y=u.nameList;if((y=(y=y&&y[D])&&y.query&&y.query.script)&&(y=h(y))&&z&&y.orderBy!=z.orderBy)return!1;if(z)if(z.tableName){var B=z.tableName.toLowerCase().split("/");if(f[B[0]])var t=
f[B[0]];else{for(x in f)if(f[x].alias){for(y=0;y<f[x].alias.length&&B[0]!=f[x].alias[y];y++);if(y<f[x].alias.length){var G=!0;t=f[x];break}}null==G&&(z=null)}if(t){if(B[1]){for(y=0;y<t.subtables.length&&B[1]!=t.subtables[y];y++);y==t.subtables.length&&(z=null)}}else z=null}else z=null;if(z&&z.tableName&&z.whereField&&z.whereField.length){y=e(z.tableName);if(null==y)return;t=y.sub;G=y.name;if(t&&t.field){var x=u.frameId+"-"+u.pageId+"-"+u.index;for(y=0;y<z.whereField.length;y++)if(z.whereField[y]==
t.primaryKeyName){u.hasPushScribeServer=!0;null==u.result&&(u.result=[]);null==u.result[D]&&(u.result[D]={});null==u.result[D].table&&(u.result[D].table={});B=null;if(null==z.orderBy)B=z.whereKey[y];else return;var J=function(H,I){for(var N=[],M=0;M<H.length;M++)for(var C=0;C<I.length;C++)if(H[M]==I[C][0].toLowerCase()){N.push(I[C]);break}return N}(z.field,t.field);for(y=0;y<J.length;y++)if(J[y][0].toLowerCase()==t.primaryKeyName){var A=y;break}null==A&&(J.unshift(t.field[t.primaryKey]),A=0);if(0<=
A){y=B?B.filter(function(H){return""!==H}).length:u.result[D].table.data?u.result[D].table.data.length:0;u.result[D].table.field=J;u.result[D].table.info={begin:0,compressed:"0",dataBegin:0,dataRange:y,dataRows:y,id:null,mode:"table",name:F.name,rank:"row",rows:y,thisBegin:0,totalRows:y,type:"query"};u.result[D].table.info.key=B&&1==B.length?B[0]:null;u.result[D].table.flags={};if(B)for(u.result[D].table.data=[],y=0;y<B.length;y++)B[y]&&(u.result[D].table.data[y]=[],u.result[D].table.data[y][A]=B[y]);
u.result[D].updateCounter=createUpdateCounter(u.result[D].updateCounter);u.result[D].table.push={n:G,k:A,name:G,key:A};u.result[D].gid={name:F.name,id:0,idx:D};u.status="active";null==t.widgets&&(t.widgets={});null==t.widgets[x]&&(t.widgets[x]=[]);a=t.widgets[x].subscribeChanged=!0;null==t.widgets[x][D]&&(t.widgets[x][D]={});t.widgets[x][D].result=u.result[D];t.widgets[x][D].field=[];for(y=0;y<J.length;y++)t.widgets[x][D].field[y]=J[y][0].toLowerCase();z.fieldAs&&0<z.fieldAs.length?t.widgets[x][D].fieldAs=
z.fieldAs:t.widgets[x][D].fieldAs&&delete t.widgets[x][D].fieldAs;t.widgets[x][D].keys=B;t.widgets[x][D].fieldIndex=null;t.widgets[x][D].timestamp=(new Date).valueOf()/1E3;t.widgets[x].packets=u;t.field&&t.data&&v(t.widgets[x],t.field,t.data,t.flags)&&(update=!0,t.widgets[x].isNewSubscribe=!0)}F.changed&&(F.changed=!1);return!0}}}z?F.query.parse=z:F.query.parse&&delete F.query.parse}};var m,l;this.getNewSubscribeMessage=function(u){if(0!=a||1==u){a=!1;var D,F,z,y,B={},t={},G=(new Date).valueOf()/
1E3;null==l&&(l=G);u=[];for(var x in f)for(var J in f[x].widgets){var A=f[x].widgets[J];if(!A.packets||!A.packets.status||"active"==A.packets.status)for(var H=0;H<A.length;H++)if(null!=A[H]){var I=A[H];null==B[x]&&(B[x]={});null==t[x]&&(t[x]=0);var N=I.keys;if(null!=N)for(F=0;F<N.length;F++)if(N[F]&&(null==B[x][N[F]]&&(B[x][N[F]]={field:[]},t[x]++),-1!=I.subscribe)){for(D=0;D<I.field.length;D++)for(z=0;z<f[x].field.length;z++)if(I.field[D]==f[x].field[z][0].toLowerCase()){for(y=0;y<B[x][N[F]].field.length&&
B[x][N[F]].field[y]!=z;y++);y==B[x][N[F]].field.length&&(B[x][N[F]].field.push(z),B[x][N[F]].timestamp=I.timestamp);break}if(m&&m[x]&&m[x][N[F]])for(D=0;D<B[x][N[F]].field.length;D++){for(z=0;z<m[x][N[F]].field.length&&B[x][N[F]].field[D]!=m[x][N[F]].field[z];z++);if(z==m[x][N[F]].field.length){u.push(A);break}}else u.push(A)}}}var M=[];D=0;m&&Object.keys(m).forEach(function(O){if("sysmsg"!==O&&!B[O]){var L={};Object.keys(m[O]).forEach(function(S){L[S]||(L[S]={field:["*"]})});var P={};(O=n(O,null,
(P[O]=L,P)))&&M.push({lang:"zh-cn",type:"subscribe",req:O})}});for(x in B){if(null==m||null==m[x])var C=xDeepCopy(B),E=n(x,C);else{for(var K in m[x])if(B[x][K]&&0<m[x][K].field.length&&(B[x][K].field.length!=m[x][K].field.length||1!=xIsSame(B[x][K].field,m[x][K].field))){for(D=0;D<B[x][K].field.length;D++){for(z=0;z<m[x][K].field.length&&B[x][K].field[D]!=m[x][K].field[z];z++);z==m[x][K].field.length&&(null==C&&(C={}),null==C[x]&&(C[x]={}),null==C[x][K]&&(C[x][K]={field:[]}),C[x][K].field.push(B[x][K].field[D]),
m[x][K].field.push(B[x][K].field[D]))}for(z=0;z<m[x][K].field.length;z++){for(D=0;D<B[x][K].field.length&&B[x][K].field[D]!=m[x][K].field[z];D++);D==B[x][K].field.length&&(null==Q&&(Q={}),null==Q[x]&&(Q[x]={}),null==Q[x][K]&&(Q[x][K]={field:[]}),Q[x][K].field.push(m[x][K].field[z]),m[x][K].field.splice(z,1),z--)}}for(K in B[x])if(null==m[x][K]||0==m[x][K].field.length)null==C&&(C={}),null==C[x]&&(C[x]={}),C[x][K]={field:B[x][K].field},m[x][K]=B[x][K];var Q;for(K in m[x])null==B[x][K]&&m[x][K].field&&
0<m[x][K].field.length&&(null==Q&&(Q={}),null==Q[x]&&(Q[x]={}),Q[x][K]={field:["*"]},m[x][K].field=[],function(O,L){for(var P=0;P<O.data.length;P++)if(O.data[P]&&O.data[P][O.primaryKey]==L){O.data[P][O.primaryKey]="";break}}(f[x],K));if(C||Q)E=n(x,C,Q),Q&&(l=G)}E&&M.push({lang:"zh-cn",type:"subscribe",req:E})}if(0<M.length){m=B;x=JSON.stringify(M);for(z=0;z<u.length;z++)u[z].subscribeCounter=b;return x}}};var n=function(u,D,F){for(var z,y,B,t=0;2>t;t++)if(B=1==t?D:F)for(var G in B[u])if(null==B[u][G].del){y=
xDeepCopy(B[u][G].field);var x=[],J;for(J in B[u])null==B[u][J].del&&xIsSame(y,B[u][J].field)&&(x.push(J),B[u][J].del=!0);0<x.length&&(null==z&&(z={tablename:u,ver:f[u].push_ver,id:b++}),1==t?(null==z.add&&(z.add=[]),z.add.push({field:y,key:x})):(null==z.del&&(z.del=[]),z.del.push({field:y,key:x})))}return z},p=function(u,D){for(var F=[],z=0;z<u.length;z++){F[z]=-1;for(var y=0;y<D.length;y++)if(u[z].toLowerCase()==D[y][0].toLowerCase()){F[z]=y;break}}return F};this.getPushFieldDefine=function(u){if(f[u])return f[u].field;
for(var D in f)if(f[D].alias)for(var F=0;F<f[D].alias.length;F++)if(f[D].alias[F].toLowerCase()==u)return f[D].field};this.start=function(u,D){null==f[u.name]&&(f[u.name]={});var F=f[u.name];console.log("view alias: "+u.alias);F.name=u.name;if(u.field){F.field=u.field;for(var z=0;z<F.field.length;z++)"Number"==F.field[z][0].constructor.name&&(F.field[z][0]=D[F.field[z][0]][1]);F.primaryKey=u.primaryKey;0<=u.primaryKey&&(F.primaryKeyName=u.field[u.primaryKey][0].toLowerCase())}u.alias&&(F.alias=u.alias);
u.tables&&(F.tables=u.tables);u.subtables&&(F.subtables=u.subtables);null!=u.max&&(F.maxSubscribeItems=u.max);null!=u.ver&&(F.push_ver=u.ver);F.data=[];F.flags=[];m=null;a=!0};var q=function(u,D,F,z){if(null==D||F&&3==(F&3))return null;if("x"==u[1][0])u=parseInt(u[1][1]),F&&0<(F>>5&7)&&(u=(F>>5&7)-1),D/=decodeXx[u],D=parseFloat(D.toFixed(u)),null!=z&&(D=parseFloat((D+z).toFixed(u)));else if("g"==u[1][0])if(z&&(4>D.length||4<=D.length&&"Array"!=D[3].constructor.name)){F=z[2];u=z[0];for(var y=0;y<F-
1;y++)u-=z[3+y][0]+1;z[3+F-1][u-1]=D[0];if(1<D.length)for(y=1;y<D.length;y++)z[3+F-1][u+y-1]=z[3+F-1][u+y-2],z[0]++;D=z}else for(F=0,u=D,z=0;z<u[2];z++){if(u[z+3])for(y=1;y<u[z+3].length;y++)F&&(u[z+3][y]+=F),F=u[z+3][y]}else if("dd"==u[1]||"dq"==u[1]||"dm"==u[1])D=null!=z?D+z:D+g;else if("dy"==u[1])D*=1E4,null!=z&&(D+=z);else if("ti"==u[1]){if(D)for(z=F=0;z<D.length;z++)D[z][0]+=F,F=D[z][0],D[z][0]*=1E3,D[z][1]+=F,F=D[z][1],D[z][1]*=1E3}else"ts"==u[1]?(D*=1E3,D=null!=z?D+z:D+12622752E5):"tm"==u[1]?
(D*=6E4,D=null!=z?D+z:D+12622752E5):"th"==u[1]?(D*=36E5,D=null!=z?D+z:D+12622752E5):"tms"==u[1]?D=null!=z?D+z:D+12622752E5:"i"==u[1][0]?"."!=u[1][2]&&null!=z&&(D+=z):"t"==u[1][0]&&"0"<=u[1][1]&&"9">=u[1][1]||"t"!=u[1]&&"t!"!=u[1]&&null!=z&&(D+=z);return D};this.onMessage=function(u,D){if(f[u.name]&&u.data){var F=f[u.name];u.field&&(F.field=u.field,F.primaryKey=u.primaryKey,0<=u.primaryKey&&(F.primaryKeyName=u.field[u.primaryKey][0].toLowerCase()));u.tables&&(F.tables=u.tables);u.subtables&&(F.subtables=
u.subtables);null==F.data&&(F.data=[]);null==F.flags&&(F.flags=[]);if(u.ver!=F.push_ver){console.log("\u6e05\u76d8: "+F.push_ver+" ==> "+u.ver);var z=!0;F.push_ver=u.ver}for(var y=F.field,B=F.data,t=F.flags,G=0;G<u.data.length;G++){var x=u.data[G][0],J=u.data[G][2];null==B[x]&&(B[x]=[]);if(u.data[G][1]){B[x]=[];B[x].isNew=!0;B[x][F.primaryKey]=u.data[G][1];for(var A=0;A<J.length;A++){var H=J[A][0];B[x][H]=q(y[H],J[A][1],J[A][2]);B[x].changed=!0;null!=J[A][2]&&(null==t[x]&&(t[x]=[]),t[x][H]=J[A][2])}}else for(u.data[G][1]=
B[x][F.primaryKey],B[x].isNew=null,A=0;A<J.length;A++)H=J[A][0],B[x][H]=q(y[H],J[A][1],J[A][2],B[x][H]),B[x].changed=!0,null!=J[A][2]&&(null==t[x]&&(t[x]=[]),t[x][H]=J[A][2])}y=[];for(var I in F.widgets){A=F.widgets[I];J=!1;for(var N=0;N<A.length;N++)if(null!=A[N]&&null!=A.packets)if(A.packets.status&&"active"!=A.packets.status){var M=A[N],C=M.result;C.subscribe=!1}else if(M=A[N],-1!=M.subscribe){C=M.result;var E=C.table.push,K=C.table.data;null==C.table.flags&&(C.table.flags={});var Q=C.table.flags;
if(E){null==M.fieldIndex&&(M.fieldIndex=p(M.field,f[u.name].field));var O=M.fieldIndex,L=!1;if(M.fieldAs)for(H=0;H<M.fieldAs.length;H++)M.fieldAs[H]&&(x=xDeepCopy(C.table.field[H]),x[0]=M.fieldAs[H][0],C.table.field[H]=x);var P="Array"==E.key.constructor.name?!0:!1;C.table.dataStatus=[];if(K)for(var S=0;S<K.length;S++)if(H=P?E.key[S]:K[S]?K[S][E.key]:null,null!=H)for(G=0;G<u.data.length;G++)if(x=u.data[G][0],H==u.data[G][1]){for(H=0;H<C.table.field.length;H++)G=O[H],-1!=G&&(K[S][H]=B[x][G],t&&t[x]&&
null!=t[x][G]&&(L=C.table.field[H][0].toLowerCase(),null==Q[L]&&(Q[L]=[]),Q[L][S]=t[x][G]),L=!0,null==B[x].isNew&&1!=A.isNewSubscribe&&(C.table.dataStatus[S]=1));break}if(M.fieldAs)for(H=0;H<M.fieldAs.length;H++)M.fieldAs[H]&&(C.table.field[H][0]=M.fieldAs[H][1]);L&&(J=!0,C.updateCounter=createUpdateCounter(C.updateCounter));A.isNewSubscribe=null}}y.push({packet:A.packets,update:J})}z&&(D.clearAll(),this.clearAll());for(S=0;S<y.length;S++)u=y[S].packet,(J=y[S].update)&&"active"==u.status&&u.callback&&
(D&&1!=z&&D.save(u),callback_result(u,"sql subscribe")),z&&"active"==u.status&&(resendMessage(u,u.frameId,u.pageId,u.index),u.needResendMessage=!1)}};var v=function(u,D,F,z){for(var y=!1,B=0;B<u.length;B++)if(null!=u[B]){var t=u[B],G=t.result;if(null!=G){var x=G.table.push,J=G.table.data;if(null!=J){null==G.table.flags&&(G.table.flags={});var A=G.table.flags;if(x&&null!=x.k){x.name=x.n;x.key=x.k;x.s&&(x.subtable=x.s,x.s=null);null==t.fieldIndex&&(t.fieldIndex=p(t.field,D));G.table.dataStatus=[];var H=
t.fieldIndex;if("String"!=x.key.constructor.name){var I;x=x.key;var N=!1;if(t.fieldAs)for(I=0;I<t.fieldAs.length;I++)if(t.fieldAs[I]){var M=xDeepCopy(G.table.field[I]);M[0]=t.fieldAs[I][0];G.table.field[I]=M}for(M=0;M<F.length;M++)if(F[M]){I=F[M][0];for(var C=0;C<J.length;C++)if(J[C]&&I==J[C][x]){for(I=0;I<G.table.field.length;I++){var E=H[I];if(-1!=E&&(N=!0,J[C][I]=F[M][E],z&&z[M]&&null!=z[M][E])){var K=G.table.field[I][0].toLowerCase();null==A[K]&&(A[K]=[]);A[K][C]=z[M][E]}}break}}if(t.fieldAs)for(I=
0;I<t.fieldAs.length;I++)t.fieldAs[I]&&(G.table.field[I][0]=t.fieldAs[I][1]);N&&(y=!0,G.updateCounter=createUpdateCounter(G.updateCounter))}}}}}return y};this.clearAll=function(){m=null;if(f)for(var u in f)if(f[u]&&f[u].widgets)for(var D in f[u].widgets)f[u].widgets[D].reset=!0};this.removeWidget=function(u,D,F){if(f)for(var z in f)if(f[z]&&f[z].widgets&&f[z].widgets[u+"-"+D+"-"+F]){delete f[z].widgets[u+"-"+D+"-"+F];break}}};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")};String.prototype.trimSingle=function(){return this.replace(/(^'*)|('*$)/g,"")};String.prototype.trimDbSingle=function(){return this.replace(/(^"*)|("*$)/g,"")};
function xQuerySubmitBus(a,b){var f=function(){for(var h=0;h<a.length;h++)a[h].field=g(a[h].field,!0),a[h].condition=g(a[h].condition,!0);for(h=0;h<b.length;h++)b[h].condition=g(b[h].condition,!0)};this.setQuery=function(h){var m;for(m=0;m<a.length&&(a[m].name!=h.name||a[m].http!=h.http||a[m].field!=h.field||a[m].condition!=h.condition||a[m].must!=h.must);m++);a[m].name=h.name;a[m].http=h.http;a[m].field=h.field;a[m].condition=h.condition;a[m].must=h.must;f()};this.setSubmit=function(h){var m;for(m=
0;m<b.length&&(b[m].name!=h.name||b[m].http!=h.http||b[m].condition!=h.condition);m++);b[m].name=h.name;b[m].http=h.http;b[m].condition=h.condition;b[m].onSubmit={cacheName:h.onSubmit.cacheName,callback:h.onSubmit.callback};f()};this.getQueryList=function(){return a};this.geSubmitList=function(){return b};var g=function(h,m){m=void 0===m?!1:m;var l=function(v){v=function(u){if(null==u)return null;var D=u.indexOf("{{ "),F=u.indexOf(" }}");0<=D&&0<=F&&(u=u.substr(0,D+3)+u.substr(F),D=u.indexOf("{{  }}"),
u=u.substr(0,D+6)+l(u.substr(D+6)));return u}(v);return v=function(u){if(null==u)return null;u=u.split("=");for(var D="",F=0;F<u.length;F++)D+=u[F].trim(),F<u.length-1&&(D+="=");u=D.split(" ");D="";for(F=0;F<u.length;F++)D+=u[F].trim(),F<u.length-1&&(D+=" ");D=D.replace(/"/g,"'");return D.toLowerCase()}(v)};if(h=l(h)){var n=h.split(" and ");h="";for(var p=0;p<n.length;p++){var q=n[p].split("=");1==q.length?(h+=q[0].trim(),p<n.length-1&&(h+=",")):(h+=q[0].trim()+"=",q=q[1].trim(),h=m?h+q:"'"==q[0]||
'"'==q[0]?h+"'{{  }}'":h+"{{  }}",p<n.length-1&&(h+=" and "))}}return h};this.query=function(h,m,l,n){if(h.http)for(var p=g(h.field),q=g(h.condition,!0),v=0;v<a.length;v++)if(h.http==a[v].http&&p==a[v].field&&q==a[v].condition){null==a[v].cache&&(a[v].cache={});h=g(h.query.condition,!0);null==a[v].cache[h]&&(a[v].cache[h]={});p=a[v].cache[h];if(p.callbackList){if(null==l)return{cacheIndex:v,callbackList:[],result:p.result};for(q=0;q<p.callbackList.length&&(p.callbackList[q].callback!=l||!xIsSame(p.callbackList[q].gid,
n));q++);q==p.callbackList.length&&(p.callbackList[q]={queryIndex:m,callback:l,gid:n});m=l;for(l=0;l<a.length;l++)if(a[l].cache)for(var u in a[l].cache){n=a[l].cache[u];for(var D=0;D<n.callbackList.length;D++)n.callbackList[D].callback==m&&(n.callbackList[D].active=!1)}p.callbackList[q].active=!0;return 1==a[v].cache[h].isExpired?(a[v].cache[h].isExpired=!1,{cacheIndex:v}):{cacheIndex:v,callbackList:p.callbackList[q],result:p.result}}p.callbackList=[{queryIndex:m,callback:l,gid:n,active:!0}];return{cacheIndex:v}}};
this.onQueryResult=function(h,m){var l=h.cacheBusList[m];if(l&&null!=l.cacheIndex){var n=g(h.nameList[m].condition,!0);n=a[l.cacheIndex].cache[n];n.result=xDeepCopy(h.result[m]);if(1<n.callbackList.length){h=[];for(m=0;m<n.callbackList.length;m++)1==n.callbackList[m].active&&(h[m]={cacheIndex:l.index,callbackList:n.callbackList[m],result:n.result});return h}}};var e=function(h,m){m=m.gid;var l=getWidgetForPath(m.fm,m.pg,m.idx);m=function(p,q){for(var v=0;v<q.length;v++){var u=q[v].query;if(u&&u.condition){if(u.condition.toLowerCase().replace(/ /g,
"")==p)return!0;if(v==q.length-1)return!1}}};if(l){var n=l.getQueryInfo();h=h.toLowerCase().replace(/ /g,"");if("Array"==n.constructor.name)return m(h,n);if("string"==typeof n&&(n=n.replace("{{","").replace("}}","").trim(),l=l.getVariables(),l[n]))return m(h,l[n])}return!0};this.onSubmit=function(h,m){if(h[m].http)for(var l=g(h[m].condition),n=0;n<b.length;n++)if(h[m].http==b[n].http&&b[n].onSubmit&&l==b[n].condition)for(var p=0;p<a.length;p++)if(b[n].onSubmit.cacheName==a[p].name){n=b[n].onSubmit.callback(a[p],
h[m].query.condition);if(null!=n&&n.key&&(h=n.key,1==n.isExpired&&(a[p].cache[h].isExpired=!0),1!=n.isExpired||n.cache)){m=[];l=a[p].cache[h];for(n=0;n<l.callbackList.length;n++){var q=e(h,l.callbackList[n]);0!=l.callbackList[n].active&&1==q&&(m[m.length]={cacheIndex:p,callbackList:l.callbackList[n],result:l.result})}return m}return}};f()};function ASTNode(){this.locModel={type:"",value:"",locIndex:null,loc:{start:{line:null,indexes:null},end:{line:null,indexes:null}}};this.astNode={type:"",id:"",params:[],body:[],parent:null}}
function ASTEnum(){this.keywordEnum={select:0,selecttree:1,"delete":2,from:3,and:4,or:5,at:6,"in":7,where:8,relation:9,include:10,sub:11,resample:12,"order by":13,filter:14,expand:15,limit:16};this.punctuatorEnum={"(":0,")":1,",":2,"=":"eq",">":"gt",">=":"gte","<":"lt","<=":"lte","<>":"neq","!=":"neq",like:"like","!":10,"/":11,"'":12,'"':13};this.charEnum={KEY_WORD:"Keyword",IDENTIFIER:"Identifier",PUNCTUATOR:"Punctuator",NUMERIC:"Numeric",STRING:"String",BOOLEAN:"Boolean"}}
ASTEnum.shareInstance=function(){this.instance||(this.instance=new ASTEnum);return this.instance};function GSQLModel(){this.field=[];this.keys=[];this.where=[];this.limit=[];this.orderby={};this.relations=[];this.resample={};this.expand=[];this._and=[];this.and={_and:this._and};this.filter=!1;this.model={type:"",field:this.field,table:""};this.codegenState={in:!1,expand:!1,where:!1,relation:!1,resample:!1,resampleStrObj:!1,resampleCount:0,brackets:!1,bracketsCount:0,atDate:!1}}
function XScriptAST(){this.lineModel={line:null,indent:null,sliceStart:null,sliceEnd:null};this.punctuatorEnum=ASTEnum.shareInstance().punctuatorEnum;this.keywordEnum=ASTEnum.shareInstance().keywordEnum;this.charEnum=ASTEnum.shareInstance().charEnum;var a=new ASTNode;this.tokensLocNode=a.locModel;this.astNode=a.astNode;this.debug=!1;this.parse=function(b){var f={program:{},tokens:[],lines:[]};b=b.split("\n");for(var g=0;g<b.length;g++){var e=b[g],h=null,m=null,l=this.deCopy(this.lineModel);l.line=
e;l.indent=g;for(var n=0;n<e.length;n++)" "!==e[n]&&(null===h&&(h=n),m=n+1);l.sliceStart=h;l.sliceEnd=m;f.lines.push(l)}b=[];for(g=0;g<f.lines.length;g++){e=f.lines[g];h=e.line.substring(e.sliceStart,e.sliceEnd);m=0;l=-1;n=!1;for(var p=0;p<=h.length;p++){var q=h[p];switch(q){case " ":if(-1===l&&0==n)l=0;else break;this.addData(b,this.createLocNode(g,h,b.length,[m,p]));m=p;if(2<b.length){var v=b[b.length-2];q=b[b.length-1];null!=this.keywordEnum[(v.value+" "+q.value).toLowerCase()]&&(v=v.loc.start.indexes,
q=q.loc.end.indexes,b.splice(b.length-2,2),this.addData(b,this.createLocNode(g,h,b.length,[v,q])))}break;case "'":case '"':0===l?(m=p,l=-1,n=!0):-1===l&&1==n&&(n=!1,l=0,this.addData(b,this.createLocNode(g,h,b.length,[m,p+1])),m=p+2);break;case "/":case ",":case ")":case "(":case "=":if(-1===l&&1==n)break;l=0;" "!==h[p-1]&&!0!==this.isPunctuator(h[p-1])&&this.addData(b,this.createLocNode(g,h,b.length,[m,p]));this.addData(b,this.createLocNode(g,h,b.length,[p]));m=p;break;case "!":case "<":case ">":if(-1===
l&&1==n)break;if(null==h[p+1]){this.errorMsg(e.indent,h,p,h[p]+" \u7b26\u53f7\u8bed\u6cd5\u9519\u8bef");return}if(">"===h[p+1]||"="===h[p+1]){l=0;" "!==h[p-1]&&this.addData(b,this.createLocNode(g,h,b.length,[m,p]));this.addData(b,this.createLocNode(g,h,b.length,[p,p+2]));m=p++;break}l=0;" "!==h[p-1]&&this.addData(b,this.createLocNode(g,h,b.length,[m,p]));this.addData(b,this.createLocNode(g,h,b.length,[p]));m=p;break;default:0===l?(m=p,l=-1):null==q&&-1===l&&(l=0,this.addData(b,this.createLocNode(g,
h,b.length,[m,p])),m=p)}}}f.tokens=b;b=this.createASTProgram(f.tokens);f.program=b;return f};this.isPunctuator=function(b){return"undefined"!==typeof this.punctuatorEnum[b]?!0:!1};this.errorMsg=function(b,f,g,e){console.error("AST\u89e3\u6790\u5931\u8d25\uff1a\n        errorLine:\u7b2c"+b+"\u884c,\n        errorSQL:'"+f+"',\n        errorPos:\u4e0b\u6807"+g+",\n        errorMsg:'"+e+"'")};this.addData=function(b,f){b.push(f)};this.createLocNode=function(b,f,g,e){var h;if(1==e.length){f=f[e[0]];var m=
h=e[0]}else f=f.substring(e[0],e[1]),m=e[0],h=e[1];e=this.deCopy(this.tokensLocNode);e.locIndex=g;e.value=f;e.loc.start.line=b;e.loc.start.indexes=m;e.loc.end.line=b;e.loc.end.indexes=h;b=this.scannerValueType(f);e.type=b;return e};this.scannerValueType=function(b){return isNaN(Number(b))?null!=this.keywordEnum[b.toLowerCase()]?this.charEnum.KEY_WORD:null!=this.punctuatorEnum[b]?this.charEnum.PUNCTUATOR:"'"===b[0]||'"'===b[0]||"'"===b[b.length-1]||'"'===b[b.length-1]?this.charEnum.STRING:this.charEnum.IDENTIFIER:
this.charEnum.NUMERIC};this.createASTProgram=function(b){for(var f={error:null,body:[],params:[],sourceType:"sql",type:"Program"},g=f,e=[],h=0;h<b.length;h++){var m=b[h],l=m.type,n=m.value,p=this.deCopy(this.astNode);switch(l){case "Keyword":switch(n.toLowerCase()){case "select":case "selecttree":case "from":case "include":case "sub":case "limit":p.type=l;p.id=m;p.parent=g;g.body.push(p);g=p;break;case "expand":g.id.value="expand";break;case "in":g.id.value="in";break;case "filter":case "where":p.type=
l;p.id=m;p.parent=g;g.body.push(p);g=this.deCopy(this.astNode);g.id=this.deCopy(m);g.id.value="and";g.id.type="Keyword";g.id.declaration="sourcewhere";g.type="Keyword";g.parent=p;p.body.push(g);break;case "at":case "relation":case "resample":case "order by":for(n=null;null==n;)"from"==g.id.value?n=g:"from"==g.parent.id.value?n=g.parent:g=g.parent;g=n;p.type=l;p.id=m;p.parent=g;g.body.push(p);g=p;break;case "or":case "and":"where"!==g.id.value.toLowerCase()&&(g=g.parent),p.type=l,p.id=m,p.parent=g,
g.body.push(p),g=p}break;case "Identifier":p.id=m;p.type=l;p.parent=g;g.params.push(p);break;case "Punctuator":switch(n){case "(":"from"===g.id.value.toLowerCase()?(e.push(g),g=g.params,g=0>=g.length?g:g[g.length-1]):"where"!==g.id.value.toLowerCase()?(p.id=this.deCopy(m),p.id.value="where",p.id.type="Keyword",p.id.declaration="brackets",p.type="Keyword",p.parent=g,g.body.push(p),e.push(g),g=p):e.push(g);break;case ")":m=e[e.length-1];"in"===m.id.value&&"Keyword"===m.type&&(m=m.parent);if(0<g.params.length)g.params[g.params.length-
1].id.declaration="endbrackets_1";else{for(;0<g.body.length;)g=g.body[g.body.length-1];null!=g.params&&(g=g.params[g.params.length-1])&&g.id&&(p=g.id.declaration.split("_"),p=p[0]+"_"+(parseInt(p[1])+1),g.id.declaration=p)}e.pop();g=m;break;case "=":case "<":case "<=":case ">":case ">=":case "!=":case "<>":case "like":g.id.operator=n}break;case "Numeric":case "String":p.type=l,p.id=m,p.parent=g,g.params.push(p)}}return f};this.transform=function(b){};this.codegen=function(b){};this.VLR=function(b,
f,g,e,h,m,l,n){if(null!=h){var p=h.value;switch(p.toLowerCase()){case "select":case "selecttree":f.model.type=p;"left"==m&&(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value),f.field.push(b.id.value));break;case "from":"left"==m&&(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value),f.model.table=""==f.model.table?b.id.value:f.model.table+("/"+b.id.value));break;case "in":"left"==m?(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value),p={},p[b.id.value]=null,f._and.push(p)):
b.id&&"brackets"==b.id.declaration&&(1==this.debug&&console.log(p+"\u62ec\u53f7\u5f00\u59cb"),g.in=!0);break;case "expand":"left"==m?(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value),f.model.table=""==f.model.table?b.id.value:f.model.table+("/"+b.id.value)):b.id&&"brackets"==b.id.declaration&&(1==this.debug&&console.log(p+"\u62ec\u53f7\u5f00\u59cb"),g.expand=!0);break;case "filter":console.log(p),f.filter=!0,h.value="";case "where":if("left"==m){if(1==l&&null!=h.operator)if(1==this.debug&&
console.log(p+"\u8282\u70b9\uff1a  "+h.operator+"  "+b.id.value),1==g.brackets){var q={};h=this.punctuatorEnum[h.operator];var v=this.getFormatValue(b);q[h]=v;h=f._and[f._and.length-1];1<this.codegenState.bracketsCount&&(h=this.readNestObj(h).obj);if("Array"==h.constructor.name)h=h[h.length-1];else{for(var u in h)var D=u;h=h[D];h="Object"==h.constructor.name?h:h[h.length-1]}for(var F in h)D=F;null==h[D]?h[D]=q:console.error("\u63d2\u5165\u5931\u8d25\uff1a",q)}else 1==g.resample&&this.resampleInsert(b,
f,g);else if(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value),1==g.relation)h=this.getFormatValue(b),f.relations.push(h);else if(1==g.resample)this.resampleInsert(b,f,g);else if(1==g.in){h=this.getFormatValue(b);q=f._and[f._and.length-1];var z;for(z in q){var y=z;null==q[z]&&(q[z]={in:[]})}q[y].in.push(h)}else if(1==g.brackets)if(h=D=f._and[f._and.length-1],1<g.bracketsCount&&(h=this.readNestObj(h).obj),q={},q[b.id.value]=null,"Array"==h.constructor.name)h.push(q);else{for(var B in h)v=
B;if(null==v){D=this.readNestObj(D).parent;for(var t in D)v=t;h[v]=q}else"Object"==h[v].constructor.name?h[v]=q:h[v].push(q)}else 1==g.expand?(h=b.id.value,q=n[b.id.locIndex-1],null!=q&&"/"==q.value&&0<f.expand.length?(q=f.expand.length-1,D=f.expand[q].split("/"),D.push(h),h=D.join("/"),f.expand[q]=h):f.expand.push(h)):"brackets"==h.declaration&&(1==this.debug&&console.log(p+"\u62ec\u53f7\u5f00\u59cb \u7c7b\u578b\u4e3a\uff1a"+b.parent.parent.id.value),g.brackets=!0,h={},h["_"+b.parent.parent.id.value]=
{},1<=g.bracketsCount?(q=f._and[f._and.length-1],q=this.readNestObj(q).obj,q.push(h)):f._and.push(h),g.bracketsCount++);this.checkEndbrackets(b,g,p)}else g.where=!0;break;case "or":case "and":if("left"==m)if(1==l){1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+h.operator+"  "+b.id.value);if(1==g.where)if(1==g.brackets){q=f._and[f._and.length-1];var G;for(G in q)var x=G;"_or"==x&&"and"==p?(q=this.readNestObj(q).obj,"Object"==q.constructor.name&&null!=q._or?q=q._or:"Object"==q.constructor.name&&
null!=q._and&&(q=q._and),q=q[q.length-1],null!=q._and?q=q._and:null!=q._or&&(q=q._or),"Object"!=q.constructor.name&&(q=q[q.length-1]),this.insertValue(q,b,h)):"_and"!=x&&"_or"!=x||"or"!=p?(q=this.readNestObj(q).obj,this.insertValue("Object"==q.constructor.name?q:q[q.length-1],b,h)):(q=this.readNestObj(q).obj,"Object"==q.constructor.name&&null!=q._or&&(q=q._or),q=q[q.length-1],null!=q&&null!=q._or&&(q=q._or),"Object"!=q.constructor.name&&(q=q[q.length-1]),this.insertValue(q,b,h))}else"or"==p?(q=f._and[f._and.length-
1],q="Object"==q._or.constructor.name?q._or:q._or[q._or.length-1],this.insertValue(q,b,h)):this.insertValue(f._and[f._and.length-1],b,h);else 1==g.atDate&&(h=this.punctuatorEnum[h.operator],q=this.getFormatValue(b),f.model.atDate[h]=q,g.atDate=!1);this.checkEndbrackets(b,g,p)}else{if(1==g.where)if(h={},h[b.id.value]=null,1==g.brackets){F=f._and[f._and.length-1];for(var J in F)q=J;D=this.readNestObj(F).obj;if("_or"==q&&"and"==p)u={},"Object"==D.constructor.name&&null==D[q]?(q={_and:[]},null!=D._and?
(u=h,D=D._and):(F._or=q,q._and.push(D),u=h,D=q._and)):"Object"==D.constructor.name&&"Object"==D[q].constructor.name?(F=this.readNestObj(F).parent,v=D[q],F[q]=[],D=F[q],u._and=[],u._and.push(v),u._and.push(h)):"Object"==D.constructor.name&&"Array"==D[q].constructor.name?(D=D[q],u=h):"Array"==D.constructor.name?(q=D[D.length-1],null!=q["_"+p]&&0<q["_"+p].length&&(D=q["_"+p]),u=h):u._and=h,D.push(u);else if("_and"==q&&"or"==p)q={_or:{}},q._or=h,"Object"==D.constructor.name&&(F={_or:[]},null!=D._and&&
(D=D._and),F._or.push(D),D=F._or,q=h,f._and[f._and.length-1]=F),D.push(q);else{u=0;for(var A in F)u++;1<=u&&(F[q]=[],F[q].push(D),D=F[q]);D.push(h)}}else"or"==p?(q={_or:{}},q._or=h,f._and.push(q)):f._and.push(h);else null!=b&&null!=b.id&&null!=b.id.value&&"date"==b.id.value&&(g.atDate=!0);1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value)}else"endbrackets"!=h.declaration&&"endbrackets"!=b.id.declaration||1!=this.debug||console.log(p+"\u62ec\u53f7\u7ed3\u675f");break;case "at":"left"==
m&&(1==l?(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a "+b.id.value),null!=f.model[p+"Last"]?(h=this.getFormatValue(b),f.model[p+"Last"]=h):null!=f.model[p+"Date"]&&(h=this.punctuatorEnum[h.operator],q=this.getFormatValue(b),f.model[p+"Date"][h]=q)):(1==this.debug&&console.log(p+"\u8282\u70b9\uff1a "+b.id.value),"Identifier"==b.id.type&&("last"==b.id.value.toLowerCase()?f.model[p+"Last"]="":"date"==b.id.value.toLowerCase()&&(f.model[p+"Date"]={}))));break;case "relation":"left"==m?1==l?1==this.debug&&
console.log(p+"\u8282\u70b9\uff1a  "+h.operator+"  "+b.id.value):1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value):(1==this.debug&&console.log(p+"\u8282\u70b9->\u5b50\u8282\u70b9 "+b.id.value),g.relation=!0);break;case "resample":"left"==m?1==l?1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+h.operator+"  "+b.id.value):1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+b.id.value):(1==this.debug&&console.log(p+"\u8282\u70b9->\u5b50\u8282\u70b9 "+b.id.value),g.resample=!0);case "include":"left"==
m&&"flags"==b.id.value.toLowerCase()&&(f.model.includeFlags=1);break;case "sub":"left"==m&&(p=this.getFormatValue(b),f.model.subscribe=p);break;case "limit":"left"==m&&(p=this.getFormatValue(b),f.limit.push(p));break;case "order by":"left"==m&&(p=this.getFormatValue(b),0==l?f.orderby.field=p:1==l&&("desc"==p.toLowerCase()?f.orderby.desc=1:"asc"==p.toLowerCase()?f.orderby.desc=-1:console.info("order by \u9519\u8bef\u8bed\u53e5\uff1a"+p,b)));break;default:"left"==m&&1==this.debug&&console.log(p+"\u8282\u70b9\uff1a  "+
b.id.value),null==this.keywordEnum[p]&&b.parent&&b.parent.parent&&b.parent.parent.id&&"from"==b.parent.parent.id.value&&(1==this.debug&&console.log("from\u8282\u70b9 - "+p+"\u503c\uff1a   "+b.id.value),f.keys.push(this.getFormatValue(b)))}}h=b.params;p=b.body;for(q=0;q<h.length;q++)this.VLR(h[q],f,g,!1,b.id,"left",q,n);for(h=0;h<p.length;h++)if(p[h].id.value&&"select"==p[h].id.value.toLowerCase()&&1==e){q=new GSQLModel;this.VLR(p[h],q,q.codegenState,n);1<q._and.length?q.model.where=q.and:1==q._and.length&&
(q.model.where=q._and[0]);0<q.keys.length&&(q.model.keys=q.keys);0<q.relations.length&&(q.model.relations=q.relations);0<q.expand.length&&(q.model.expand=q.expand);0<q.limit.length&&(q.model.limit=q.limit);1==this.mapIsLength(q.resample)&&(q.model.resample=q.resample);1==this.mapIsLength(q.orderby)&&(q.model.orderby=q.orderby);F=f._and[f._and.length-1];D=void 0;for(var H in F)D=H;F={};F[D]={in:q.model};f.where=F;null==f.model.where&&(f.model.where={});f.model.where=f.where;f._and.splice(f._and.length-
1);f._and.push(f.where);g.in=!1}else this.VLR(p[h],f,g,!0,b.id,"right",null,n)};this.readNestObj=function(b){for(var f=0,g,e=0;e<this.codegenState.bracketsCount;e++){f++;for(var h in b)1==h.startsWith("_")&&(f==this.codegenState.bracketsCount?(g=b,b=b[h]):(g=b,b=b[h][b[h].length-1]))}return{obj:b,parent:g}};this.insertValue=function(b,f,g){var e=!1,h=null,m;for(m in b)null==b[m]&&(h=m,e=!0);1==e?(e={},g=this.punctuatorEnum[g.operator],f=this.getFormatValue(f),e[g]=f,b[h]=e):console.error(val+"\u8282\u70b9\u63d2\u5165\u5931\u8d25\uff0c\u8fd0\u7b97\u7b26\uff1a"+
g.operator+"\uff0c\u503c\uff1a"+f.id.value)};this.resampleInsert=function(b,f,g){if("string"==b.id.type.toLowerCase())if(-1!=b.id.value.indexOf('"')&&3>b.id.value.split('"').length){var e=1==b.id.value.startsWith('"')?1:0;b.id.value=b.id.value.replace('"',"");g.resampleStrObj=1==g.resampleStrObj?!1:!0}else-1!=b.id.value.indexOf("'")&&3>b.id.value.split("'").length&&(e=1==b.id.value.startsWith("'")?1:0,b.id.value=b.id.value.replace("'",""),g.resampleStrObj=1==g.resampleStrObj?!1:!0);if(null!=e||1==
g.resampleStrObj){null==f.resample.how&&(f.resample.how={});var h=b.id.value.split(":");2==h.length?f.resample.how[h[0]]=h[1]:console.error("resample \u89e3\u6790\u5931\u8d25\uff0c\u9519\u8bef\u7684\u53d8\u9891\u53c2\u6570\uff01 "+b.id.value);0==g.resampleStrObj&&g.resampleCount++}else{if(0==g.resampleCount%2)h=this.getFormatValue(b),f.resample[h]=null;else{e=this.getFormatValue(b);f=this.readNestObj(f.resample).obj;for(var m in f)h=m;if(null==f[h])if(-1!=e.indexOf(",")&&"String"==b.type){b=e.split(",");
m={};for(e=0;e<b.length;e++){b[e]=b[e].replace(/ /g,"");var l=b[e].split(":");2==l.length&&(m[l[0]]=l[1])}f[h]=m}else f[h]=e;else console.error("\u63d2\u5165\u5931\u8d25\uff1a",valueMap)}g.resampleCount++}};this.getFormatValue=function(b){return"String"==b.id.type?eval(b.id.value):"Numeric"==b.id.type?parseInt(b.id.value):b.id.value};this.autoGenerate=function(b){var f=new GSQLModel;this.sqlModel=f;this.codegenState=f.codegenState;f=this.parse(b);this.VLR(f.program,this.sqlModel,this.codegenState,
!1,null,null,null,f.tokens);1<this.sqlModel._and.length?1==this.sqlModel.filter?(this.sqlModel.model.filter=this.sqlModel.and,delete this.sqlModel.model.where):this.sqlModel.model.where=this.sqlModel.and:1==this.sqlModel._and.length&&(1==this.sqlModel.filter?(this.sqlModel.model.filter=this.sqlModel._and[0],delete this.sqlModel.model.where):this.sqlModel.model.where=this.sqlModel._and[0]);0<this.sqlModel.keys.length&&(this.sqlModel.model.keys=this.sqlModel.keys);0<this.sqlModel.relations.length&&
(this.sqlModel.model.relations=this.sqlModel.relations);1==this.mapIsLength(this.sqlModel.resample)&&(this.sqlModel.model.resample=this.sqlModel.resample);1==this.mapIsLength(this.sqlModel.orderby)&&(this.sqlModel.model.orderby=this.sqlModel.orderby);0<this.sqlModel.expand.length&&(this.sqlModel.model.expand=this.sqlModel.expand);0<this.sqlModel.limit.length&&(this.sqlModel.model.limit=this.sqlModel.limit);this.checkNull(b,this.sqlModel.model);return this.sqlModel.model};this.getParams=function(b){for(var f=
null,g=0;g<b.params.length;g++)null==f&&(f=[]),f.push(b.params[g]);return f};this.getParamsValue=function(b,f){for(var g=[],e=1;e<arguments.length;++e)g[e-1]=arguments[e];e=null;for(var h=0;h<b.params.length;h++){null==e&&(e=[]);for(var m={},l=0;l<g.length;l++)m[g[l]]=b.params[h].id[g[l]];e.push(m)}return e};this.checkEndbrackets=function(b,f,g){b.id&&b.id.declaration&&1==b.id.declaration.startsWith("endbrackets")&&(b=parseInt(b.id.declaration.split("_")[1]),1==f.relation?(1==this.debug&&console.log("relation\u7ed3\u675f"),
f.relation=!1):1==f.in?(1==this.debug&&console.log("in\u7ed3\u675f"),f.in=!1):1==f.resample?(1==this.debug&&console.log("resample\u7ed3\u675f"),f.resample=!1):1==f.expand?(1==this.debug&&console.log("expand\u7ed3\u675f"),f.expand=!1):(f.brackets=!1,f.bracketsCount-=b,1==this.debug&&console.log(g+"\u62ec\u53f7\u7ed3\u675f "+b+"\u6b21,\u5269\u4f59\u9500\u6bc1\u62ec\u53f7\uff1a"+f.bracketsCount+"\u6b21 ")))};this.mapIsLength=function(b){for(var f in b)if(null!=b[f])return!0;return!1};this.deCopy=function(b){return JSON.parse(JSON.stringify(b))};
this.checkNull=function(b,f){for(var g in f)if(Object.hasOwnProperty.call(f,g)){var e=f[g];null===e||void 0===e?console.warn("\u89e3\u6790\u6570\u636e\u65f6\u53d1\u73b0null\u503c\n \u8bf7\u68c0\u67e5SQL: "+b+"  \n \u9519\u8befKey : "+g+" \n Object\u8282\u70b9 : "+JSON.stringify(f)):e instanceof Object&&"Array"!==e.constructor.name&&this.checkNull(b,e)}}}
(function(){var a="object"===typeof window?window:{},b="function"===typeof define&&define.amd;"object"===typeof process&&process.versions&&process.versions.node&&(a=global);a.scriptAst=new XScriptAST;b&&define(function(){return exports})})();if("undefined"==typeof scriptAst)var scriptAst=new XScriptAST;var debug=!1,isAutoLogin=!1,isInitConnect=!0,autoLoginCallback=null,tolsend=0,tolrecv=0,convId=-1,xSocket={queryList:{},submitList:{},receivePackets:0,receiveSize:0,sendPacekte:0,sendSize:0};function clearxSocket(){xSocket={queryList:{},submitList:{},receivePackets:0,receiveSize:0,sendPacekte:0,sendSize:0}}
var ERRORHTTP=Object.freeze({NULL_MUST_PARAM:9999,SERVER_UNAVAILABLE:9998}),GlobalErrorPack={errorCode:null,errorMsg:null},decodeXx=[1,10,100,1E3,1E4,1E5,1E6],decodeHex64={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,b:11,c:12,d:13,e:14,f:15,g:16,h:17,i:18,j:19,k:20,l:21,m:22,n:23,o:24,p:25,q:26,r:27,s:28,t:29,u:30,v:31,w:32,x:33,y:34,z:35,A:36,B:37,C:38,D:39,E:40,F:41,G:42,H:43,I:44,J:45,K:46,L:47,M:48,N:49,O:50,P:51,Q:52,R:53,S:54,T:55,U:56,V:57,W:58,X:59,Y:60,Z:61,"~":62,"!":63,"*":-1};
function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function ltrim(a){return a.replace(/(^\s*)/g,"")}function rtrim(a){return a.replace(/(\s*$)/g,"")}function trimSingle(a){return a.replace(/(^'*)|('*$)/g,"")}function trimDbSingle(a){return a.replace(/(^"*)|("*$)/g,"")}function isStringType(a){var b=/(^"*)|("*$)/;return/(^'*)|('*$)/.test(a)||b.test(a)?!0:!1}
function strIsNumber(a){var b=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return/^\d+(\.\d+)?$/.test(a)||b.test(a)?!0:!1}function objLength(a){var b=0,f;for(f in a)b++;return b}function xAppend(a,b){for(var f=0;f<b.length;f++)a[a.length]=b[f]}function xAppendMinToMax(a,b,f){for(var g=0;g<f.length;g++)b[a+g]=f[g]}function trimBracket(a){a=trim(a);return a.slice(1,-1)}
function makeRowData(a,b,f){if(null==a)return null;for(var g=[],e=0;e<a.length;e++){var h=null;f&&(h=f[a[e][0].toLowerCase()]);null==a[e][1]&&(a[e][1]="t");if("x"==a[e][1][0])for(var m=parseInt(a[e][1][1]),l,n=0;n<b.length;n++)void 0==g[n]&&(g[n]=[]),b[n]&&null!=b[n][e]&&(h&&h[n]&&3==(h[n]&3)?g[n][e]=null:(l=h&&h[n]&&0<(h[n]>>5&7)?(h[n]>>5&7)-1:m,g[n][e]=b[n][e]/decodeXx[l]));else{for(n=0;n<b.length;n++)void 0==g[n]&&(g[n]=[]),g[n][e]=h&&h[n]&&3==(h[n]&3)?null:null!=b[n]&&null!=b[n][e]?b[n][e]:null;
if("c"==a[e][1]||"t"==a[e][1])for(n=0;n<g.length;n++)g[n][e]&&"string"==typeof g[n][e]&&(g[n][e]=g[n][e].replace(/\\n/g,"\n"));else if("t"==a[e][1][0]&&"0"<=a[e][1][1]&&"9">=a[e][1][1])for(n=0;n<g.length;n++)for(h=0;h<g[n].length;h++)g[n][e]&&g[n][e][h]&&"string"==typeof g[n][e][h]&&(g[n][e][h]=g[n][e][h].replace(/\\n/g,"\n"))}}return g}
function makeColData(a,b,f){if(null==a)return null;for(var g=[],e=0;e<a.length;e++){void 0==g[e]&&(g[e]=[]);var h=null;f&&(h=f[a[e][0].toLowerCase()]);if(null!=b[e])if("x"==a[e][1][0])for(var m=parseInt(a[e][1][1]),l=0;l<b[e].length;l++)if(h&&h[l]&&3==(h[l]&3))g[e][l]=null;else{var n=h&&h[l]&&0<(h[l]>>5&7)?(h[l]>>5&7)-1:m;g[e][l]=b[e][l]/decodeXx[n]}else{for(l=0;l<b[e].length;l++)g[e][l]=h&&h[l]&&3==(h[l]&3)?null:b[e][l];if("c"==a[e][1]||"t"==a[e][1])for(l=0;l<g[e].length;l++)g[e][l]&&"string"==typeof g[e][l]&&
(g[e][l]=g[e][l].replace(/\\n/g,"\n"));else if("t"==a[e][1][0]&&"0"<=a[e][1][1]&&"9">=a[e][1][1])for(l=0;l<g[e].length;l++)for(;0<g[e][l].length;e++)g[e][l][0]&&"string"==typeof g[e][l][0]&&(g[e][l][0]=g[e][l][0].replace(/\\n/g,"\n"))}}return g}
function analysisES(a,b,f){if(null==a||""==a)return{};var g={seq:"(=)",eq:"=",gte:">=",lte:"<=",mustNot:"!=",gt:">",lt:"<",in:" in ",order:"order",like:"like"},e={must:[]},h=!0;a=a.split(" and ");null!=f&&(a=f);for(f=0;f<a.length;f++){var m=a[f];if(1==m.startsWith("(")&&1==m.endsWith(")")){m=m.substring(1,m.length-1);var l=m.split(" or ");m=analysisES(m,null,l).esCondition.must;null==e.should&&(e.should=[]);for(l=0;l<m.length;l++)e.should.push(m[l])}else for(var n in g){l=m.indexOf(g[n]);if("eq"==
n&&-1!=l){var p=m[l-1];if(">"==p||"<"==p||"!"==p||"("==p)continue}if(-1!=l){var q=m.split(g[n]);p=trim(q[0]);p=p.replace(/_A_N_D_/g,"and");p=p.toLowerCase();var v=trim(q[1]);if(b)for(l=0;l<b.length;l++)p==b[l].toLowerCase()&&(""!=v&&v&&"''"!=v&&'""'!=v||(h=!1));if(""==v||!v||"''"==v||'""'==v)break;else if("' '"==v||'" "'==v)v="",q[1]="''";if("break"==p)break;var u=void 0;l=!0;switch(g[n]){case ">=":case "<=":case ">":case "<":u={range:{}};u.range[p]={};for(var D in e)for(var F=e[D],z=0;z<F.length;z++){var y=
F[z],B;for(B in y)null!=y[B][p]&&(u.range[p]=y[B][p],l=!1)}F=!0;if(0==trim(v).indexOf('"')||0==trim(v).indexOf("'"))F=!1;F?v=parseInt(trim(q[1])):(v=trimSingle(trim(q[1])),v=trimDbSingle(v),v=v.replace(/_A_N_D_/g,"and"));u.range[p][n]=v;break;case "like":case "=":case "(=)":l=!0;v=[];if("(=)"==g[n]){v=trimSingle(trim(q[1]));v=trimDbSingle(v);v=JSON.parse(v);q={term:{}};q.term[p]=v;u=q;break}F=!1;if("string"==typeof q[1]&&0==trim(q[1]).indexOf("[")){if("[]"==q[1]){l=!1;break}F=!0;z=trim(q[1]).slice(1,
-1);z=z.split(",");for(y=0;y<z.length;y++)if('""'!=trim(z[y])&&"''"!=trim(z[y])&&""!=trim(z[y])){if(0==z[y].indexOf("D'")){if("D''"==z[y]||'D""'==z[y])continue;var t=z[y].slice(2,-1);if(8==t.length){var G=t.slice(0,4);G+="-"+t.slice(4,6);G+="-"+t.slice(6,8);z[y]="'"+G+"'"}}t=!0;if(0==trim(z[y]).indexOf('"')||0==trim(z[y]).indexOf("'"))t=!1;t?t=parseInt(trim(z[y])):(t=trimSingle(trim(z[y])),t=trimDbSingle(t),t=t.replace(/_A_N_D_/g,"and"));v.push(t)}}if(F){if(q=[],!(0>=v.length)){for(u=0;u<v.length;u++)q.push(v[u]);
v={terms:{}};v.terms[p]=q;u=v}}else{if(0==q[1].indexOf("D'")){if("D''"==q[1]||'D""'==q[1])continue;v=q[1].slice(2,-1);8==v.length&&(u=v.slice(0,4),u+="-"+v.slice(4,6),u+="-"+v.slice(6,8),q[1]="'"+u+"'")}v=!0;if(0==trim(q[1]).indexOf('"')||0==trim(q[1]).indexOf("'"))v=!1;if(v)v=parseInt(trim(q[1]));else{v=trimSingle(trim(q[1]));v=trimDbSingle(v);if(2<q.length)for(u=2;u<q.length;u++)F=trimSingle(trim(q[u])),F=trimDbSingle(F),v+="="+F;v=v.replace(/_A_N_D_/g,"and")}"like"==g[n]?(q={like:{}},q.like[p]=
v,u=q):(q={term:{}},q.term[p]=v,u=q)}break;case " in ":l=!0;v.startsWith("(")&&v.endsWith(")")&&(v=v.slice(1,-1));v=v.split(",");q=[];for(u=0;u<v.length;u++)v[u]=v[u].replace(/'/g,""),q.push(v[u]);v={terms:{}};v.terms[p]=q;u=v;break;case "order":e.sort||(e.sort={});e.sort[p]={order:v};break;case "!=":for(l=!1,e.must_not||(e.must_not=[]),p=analysisES(""==v?p+"=' '":p+"="+v).esCondition,q=0;q<p.must.length;q++)e.must_not[q]=p.must[q]}if(null!=u&&1==l){e.must.push(u);break}else if(0==l)break}}}return{esCondition:e,
mustCheckStatu:h}}function scriptOrder(a){var b=a,f=b.indexOf("order by"),g={condition:"",order:""};if(-1!=f){a=b.slice(f+8,b.length).trim();var e=a.split("desc"),h=a.split("asc");1<e.length&&(a=e[0].trim()+" order desc");1<h.length&&(a=h[0].trim()+" order asc");b=b.slice(0,f).trim();g.condition=b;g.order=a}else-1==b.indexOf("select")&&(g.condition=b);return g}
function scriptES(a,b){if(null==a||""==a)return{};var f=[],g=[],e=[],h=[],m=[],l="",n="";var p=-1!=a.indexOf("selectTree")?a.indexOf("selectTree")+10:a.indexOf("select")+6;var q=a.indexOf("from");if(-1==q)return console.error("\u65e0\u6cd5\u89e3\u6790\u5230\u8868\u540d\u6765\u6e90from,\u8bed\u6cd5\u9519\u8bef: "+a),{};p=a.slice(p,q);q=p+",";for(var v in q){var u=q[v];","==u&&e.push(v);"("==u&&f.push(v);")"==u&&g.push(v)}q=v=null;if(0==e.length)h.push(p.trim());else for(var D in e){u=parseInt(e[D]);
var F=parseInt(f[0]),z=parseInt(g[0]);if(1==isNaN(F)&&1==isNaN(z)){if(!(v&&u>v&&u<q)){F=p.split(",");z=!1;for(var y=0;y<F.length;y++)if(-1!=F[y].indexOf("(")&&(z=!0),-1!=F[y].indexOf(")"))z=!1;else if(0==z){u=F[y].trim();var B=!0;for(t in h)if(h[t]==u){B=!1;break}B&&h.push(u)}}}else if(u<F)v&&u>v||(u=p.slice(-1==D-1?0:parseInt(e[D-1])+1,u).trim(),h.push(u));else if(u>F){v={name:"",argment:""};u=p.slice(-1==D-1?0:parseInt(e[D-1])+1,F).trim();h.push(u);v.name=u;if(null!=z)q=p.slice(F+1,z),v.argment=
q,m.push(v);else return console.error("\u6761\u4ef6\u6ca1\u6709\u7ed3\u675f\uff0c\u8bed\u6cd5\u9519\u8bef: "+a),{};v=F;q=z;f.splice(0,1);g.splice(0,1)}else console.error("\u65e0Field\uff0c\u8bed\u6cd5\u9519\u8bef: "+a)}g=-1==a.indexOf("from")?-1:a.indexOf("from")+4;f=a.indexOf("where");if(-1==g)return console.error("\u6ca1\u6709\u8bbe\u7f6e\u8868\u540d\uff0c\u8bed\u6cd5\u9519\u8bef: "+a),{};-1!=f?f='"'+a.slice(g,f).trim()+'"':(f=a.indexOf("order by"),f=-1==f?'"'+a.slice(g,a.length).trim()+'"':'"'+
a.slice(g,f).trim()+'"');e=-1==a.indexOf("where")?-1:a.indexOf("where")+5;-1!=e?(n=a.slice(e,a.length).trim(),n=scriptOrder(n),l=n.condition,n=n.order):-1!=a.indexOf("order by")&&(n=a.slice(g+f.length,a.length).trim(),n=scriptOrder(n),l=n.condition,n=n.order);a={};for(g=0;g<h.length;g++)for(e=h[g],D=0;D<m.length;D++)if(m[D].name==e){var t=analysisES('Field_Name="'+e.toLowerCase()+'"').esCondition.must[0];p=m[D].argment.split(",");v={};u=q=void 0;for(F=0;F<p.length;F++)if(z=p[F].split("="),2==z.length)q=
z[0],u=z[1],v[q]=u;else if(2>z.length)u+=","+z[0],v[q]=u;else return console.error("\u89e3\u6790\u5931\u8d25\uff0c\u975e\u6cd5\u6761\u4ef6\u7ec4\u5408:"+p[F]),{};p=[];for(var G in v)p.push(G+"="+v[G]);for(v=0;v<p.length;v++){q=p[v];q=q.replace(/and/g,"_A_N_D_");q=analysisES(q.trim()).esCondition;if(q.must&&null!=q.must[0])q=q.must[0].term;else return console.error("\u9519\u8bef\u7684\u5b50\u6761\u4ef6:"+p[v]),{};for(var x in q)t.term[x]=q[x]}a.must||(a.must=[]);a.must.push(t)}""!=f&&'"default"'!=
f&&(a.must||(a.must=[]),m=analysisES("requestName="+f).esCondition.must[0],a.must.push(m));if(""!=l&&null!=l){var J=analysisES(l,b);b=J.esCondition;J=J.mustCheckStatu;m=b.must;for(G=0;G<m.length;G++)x=m[G],a.must||(a.must=[]),a.must.push(x);m=b.must_not;if(null!=b.must_not)for(b=0;b<m.length;b++)G=m[b],a.must_not||(a.must_not=[]),a.must_not.push(G)}""!=n&&null!=n&&(n=analysisES(n).esCondition.sort,a.sort=n);for(n=0;n<h.length;n++)h[n]=h[n].toLowerCase();return{field:h,condition:a,mustCheckStatu:J}}
var debugCount=0;function createUpdateCounter(a){var b=new Date;b=1E5*b.getUTCMinutes()+1E3*b.getUTCSeconds()+b.getUTCMilliseconds();return a&&b==a?b+1:b}function getPageFromFramePage(a,b){if(xGlobal.frame)return xGlobal.frame.getPageById(b)}
function xHttpDecode(a,b){void 0==a.result&&(a.result=[]);if(null==b.result)return a.result;for(var f=0;f<b.result.length;f++){var g=b.result[f].table,e=g.info,h=g.flags;if(!e)break;var m=g.gid;null==m&&(m=b.result[f].gid);e.name=m.name;e.id=m.id;e.status=b.status?!0:!1;e.msg=b.msg?b.msg:"";e.thisBegin?e.thisBegin--:e.thisBegin=e.dataBegin-1;e.begin--;var l=parseInt(m.id),n=m.id.indexOf(",");if(-1!=n){n=parseInt(m.id.slice(n+1));var p=!1;if(null==a.result||null==a.result[n]||a.result[n].httpId!==
l)p=!0;var q=g.field,v=g.data;if("row"!=e.rank&&"col"!=e.rank)break;void 0==a.result[n]&&(a.result[n]={updateCounter:0});void 0==a.result[n].table&&(a.result[n].table={});a.result[n].updateCounter=createUpdateCounter(a.result[n].updateCounter);a.result[n].httpId=l;l=a.result[n].table.info;if(void 0==l)a.result[n].table.info=xDeepCopy(e),p=!0;else if(l.id!=e.id)p=!0,l.id=e.id;else if(l.begin==e.begin&&l.dataRows<=e.rows)p=!0;else if(l.dataBegin+l.dataRows<e.begin||e.begin+e.rows<l.dataBegin)p=!0,void 0==
q&&(newField=q=a.result[n].table.field);if(0<=e.totalRows&&v){if(p){a.result[n].table.data=[];a.result[n].table.flags={};a.result[n].table.dataStatus=[];if("row"==e.rank){if(g=makeRowData(q,v,h)){for(r=k=0;k<g.length;r++,k++)a.result[n].table.data[r]=g[k];a.result[n].table.info.begin=e.thisBegin;a.result[n].table.info.thisBegin=e.thisBegin;a.result[n].table.info.rows=e.rows;a.result[n].table.info.totalRows=e.totalRows}a.result[n].table.data||(e.rows=e.totalRows=0)}else a.result[n].table.data=makeColData(q,
v,h);if(q&&(a.result[n].table.field=xDeepCopy(q),a.alias&&a.alias[n]))for(e=a.alias[n].split(","),g=0;g<e.length&&g<q.length;g++)""!=e[g]&&(a.result[n].table.field[g][0]=trim(e[g]));a.rotate[n]&&rotateTable(a.result[n],a.rotate[n])}else{if(e.begin>=l.begin+l.rows){if(h=0,"row"==e.rank)for(q=e.thisBegin;h<g.data.length;q++,h++)a.result[n].table.data[q]=g.data[h]}else if(e.begin+e.rows<=l.begin){h=0;if("row"==e.rank)for(q=e.thisBegin;h<g.data.length;q++,h++)a.result[n].table.data[q]=g.data[h];a.result[n].table.info.begin=
e.thisBegin;a.result[n].table.info.thisBegin=e.thisBegin}else e.begin<l.begin+l.rows&&(e.thisBegin<l.begin&&(a.result[n].table.info.begin=e.thisBegin,a.result[n].table.info.thisBegin=e.thisBegin),xAppendMinToMax(e.begin,a.result[n].table.data,v));a.result[n].table.info.rows=e.rows;a.result[n].table.info.totalRows=e.totalRows}a.result[n].table.info.dataBegin=0;a.result[n].table.info.dataRows=a.result[n].table.data.length}else{1==parseInt(b.pageId)&&2==parseInt(b.index)&&(debugCount++,console.log("-- "+
debugCount+" ---- \u7a7a\u8868 -------"));break}a.result[n].gid=m;a.result[n].table.info.name=a.nameList[n].name;a.result[n].table.info.noChartData=a.nameList[n].noChartData;a.result[n].table.info.synchField=a.nameList[n].synchField}}return a.result}
var getModifyFieldIndex=function(a,b){for(var f=0,g=0,e=0;e<a.length;e++){if(b<f+a[e].length)return decodeHex64[a[e][b-f]]+g;f+=a[e].length;g+=64}},decodeDec0=[1,10,100,1E3,1E4,1E5,1E6],decodeDec=[1E6,1E5,1E4,1E3,100,10,1],DecodeCompressed_1=function(a,b,f){f=12622752E5;var g=COMPRESSED_1_BASEDATE;if(null!=a){var e=a.info;if(null!=e&&"1"==e.compressed){if(null==b&&(b=a.field,null==b))return;if(a.flgs){for(var h=null,m=0,l=0;l<b.length;l++)0<=b[l][1].indexOf("!")&&(null==h&&(h={}),h[b[l][0].toLowerCase()]=
a.flgs[m++]);h&&(a.flags=h)}if(a.flags){h=a.flags;for(var n in h)if(h[n])for(l=0;l<h[n].length;l++)if(1<h[n][l].length){m=h[n][l][0];var p=Array(h[n][l][0]).fill(h[n][l][1]);h[n]=h[n].slice(0,l).concat(p).concat(h[n].slice(l+1));l+=m-1}}if(a.data&&b)if("tree"==e.mode)for(e=0;e<b.length;e++)if("_expand"==b[e][0])for(l=0;l<a.data.length;l++)a.data[l]&&a.data[l][e]&&(a.data[l][e]=0==a.data[l][e]?"":1==a.data[l][e]?"-":"+");else{if("_path"==b[e][0]){f="";g=-1;for(h=0;h<b.length&&"_level"!=b[h][0];h++);
if(null!=h)for(l=0;l<a.data.length;l++)g==a.data[l][h]&&(a.data[l][e]=f),f=a.data[l][e],g=a.data[l][h]}}else if("col"==e.rank)for(e=0;e<b.length;e++){if(null!=a.data[e]){if("g"!=b[e][1][0])if("c"==b[e][1]||"t"==b[e][1]||"t"==b[e][1][0]&&"0"<=b[e][1][1]&&"9">=b[e][1][1])for(l=0;l<a.data[e].length;l++)"Array"==a.data[e][l].constructor.name&&(m=a.data[e][l][0],p=Array(a.data[e][l][0]).fill(a.data[e][l][1]),a.data[e]=a.data[e].slice(0,l).concat(p).concat(a.data[e].slice(l+1)),l+=m-1);else for(l=0;l<a.data[e].length;l++)a.data[e][l]&&
1<a.data[e][l].length&&(m=a.data[e][l][0],p=Array(a.data[e][l][0]).fill(a.data[e][l][1]),a.data[e]=a.data[e].slice(0,l).concat(p).concat(a.data[e].slice(l+1)),l+=m-1);if("ts"==b[e][1])for(a.data[e][0]*=1E3,a.data[e][0]+=f,l=1;l<a.data[e].length;l++)a.data[e][l]=null!=a.data[e][l]&&null!=a.data[e][l-1]?a.data[e][l-1]+1E3*a.data[e][l]:1E3*a.data[e][l];else if("tm"==b[e][1])for(a.data[e][0]*=6E4,a.data[e][0]+=f,l=1;l<a.data[e].length;l++)a.data[e][l]=null!=a.data[e][l]&&null!=a.data[e][l-1]?a.data[e][l-
1]+6E4*a.data[e][l]:6E4*a.data[e][l];else if("tms"==b[e][1])for(a.data[e][0]+=f,l=1;l<a.data[e].length;l++)null!=a.data[e][l]&&null!=a.data[e][l-1]&&(a.data[e][l]=a.data[e][l-1]+a.data[e][l]);else if("x"==b[e][1][0])if(a.flags&&a.flags[b[e][0].toLowerCase()])for(h=a.flags[b[e][0].toLowerCase()],l=1;l<a.data[e].length;l++)null!=a.data[e][l]&&null!=a.data[e][l-1]&&(h[l]>>5==h[l-1]>>5?a.data[e][l]+=a.data[e][l-1]:(m=(h[l-1]>>5&7)-1,-1==m&&(m=parseInt(b[e][1][1])),p=(h[l]>>5&7)-1,-1==p&&(p=parseInt(b[e][1][1])),
a.data[e][l]=parseInt(((a.data[e][l-1]*decodeDec[m]+a.data[e][l]*decodeDec[m>p?m:p])/decodeDec[p]).toFixed(0))));else for(l=1;l<a.data[e].length;l++)null!=a.data[e][l]&&null!=a.data[e][l-1]&&(a.data[e][l]+=a.data[e][l-1]);else if("dd"==b[e][1]||"dq"==b[e][1]||"dm"==b[e][1]){if(0<a.data[e].length)for(a.data[e][0]+=g,l=1;l<a.data[e].length;l++)null!=a.data[e][l]&&null!=a.data[e][l-1]&&(a.data[e][l]+=a.data[e][l-1])}else if("dy"==b[e][1]&&0<a.data[e].length)for(a.data[e][0]*=1E4,l=1;l<a.data[e].length;l++)a.data[e][l]=
null!=a.data[e][l]&&null!=a.data[e][l-1]?1E4*a.data[e][l]+a.data[e][l-1]:1E4*a.data[e][l]}}else if("row"==e.rank)for(e=0;e<b.length;e++)if("dd"==b[e][1]||"dq"==b[e][1]||"dm"==b[e][1]){if(0<a.data.length)for(l=0;l<a.data.length;l++)a.data[l][e]+=g}else if("dy"==b[e][1]){if(0<a.data.length)for(l=0;l<a.data.length;l++)a.data[l][e]*=1E4}else if("ti"==b[e][1])for(l=0;l<a.data.length;l++){if(a.data[l]&&a.data[l][e])for(h=m=0;h<a.data[l][e].length;h++)a.data[l][e][h][0]+=m,m=a.data[l][e][h][0],a.data[l][e][h][0]*=
1E3,a.data[l][e][h][1]+=m,m=a.data[l][e][h][1],a.data[l][e][h][1]*=1E3}else if("g"==b[e][1][0])for(l=0;l<a.data.length;l++){if(a.data[l]&&a.data[l][e]&&a.data[l][e][2])for(h=p=0;h<a.data[l][e][2];h++)if(a.data[l][e][h+3])for(m=1;m<a.data[l][e][h+3].length;m++)a.data[l][e][h+3][m]+=p,p=a.data[l][e][h+3][m]}else if("ts"==b[e][1])for(l=0;l<a.data.length;l++)a.data[l]&&a.data[l][e]&&(a.data[l][e]*=1E3,a.data[l][e]+=f);else if("tm"==b[e][1])for(l=0;l<a.data.length;l++)a.data[l]&&a.data[l][e]&&(a.data[l][e]*=
6E4,a.data[l][e]+=f);else if("tms"==b[e][1])for(l=0;l<a.data.length;l++)a.data[l]&&a.data[l][e]&&(a.data[l][e]+=f);if(a.modify){if(a.modify.record)for(e=1,l=0;l<a.modify.record.length;l++)a.modify.record[l]+=e,e=a.modify.record[l];if(a.modify.flgs&&b){h=null;for(l=m=0;l<b.length;l++)0<=b[l][1].indexOf("!")&&(null==h&&(h={}),h[b[l][0].toLowerCase()]=a.modify.flgs[m++]);h&&(a.modify.flags=h)}if(a.modify.flags)for(n in h=a.modify.flags,h)for(l=0;l<h[n].length;l++)1<h[n][l].length&&(p=Array(h[n][l][0]).fill(h[n][l][1]),
h[n]=h[n].slice(0,l).concat(p).concat(h[n].slice(l+1)))}}}},COMPRESSED_1_BASEDATE=18980101,DecodeCompressed_1_adjust=function(a){if(a&&0<a.length)for(var b=COMPRESSED_1_BASEDATE,f=0,g=0;g<a.length;g++)if(a[g][0]+=b,b=a[g][0],0<a[g][1].length)for(var e=0;e<a[g][1].length;e++)a[g][1][e][0]+=b,b=a[g][1][e][0],a[g][1][e][1]+=f,f=a[g][1][e][1];else a[g][1]+=f,f=a[g][1]},DecodeCompressed_1_last=function(a){if(a&&0<a.length)for(var b=COMPRESSED_1_BASEDATE,f=0,g=0,e=0;e<a.length;e++)a[e][0]+=b,b=a[e][0],
a[e][2]=a[e][1]+g,a[e][1]=f,g=a[e][2],f+=g},moveTableWindow_Down=function(a,b,f){var g=b.info,e=b.data;b=b.flags;var h=a.info,m=a.data,l=g.begin-h.begin,n=0;if(0<l){if(h.begin+h.rows>g.thisBegin&&e)if(n=h.begin+h.rows-g.thisBegin,"row"==g.rank)m.splice(h.rows-n,n);else for(var p=0;p<a.data.length;p++)m[p].splice(h.rows-n,n);if("row"==g.rank)m.splice(0,l);else for(p=0;p<m.length;p++)m[p].splice(0,l);for(var q in b)a.flags[q.toLowerCase()].splice(0,l)}h.rows-=l+n;h.begin=g.begin;if(e&&g.rows>h.rows){if("row"==
g.rank)e=makeRowData(f,e,b),null==a.data?a.data=e:xAppend(a.data,e);else{e=makeColData(f,e,b);for(p=0;p<f.length;p++)null==a.data[p]?a.data[p]=e[p]:xAppend(a.data[p],e[p]);g.totalRows>h.totalRows&&(a.dataStatus[g.rows-1]=2)}for(q in b)a.flags[q.toLowerCase()]&&xAppend(a.flags[q.toLowerCase()],b[q])}else if(g.rows<h.rows){n=h.rows-g.rows;if("row"==g.rank)m.splice(g.rows,n);else for(p=0;p<m.length;p++)m[p].splice(g.rows,n);for(q in b)a.flags[q.toLowerCase()].splice(g.rows,n)}g.dataRows=g.rows;g.dataBegin=
g.begin;h.dataRows=g.rows;h.dataBegin=g.begin},moveTableWindow_Up=function(a,b,f){var g=b.info,e=b.data;b=b.flags;var h=a.info,m=a.data,l=h.begin-g.begin,n=h.rows-l;l-=g.rows-h.rows;if("row"==g.rank)e=makeRowData(f,e,b),0<l&&m.splice(n,l),xAppend(e,m),a.data=e;else{e=makeColData(f,e,b);if(0<l)for(var p=0;p<m.length;p++)m[p].splice(n,l);for(p=0;p<f.length;p++)xAppend(e[p],m[p]),m[p]=e[p]}for(var q in b)f=q.toLowerCase(),0<l&&a.flags[f].splice(n,l),xAppend(b[q],a.flags[f]),a.flags[f]=b[q];g.dataRows=
g.rows;g.dataBegin=g.begin;h.dataRows=g.rows;h.dataBegin=g.begin},updateTableData=function(a,b,f){var g=b.info,e=b.data,h=b.flags,m=a.info,l=a.data;if(e&&0<e.length){if("row"==g.rank){if(e=makeRowData(f,e,h))if(g.thisBegin<m.dataBegin){for(var n=m.dataBegin-g.thisBegin,p=0;p<n;p++)l.unshift(null);for(p=0;p<e.length;p++)l[p]=e[p];if(h)for(var q in h){if(null==a.flags[q.toLowerCase()])a.flags[q.toLowerCase()]=[];else for(p=0;p<n;p++)a.flags[q.toLowerCase()].unshift(null);for(p=0;p<h[q].length;p++)a.flags[q.toLowerCase()][p]=
h[q][p]}g.dataBegin=g.thisBegin}else if(g.thisBegin>=m.dataBegin){p=n=g.thisBegin-m.dataBegin;for(b=0;b<e.length;p++,b++)l[p]=e[b];if(h)for(q in h)for(null==a.flags[q.toLowerCase()]&&(a.flags[q.toLowerCase()]=[]),p=n,b=0;b<h[q].length;p++,b++)a.flags[q.toLowerCase()][p]=h[q][b];g.dataBegin=m.dataBegin}g.dataRows=l.length}else{if(e=makeColData(f,e,h)){if(null==l){for(n in b)a[n]=b[n];a.data=e;return}if(g.thisBegin<m.dataBegin){n=m.dataBegin-g.thisBegin;for(var v=0;v<f.length;v++){for(p=0;p<n;p++)l[v].unshift(null);
for(p=0;p<e[v].length;p++)l[v][p]=e[v][p]}if(h)for(q in h)if(null==a.flags[q.toLowerCase()])a.flags[q.toLowerCase()]=h[q];else{for(p=0;p<n;p++)a.flags[q.toLowerCase()].unshift(null);for(p=0;p<h[q].length;p++)a.flags[q.toLowerCase()][p]=h[q][p]}g.dataBegin=g.thisBegin}else if(g.thisBegin>=m.dataBegin){n=g.thisBegin-m.dataBegin;for(v=0;v<f.length;v++)for(null==l[v]&&(l[v]=[]),p=n,b=0;b<e[v].length;p++,b++)l[v][p]=e[v][b];if(h)for(q in null==a.flags&&(a.flags={}),h)if(h[q])for(null==a.flags[q.toLowerCase()]&&
(a.flags[q.toLowerCase()]=[]),p=n,b=0;b<h[q].length;p++,b++)a.flags[q.toLowerCase()][p]=h[q][b];g.dataBegin=m.dataBegin}}g.dataRows=l&&l[0]?l[0].length:0}m.dataRows=g.dataRows;m.dataBegin=g.dataBegin}else if(0==g.totalRows){if("row"==g.rank)a.data=[];else for(a.data=[],v=0;v<f.length;v++)a.data[v]=null;m.rows=0;m.dataRows=0;m.dataBegin=0;m.totalRows=0;m.thisBegin=0}else if(g.begin>=m.begin&&g.begin+g.rows<=m.begin+m.rows){if("row"==g.rank){g.begin>m.dataBegin&&l.splice(0,g.begin-m.dataBegin);0<l.length-
g.rows&&l.splice(g.rows,l.length-g.rows);if(a.flags)for(q in a.flags)a.flags[q]&&(a.flags[q].splice(0,g.begin-m.dataBegin),0<a.flags[q].length-g.rows&&a.flags[q].splice(g.rows,a.flags[q].length-g.rows));g.dataRows=l.length}else try{if(g.begin>m.dataBegin){for(v=0;v<l.length;v++)l[v].splice(0,g.begin-m.dataBegin),0<l[v].length-g.rows&&l[v].splice(g.rows,l[v].length-g.rows);if(a.flags)for(q in a.flags)a.flags[q]&&(a.flags[q].splice(0,g.begin-m.dataBegin),0<a.flags[q].length-g.rows&&a.flags[q].splice(g.rows,
a.flags[q].length-g.rows))}else g.begin=m.dataBegin;g.dataRows=l[0].length}catch(u){console.log(u)}g.dataBegin=g.begin;m.dataBegin=g.dataBegin;m.dataRows=g.dataRows;m.begin=g.begin;m.rows=g.rows}else g.dataBegin=m.dataBegin,g.dataRows=m.dataRows};
function rotateTable(a,b){a=a.table;if("row"==a.info.rank&&a.field&&a.data)for(var f=0;f<a.field.length;f++)if(a.field[f][0].toLowerCase()==b.field.toLowerCase()){a.rotate={};var g=[],e=a.field[f][1];g[0]=[b.field,null!=e?e:"t"];for(var h=0;h<a.data.length;h++)a.data[h]&&(g[g.length]=[a.data[h][f],null!=e?e:"*"]);a.rotate.field=g;a.rotate.data=[];for(h=0;h<a.field.length;h++)a.field[h][0].toLowerCase()!=b.field.toLowerCase()&&(a.rotate.data[a.rotate.data.length]=a.field[h]);break}}
function xSocketDecode(a,b,f){f=0;void 0==a.result&&(a.result=[]);for(var g=a.orgLen=0;g<b.result.length;g++){var e=b.result[g].table;if(null!=e){var h=e.info,m=e.gid;null==m&&(m=b.result[g].gid);h.name=m.name;null==h.msg&&(h.msg="");var l=parseInt(m.idx);if(!a.nameList||!a.nameList[l]||a.nameList[l].query.scriptId==m.id){var n,p=!1;if("update"==h.type||a.cacheWindow&&a.cacheWindow[l])p=!0;h.begin--;h.thisBegin&&h.thisBegin--;var q=e.field,v=e.data,u=e.last,D=e.adjust,F=e.modify,z=e.push,y=q;null==
y&&a.result&&a.result[l]&&a.result[l].table&&(y=a.result[l].table.field);if(null==y&&a.result[l]&&a.result[l].table&&null==a.result[l].table.field)a.result[l]=null;else{if(h.q&1&&0==h.totalRows&&a.result&&a.result[l])break;DecodeCompressed_1(e,y,f);var B=e.flags;"row"!=h.rank&&"col"!=h.rank&&(h.rank="row");void 0==a.result[l]&&(a.result[l]={updateCounter:0});void 0==a.result[l].table&&(a.result[l].table={});!a.result[l].table.push||null!=h.q&&0!=(h.q&1)||(a.result[l].table.push=null);a.result[l].updateCounter=
createUpdateCounter(a.result[l].updateCounter);h.noChartData=a.nameList[l].noChartData;h.synchField=a.nameList[l].synchField;var t=!1;var G=a.result[l].table.info;if(void 0==G){if(null==v&&F){a.result[l]=null;continue}a.result[l].table.info=xDeepCopy(h);t=!0}else if(null==a.result[l].gid||a.result[l].gid.id!=m.id)t=!0;else if(q&&e.data&&("row"==h.rank&&h.rows==e.data.length||"col"==h.rank&&h.rows==e.data[0].length&&null==h.q))t=!0;else if(G.dataBegin+G.dataRows<h.begin||h.begin+h.rows<G.dataBegin){if(null==
v&&null==F){0==h.totalRows?(h.begin=0,h.rows=0,h.dataBegin=0,h.dataRows=0,a.result[l].table.info=h,a.result[l].table.data=[],a.result[l].table.flags={},a.result[l].table.dataStatus=[]):(a.result[l].table.info.begin=h.begin,a.result[l].table.info.rows=h.rows,a.result[l].table.info.totalRows=h.totalRows);continue}t=2;void 0==y&&(y=a.result[l].table.field);null==q&&(q=y)}else h.begin==h.thisBegin&&v&&("row"==h.rank?v.length==h.rows&&(t=!1):v&&v[0]&&v[0].length==h.rows&&(t=!1));if(t&&null==F)if(2!=t&&
(a.result[l].table={}),a.result[l].table.data=[],a.result[l].table.flags={},a.result[l].table.field=[],a.result[l].table.dataStatus=[],v){if("row"==h.rank){if(t=makeRowData(y,v,B))a.result[l].table.data=t,h.dataBegin=h.thisBegin,h.dataRows=t.length}else(t=makeColData(y,v,B))&&0<t.length&&(a.result[l].table.data=t,h.dataBegin=h.thisBegin,h.dataRows=t[0].length);if(B&&0<Object.keys(B).length)if(p)for(n in B)a.result[l].table.flags[n.toLowerCase()]=B[n];else if("row"==h.rank)for(n in B){var x=0;var J=
n.toLowerCase();a.result[l].table.flags[J]=[];for(t=h.begin;x<B[n].length;x++,t++)a.result[l].table.flags[J][t]=B[n][x]}else for(n in B)if(x=0,J=n.toLowerCase(),a.result[l].table.flags[J]=[],null!=B[n])for(t=0;x<B[n].length;x++,t++)a.result[l].table.flags[J][t]=B[n][x]}else h.dataBegin=0,h.dataRows=0;else if(a.result[l].table.dataStatus=[],p)if(updateTableData(a.result[l].table,e,y),B=a.result[l].table.info,"row"==h.rank){if(B.begin<h.begin){B=h.begin-B.begin;a.result[l].table.data.splice(0,B);if(a.result[l].table.flags)for(n in a.result[l].table.flags)a.result[l].table.flags[n].splice(0,
B);h.dataBegin+=B}else if(B.begin+a.result[l].table.data.length>h.begin+h.rows){a.result[l].table.data.splice(h.rows);if(a.result[l].table.flags)for(n in a.result[l].table.flags)a.result[l].table.flags[n].splice(h.rows);h.dataBegin=h.begin}h.dataRows=a.result[l].table.data.length}else{if(a.result[l].table.data&&a.result[l].table.data.length){if(B.begin<h.begin){B=h.begin-B.begin;for(J=0;J<y.length;J++)a.result[l].table.data[J]&&a.result[l].table.data[J].splice(0,B);h.dataBegin+=B}else if(h.rows&&
a.result[l].table.data&&a.result[l].table.data[0]&&B.begin+a.result[l].table.data[0].length>h.begin+h.rows)for(J=0;J<y.length;J++)a.result[l].table.data[J].splice(h.rows);h.dataRows=a.result[l].table.data&&a.result[l].table.data[0]?a.result[l].table.data[0].length:0}}else updateTableData(a.result[l].table,e,y);if(F){if(a.result[l].table.dataStatus)for(t=0;t<a.result[l].table.dataStatus.length;t++)void 0==a.result[l].table.dataStatus[t]&&(a.result[l].table.dataStatus[t]=0);if(null==v&&F.flags)for(n in F.flags)for(B=
0;B<F.record.length;B++)t=F.flags[n][B],x=F.record[B]-1,x-=a.result[l].table.info.dataBegin,J=n.toLowerCase(),void 0==a.result[l].table.flags[J]&&(a.result[l].table.flags[J]=[]),a.result[l].table.flags[J][x]=t;B=a.result[l].table.flags;if("updateappend"==h.type)if(t=F.record[0]-1,t<h.begin||t>=h.begin+h.row)console.log("updateappend \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{p&&(t-=h.begin);v=1;var A=0;x=0;if(F.data&&F.data[x])for(var H=0;H<F.data[x].length;H++)A+=F.data[x][H].length;if("row"==
h.rank)for(H=0;H<A;H++){if(J=getModifyFieldIndex(F.data[x][0],H),!(J>=y.length)){if("x"==y[J][1][0]){var I=parseInt(y[J][1][1]),N=null;B&&(N=B[y[J][0].toLowerCase()]);N&&N[t]&&3==(N[t]&3)?a.result[l].table.data[t][J]=null:(N&&N[t]&&0<(N[t]>>5&7)&&(I=(N[t]>>5&7)-1),a.result[l].table.data[t][J]=null==a.result[l].table.data[t][J]?F.data[v]/decodeXx[I]:a.result[l].table.data[t][J]+F.data[v]/decodeXx[I],a.result[l].table.data[t][J]=parseFloat(a.result[l].table.data[t][J].toFixed(I)))}else"i"==y[J][1][0]?
a.result[l].table.data[t][J]="."==y[J][1][2]?F.data[v]:a.result[l].table.data[t][J]+F.data[v]:"t"!=y[J][1]&&"t"==y[J][1][0]?a.result[l].table.data[t][J]+=F.data[v]:"d"==y[J][1][0]?a.result[l].table.data[t][J]+=F.data[v]:"g"==y[J][1][0]?a.result[l].table.data[t][J][2]&&(I=a.result[l].table.data[t][J][2],a.result[l].table.data[t][J][0]==F.data[v][0]&&(v=a.result[l].table.data[t][J][I-1].length,a.result[l].table.data[t][J][I-1][v-1]=F.data[v][0])):a.result[l].table.data[t][J]=F.data[v];v++}}else for(H=
0;H<A;H++)J=getModifyFieldIndex(F.data[x],H),y[J]&&"x"==y[J][1][0]&&y[J][1][1]?(I=parseInt(y[J][1][1]),N=null,B&&(N=B[y[J][0].toLowerCase()]),N&&N[t]&&3==(N[t]&3)?a.result[l].table.data[t][J]=null:(N&&N[t]&&0<(N[t]>>5&7)&&(I=(N[t]>>5&7)-1),a.result[l].table.data[J][t]=null==a.result[l].table.data[J][t]?F.data[v]/decodeXx[I]:a.result[l].table.data[J][t]+F.data[v]/decodeXx[I],a.result[l].table.data[J][t]=parseFloat(a.result[l].table.data[J][t].toFixed(I)))):y[J]&&"i"==y[J][1][0]?a.result[l].table.data[J][t]=
"."==y[J][1][2]?F.data[v]:a.result[l].table.data[J][t]+F.data[v]:y[J]&&"t"!=y[J][1]&&"t"==y[J][1][0]?a.result[l].table.data[J][t]+=F.data[v]:y[J]&&"d"==y[J][1][0]?a.result[l].table.data[J][t]+=F.data[v]:y[J]&&"g"==y[J][1][0]||a.result&&a.result[l]&&a.result[l].table&&a.result[l].table.data&&a.result[l].table.data[J]&&F.data&&F.data[v]&&(a.result[l].table.data[J][t]=F.data[v]),v++;a.result[l].table.dataStatus[t]=1}else if(F.data){if(z&&null!=z.k){var M=[];x=z.k;for(t=0;t<a.result[l].table.data.length;t++)M[t]=
[],M[t][x]=a.result[l].table.data[t][x]}for(x=0;x<F.record.length;x++)if(t=F.record[x]-1,null!=F.data[x]&&0!=F.data[x].length)if(t<h.begin||t>=h.begin+h.rows)console.log("update \u8d85\u51fa\u7a97\u53e3\u8303\u56f4!");else{p&&(t-=h.begin);v=1;for(H=A=0;H<F.data[x][0].length;H++)A+=F.data[x][0][H].length;for(H=0;H<A;H++){J=getModifyFieldIndex(F.data[x][0],H);null==a.result[l].table.data[t]&&(a.result[l].table.data[t]=[]);if(void 0!=a.result[l].table.data[t])if(y[J]&&y[J][1]&&"x"==y[J][1][0])I=parseInt(y[J][1][1]),
N=null,B&&(N=B[y[J][0].toLowerCase()]),N&&N[t]&&3==(N[t]&3)?a.result[l].table.data[t][J]=null:(N&&N[t]&&0<(N[t]>>5&7)&&(I=(N[t]>>5&7)-1),a.result[l].table.data[t][J]=null==a.result[l].table.data[t][J]?F.data[x][v]/decodeXx[I]:a.result[l].table.data[t][J]+F.data[x][v]/decodeXx[I],a.result[l].table.data[t][J]=parseFloat(a.result[l].table.data[t][J].toFixed(I)));else if(y[J]&&y[J][1]&&"i"==y[J][1][0])a.result[l].table.data[t][J]="."==y[J][1][2]?F.data[x][v]:null==a.result[l].table.data[t][J]?F.data[x][v]:
a.result[l].table.data[t][J]+F.data[x][v];else if(y[J]&&"t"!=y[J][1]&&"t"==y[J][1][0]&&"a"!=y[J][1][1]&&"A"<=y[J][1][1])null==a.result[l].table.data[t][J]&&(a.result[l].table.data[t][J]=0),a.result[l].table.data[t][J]="1"==h.compressed?"ts"==y[J][1][1]?a.result[l].table.data[t][J]+1E3*F.data[x][v]:"tm"==y[J][1][1]?a.result[l].table.data[t][J]+6E4*F.data[x][v]:a.result[l].table.data[t][J]+F.data[x][v]:a.result[l].table.data[t][J]+F.data[x][v];else if(y[J]&&y[J][1]&&"d"==y[J][1][0])a.result[l].table.data[t][J]+=
F.data[x][v];else if(y[J]&&y[J][1]&&"g"==y[J][1][0]){if(a.result[l].table.data[t]&&a.result[l].table.data[t][J]&&a.result[l].table.data[t][J][2]){I=a.result[l].table.data[t][J][2];N=a.result[l].table.data[t][J][0];for(var C=0;C<I-1;C++)N-=a.result[l].table.data[t][J][3+C][0]+1;if("1"==h.compressed){if(a.result[l].table.data[t][J][3+I-1][N-1]=F.data[x][v][0],1<F.data[x][v].length)for(C=1;C<F.data[x][v].length;C++)a.result[l].table.data[t][J][3+I-1][N+C-1]=a.result[l].table.data[t][J][3+I-1][N+C-2],
a.result[l].table.data[t][J][0]++}else if(a.result[l].table.data[t][J][3+I-1][N-1]=F.data[x][v][0],1<F.data[x][v].length)for(C=1;C<F.data[x][v].length;C++)a.result[l].table.data[t][J][3+I-1][N+C-1]=F.data[x][v][C],a.result[l].table.data[t][J][0]++}}else M?(M[t]=[],M[t][J]=F.data[x][v]):a.result[l].table.data[t][J]=F.data[x][v];v++}a.result[l].table.dataStatus[t]=1}M&&(a.result[l].table.data=M);G.dataRows=a.result[l].table.data.length}h.dataRows=G.dataRows}a.result[l].localCache=!1;h&&(null==h.dataBegin||
null==h.name?a.result[l].table.info&&(h.dataBegin=a.result[l].table.info.dataBegin,h.dataRows=a.result[l].table.info.dataRows,h.name=a.result[l].table.info.name,a.result[l].localCache=!0,a.result[l].table.info.begin=h.begin,a.result[l].table.info.rows=h.rows):h.q&1?e.data&&(p=e.data[0].length-(h.begin-h.dataBegin),a.result[l].table.info=xDeepCopy(h),h.rows=p):a.result[l].table.info=xDeepCopy(h));if(q){if(a.result[l].table.field=xDeepCopy(q),a.alias&&a.alias[l])for(q=a.alias[l].split(","),v=0;v<q.length&&
v<y.length;v++)""!=q[v]&&(a.result[l].table.field[v][0]=trim(q[v]))}else!y||null!=a.result[l].table.field&&0!=a.result[l].table.field.length||(a.result[l].table.field=y);D&&(a.result[l].table.adjust=xDeepCopy(D),"1"==h.compressed&&DecodeCompressed_1_adjust(a.result[l].table.adjust));u&&(a.result[l].table.last=xDeepCopy(u),"1"==h.compressed&&DecodeCompressed_1_last(a.result[l].table.last));z&&(a.result[l].table.push=xDeepCopy(z),a.result[l].subscribe=!0);a.rotate[l]&&rotateTable(a.result[l],a.rotate[l]);
for(n in e)u=n.toLowerCase(),"gid"!=u&&"info"!=u&&"data"!=u&&"modify"!=u&&"field"!=n&&"flags"!=u&&"flgs"!=u&&"adjust"!=u&&"last"!=u&&"push"!=u&&("1"==h.compressed&&DecodeCompressed_1(e[n].table,null,f),a.result[l].table[n]=e[n]);a.result[l].updateCounter=createUpdateCounter(a.result[l].updateCounter);a.result[l].gid=xDeepCopy(m)}}}}return a.result}function isEmptyObject(a){return 0<Object.keys(a).length?!1:!0}
function isPost(a){var b=globalPage.getActivePage();return void 0!=b?20<a?!0:"global"==a?!0:b.getPageId()==a?!0:!1:!0}var globalPage,resetQuery=function(){if(xSocket&&xSocket.queryList)for(var a in xSocket.queryList)if(xSocket.queryList[a])for(var b in xSocket.queryList[a])for(var f in xSocket.queryList[a][b]){var g=xSocket.queryList[a][b][f];g.needResendMessage=!0;void 0!=g.callback&&"active"==g.status&&resendMessage(g,a,b,f)}},debugWebSocket=null;
function WebsocketServer(a){function b(H,I,N){f.heartbeat.resetReceiveCount();xSocket.receivePackets++;xSocket.receiveSize+=H.length;try{var M="["==H[0]?JSON.parse(H):[JSON.parse(H)]}catch(S){M=H.indexOf('"gid":{');if(-1!=M){var C=H.indexOf('"result"');M="{"+H.slice(M,C-1)+"}";M=JSON.parse(M);var E=""+M.gid.fm,K=""+M.gid.pg,Q=""+M.gid.idx;if(xSocket.queryList[E]&&xSocket.queryList[E][K]&&xSocket.queryList[E][K][Q]){var O=xSocket.queryList[E][K][Q];console.log("x \u63a5\u6536\u6570\u636e\u9519\u8bef: Fm:"+
E+",Pg:"+K+",Idx:"+Q+"\r\n"+O.server[0].message+"\nresult:"+H);if(O.result&&O.callback){for(I=0;I<O.result.length;I++)O.result[I]&&(O.result[I].updateCounter=createUpdateCounter(O.result[I].updateCounter));callback_result(O,"sql")}}else console.log("x \u63a5\u6536\u6570\u636e\u9519\u8bef\uff1aFm:"+E+",Pg:"+K+",Idx:"+Q+"\r\nresult:"+H)}console.log(S);return}if("login"==M[0].type){gtsVersion=M[0].gtsver;M[0].k&&(C=M[0].k,N=new XEnDecoder,C="["==C[0]&&"["==C[1]?C.replace(/__2__/g,'"'):N.decode(C),q=
JSON.parse(C));if(M[0].b&&(C=(new XEnDecoder).decode(M[0].b),C=JSON.parse(C),q=C.k,M[0].push=[],C.p))for(I=0;I<C.p.length;I++)M[0].push[I]={name:C.p[I].name,alias:C.p[I].alias,max:C.p[I].max,field:C.p[I].d.field,primaryKey:C.p[I].d.primaryKey,subtables:C.p[I].d.subtables,tables:C.p[I].d.tables,ver:C.p[I].d.ver};null!=M[0].requestMode&&1==M[0].requestMode&&(f.requestMode="increment");if(M[0].push)for(I=0;I<M[0].push.length;I++)v.start(M[0].push[I],q);"undefined"!=typeof aboutMe&&null==aboutMe&&"undefined"==
typeof NSDK?(aboutMe=new XMe(window),xGlobal.aboutMe=aboutMe,aboutMe.initMainBody(),document.getElementById("mainBody").style.overflow="hidden"):0==isInitConnect&&(isInitConnect=this.connectStatus=!0,u&&u.clearAll(),v&&v.clearAll(),f.sendPushSubscribeRequest(),resetQuery());null!=B&&B(H)}else if(M){tolrecv++;H=0;var L={};for(I=0;I<M.length;I++){var P=M[I];P.type&&"close"==P.type?D=P.info:P.type&&"push"==P.type?v&&("overflow"in P&&"undefined"!==typeof NSDK&&NSDKLog.error("SZSE:(xWebservice.onReceiveMessage)\u8ba2\u9605\u4ee3\u7801\u8d85\u51fa\u4e0a\u9650"),
v.onMessage(P,u)):P.gid&&"heartbeat"==P.gid.fm||!P.gid||(E=""+P.gid.fm,K=""+P.gid.pg,Q=""+P.gid.idx,null==L[E+"_"+K]&&(L[E+"_"+K]=getPageFromFramePage(E,K),L[E+"_"+K]&&L[E+"_"+K].beginQuery("onReceiveMessage")),xSocket.queryList[E]&&xSocket.queryList[E][K]&&xSocket.queryList[E][K][Q]&&(O=xSocket.queryList[E][K][Q],O.result=xSocketDecode(O,P,N),v&&v.setSubscribe(O),u&&u.save(O),H+=O.orgLen,"undefined"!=typeof NSDK?O.result&&O.callback&&(P=xDeepCopy(O.result),E=create_NSDK_pack(E,K,Q,P,M[0].type),O.callback(E,
"sql")):(1==O.globalSub?O.callback(P,O.result):O.result&&O.callback&&callback_result(O,"sql"),debugWebSocket&&P.gid.fm==debugWebSocket.gid.fm&&P.gid.pg==debugWebSocket.gid.pg&&P.gid.idx==debugWebSocket.gid.idx&&(console.log("receive : "+debugWebSocket.receiveCounter++),console.log("\u539f\u59cb:"+JSON.stringify(P)),console.log("\u8fd8\u539f:"+JSON.stringify(O.result))))))}if(v)if("undefined"!=typeof NSDK)x(L);else for(C in(M=v.getNewSubscribeMessage())&&f.send(M),L)L[C]&&L[C].endQuery("onReceiveMessage");
return H}}var f=this,g=a,e,h=0,m,l=!1;this.state=!1;this.activeCloseQuote=null;var n=0,p=0,q,v=new XPushSubscribe,u;"undefined"!=typeof XLocalCache&&(u=new XLocalCache);var D=null,F=null,z=null,y=null,B=null,t="web";this.setUrl=function(H){g=H};this.getUrl=function(){return g};this.set_onOpen=function(H){F=H};this.set_onMessage=function(H){B=H};this.set_onClose=function(H){z=H};this.set_onError=function(H){y=H};this.close=function(H,I){e.webSocket.close(H,I)};this.set_activeCloseQuote=function(H){this.activeCloseQuote=
H};this.checkPushSubscribe=function(H,I,N){if(v)return v.checkPushSubscribe(H,I,N)};this.removePushSubscribe=function(H,I,N){if(v)return v.removeWidget(H,I,N)};this.sendPushSubscribeRequest=function(H){if("undefined"!=typeof NSDK)x();else if(v&&(H=v.getNewSubscribeMessage(H)))return f.send(H),!0};this.getPushFieldDefine=function(H){if(v)return v.getPushFieldDefine(H)};this.readCache=function(H,I,N){if(u&&I)return u.read(H,I,N)};var G=!0,x=function(H){return function(I){G&&(G=!1,H.apply(this,arguments))}}(function(H){setTimeout(function(){if(v){var I=
v.getNewSubscribeMessage(!0);I&&f.send(I);if(H)for(var N in H)H[N]&&H[N].endQuery("onReceiveMessage")}G=!0},50)});this.clear=function(){this.socket&&(l=!0,this.socket.onmessage=function(){},this.socket.onopen=function(){},this.socket.onerror=function(){},this.socket.onclose=function(){})};this.connect=function(){var H=this;"undefined"==typeof window||window.WebSocket?"undefined"!=typeof getEnvInfo&&"function"==typeof getEnvInfo&&"cpp"==getEnvInfo()&&(t="cpp"):window.WebSocket=window.MozWebSocket;
if("undefined"!=typeof window&&window.WebSocket||"cpp"==t){"undefined"!=typeof NSDKLog&&NSDKLog.log("SZSE:(xWebservice.connect)\u5f00\u59cb\u521b\u5efa XWebSocket");var I,N;[0,1,2].includes(null==(I=e)?void 0:null==(N=I.webSocket)?void 0:N.readyState)&&(NSDKLog.info("SZSE:(xWebservice: connect): \u521b\u5efa\u65b0 websocket \u524d socket \u72b6\u6001\uff1a"+e.webSocket.readyState),this.clear(),e.webSocket.close(1E3,""));this.socket=e=new XWebSocket(g,"ncloud");var M=setTimeout(function(){0===e.webSocket.readyState&&
(NSDKLog.info("SZSE:(xWebservice: connect): \u65b0 socket 3s \u6ca1\u6709\u8fde\u901a\uff1a"+e.webSocket.readyState),H.clear(),f.activeCloseQuote());M=null},3E3);e.binaryType="arraybuffer";NSDKLog.info("SZSE:(xWebservice.connect)\u5f00\u59cb\u884c\u60c5\u8fde\u63a5: "+g);this.socket.onmessage=function(C){if(null!=C&&C.data)if(connectTest=0,"{"==C.data[0]||"["==C.data[0])b(C.data,f,h);else{var E=[];E=E.concat(Array.from(new Uint8Array(C.data)));if(29>E[0])C=(new XGtsJason(q)).decompress_json(E);else if("string"===
typeof E)C=E;else{C="";for(var K=0;K<E.length;K++){var Q=E[K].toString(2),O=Q.match(/^1+?(?=0)/);if(O&&8==Q.length){Q=O[0].length;O=E[K].toString(2).slice(7-Q);for(var L=1;L<Q;L++)O+=E[L+K].toString(2).slice(2);C+=String.fromCharCode(parseInt(O,2));K+=Q-1}else C+=String.fromCharCode(E[K])}}"undefined"!=typeof window&&null!=window&&null!=window.localStorage&&window.localStorage.getItem("wsLog")&&console.log(getNowSaftTime(),"\u8fd4\u56de\u6570\u636e: "+C);b(C,f,h);p++}};this.socket.onopen=function(C){M&&
(clearTimeout(M),M=null);null!=C&&(null!=F?(1==l&&(isInitConnect=!1),F(C)):(1==l&&(null==m?"undefined"!=typeof XMessageTip&&(m=new XMessageTip(window,[{title:"\u8fde\u63a5\u6210\u529f!",textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:14,marginTop:5}],"\ud83d\udd17",J)):"undefined"!=typeof XMessageTip&&m.setMessage([{title:"\u8fde\u63a5\u6210\u529f!",textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:14,marginTop:5}],"\ud83d\udd17"),null!=m&&m.close(3E3),
isInitConnect=!1),mainWebServer&&mainWebServer.dbserverLogin&&mainWebServer.dbserverLogin()))};this.socket.onerror=function(C){null!=C&&null!=y&&y(C)};this.socket.onclose=function(C){M&&(clearTimeout(M),M=null);null!=C&&(1008==C.code&&(D=C.reason),null!=z?(l=!0,"DONT_CONNECT"==z(C)&&(clearxSocket(),null!=u&&null!=u.clearAll&&u.clearAll())):D?(m=new XMessageTip(window,[{title:D.msg,lineHeight:20,textBaseLine:"top",height:20,layerType:"normal",fontSize:14,marginTop:5}],"\u26a0\ufe0f",""),m.close(5E3),
D=null):function(){setTimeout(function(){l=!0;f.connect();null==m?"undefined"!=typeof XMessageTip&&(m=new XMessageTip(window,[{title:"\u8fde\u63a5\u4e2d\u65ad\uff0c\u6b63\u5728\u91cd\u8fde......",lineHeight:20,textBaseLine:"top",height:20,layerType:"normal",fontSize:14,marginTop:5}],"\u26a0\ufe0f",J)):"undefined"!=typeof XMessageTip&&m.setMessage([{title:"\u91cd\u65b0\u8fde\u63a5\u5931\u8d25\uff0c\u6b63\u5728\u91cd\u8fde......",lineHeight:20,height:20,textBaseLine:"top",layerType:"normal",fontSize:14,
marginTop:5}],"\u26a0\ufe0f")},3E3)}())};"cpp"==t&&e.webSocket.Connect()}else alert("Your browser does not support Web Socket.")};var J=function(){m=null};this.send=function(H){"undefined"!=typeof window&&null!=window&&null!=window.localStorage&&window.localStorage.getItem("wsLog")&&console.log(getNowSaftTime(),"\u53d1\u9001\u6570\u636e: "+H);if("cpp"==t)"undefined"!=typeof NSDKLog&&NSDKLog.log("SZSE:(xWebservice.send)\u5411CPP\u53d1\u9001\u8bf7\u6c42: "+H);else if("undefined"!=typeof window&&!window.WebSocket)return;
if("cpp"==t||e.readyState==WebSocket.OPEN){if(gtsVersion){var I=(new XGtsJason(q)).compress_json(H,10);if(I){I[0]=152;I[1]=190;for(var N=I.length-10,M=2;6>M;M++)I[M]=32+N%223,N=parseInt(N/223);H=H.length;for(M=6;10>M;M++)I[M]=32+H%223,H=parseInt(H/223);e.send(I.buffer);xSocket.sendSize+=I.length}else e.send(H),xSocket.sendSize+=H.length}else e.send(H),xSocket.sendSize+=H.length;n++;xSocket.sendPackets++}};this.login=function(H,I){var N=(new Date).getTime();h=0;f.send(' {"type":"login","gid":{"pg":"1","idx":"-1"},"account":"'+
H+'", "password":"'+I+'", "time":'+N+"}")};var A=function(){f.send(JSON.stringify({lang:"zh-cn",gid:{fm:"heartbeat",pg:"test",idx:"0"},type:"heartbeat"}))};this.heartbeat={senderCounter:0,receiverCounter:0,timeoutEvent:null,incrementCount:function(){this.senderCounter++;this.receiverCounter++},startHeartbeat:function(){this.stopHeartBeat();this.triggerTimer()},stopHeartBeat:function(){this.receiverCounter=this.senderCounter=0;NSDKLog.log("SZSE:(stopHeartBeat): outside: "+typeof this.timeoutEvent);
"number"===typeof this.timeoutEvent&&(NSDKLog.log("SZSE:(stopHeartBeat): inside: "+this.timeoutEvent),this.timeoutEvent&&(clearTimeout(this.timeoutEvent),this.timeoutEvent=null))},resetReceiveCount:function(){this.receiverCounter=0},triggerTimer:function(){var H=this;this.timeoutEvent=setTimeout(function(){H.triggerTimer();var I=!1;if(1===e.webSocket.readyState){H.incrementCount();if(9<H.receiverCounter)H.senderCounter=0,H.receiverCounter=0,NSDKLog.info("xWebservice \u4e2d\u5fc3\u8df3\u68c0\u6d4b\uff0c\u957f\u65f6\u95f4\u672a\u6536\u5230\u6d88\u606f\u8fd4\u56de\uff0c\u89e6\u53d1\u91cd\u65b0\u767b\u5f55"),
f.close(),f.activeCloseQuote();else if(3===H.receiverCounter||6===H.receiverCounter)f.sendPushSubscribeRequest(!0),A(),I=!0;120<=H.senderCounter&&!I&&(A(),H.senderCounter=0)}else H.senderCounter=0,H.receiverCounter=0},1E3)}};this.heartbeat.startHeartbeat()}function getCookie(a){if("undefined"==typeof document)return null;a=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=a?unescape(a[2]):null}
function delCookie(a){var b=new Date;b.setTime(b.getTime()-1);var f=getCookie(a);null!=f&&(document.cookie=a+"="+f+";expires="+b.toGMTString())}function setCookie(a,b){document.cookie=a+"="+escape(b)}
function xRegister(){var a=document.createElement("div");a.id="registerAccountDialog";var b=document.createAttribute("style");b.value="position:absolute;left:50%;top:50%;width:300px;height:240px;margin-left:-180px;margin-top:-150px;background-color:#ddd;padding:30px;";b.value+="border:1px solid #111;box-shadow:0px 0px 25px";a.setAttributeNode(b);a.innerHTML='<h2>Register</h2></br><div class="closeDialog" style="position:absolute;top:8px;right:8px;font-family:Webdings;font-size:20px" onclick="closeRegisterAccount()">\uf072</div><a">\u59d3\u540d:&ensp;</a><input style="margin:4px;padding:4px;width:200px;" type="text" id="registerUserName" required="required" placeholder="\u8f93\u5165\u7528\u6237\u59d3\u540d"/></br><a">\u8d26\u53f7:&ensp;</a><input style="margin:4px;padding:4px;width:200px;" type="text" id="registerAccount" required="required" placeholder="\u8f93\u5165\u8d26\u53f7"/></br><a">\u5bc6\u7801:&ensp;</a><input style="margin:4px;padding:4px;width:200px;" type="password" id="registerPassword0" required="required" placeholder="\u8f93\u5165\u5bc6\u7801"></input></br><a">\u9a8c\u8bc1:&ensp;</a><input style="margin:4px;padding:4px;width:200px;" type="password" id="registerPassword1" required="required" placeholder="\u518d\u8f93\u5165\u4e00\u6b21\u5bc6\u7801"></input></br><button type="button" style="left:50%;margin-left:60px;margin-top:8px;width:160px;padding:5px;font-size:18px;background-color:#66f;color:#fff;border:0px;border-radius:6px;" onclick="registerAccount()">\u63d0\u4ea4</button>';
document.getElementById("mainBody").appendChild(a);document.getElementById("registerUserName").focus()}function closeRegisterAccount(){var a=document.getElementById("registerAccountDialog");a.parentNode.removeChild(a)}
function registerAccount(){var a=document.getElementById("registerUserName").value,b=document.getElementById("registerAccount").value,f=eval("md5(document.getElementById('registerPassword0').value)"),g=eval("md5(document.getElementById('registerPassword1').value)");""==a?(alert("Please input name!"),document.getElementById("registerUserName").focus()):""==b?(alert("Please input account!"),document.getElementById("registerAccount").focus()):""==f?(alert("Please input password!"),document.getElementById("registerPassword0").focus()):
f!=g?(alert("\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u6837\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),document.getElementById("registerPassword0").focus()):send('{"type":"register", "account":"'+b+'", "password":"'+f+'", "name":"'+a+'"}')}function saftQueryCheck(a,b,f,g){if(xIdForKeyMap[a]&&xIdForKeyMap[a][b]&&xIdForKeyMap[a][b][f]){a=xIdForKeyMap[a][b][f].sqlList;for(var e in a)g[e]&&g[e].query&&g[e].query.script==a[e].sql||delete a[e]}}
function packHttpMessage(a,b,f,g,e,h,m){var l={gid:{name:"",id:""},type:"",field:[],condition:{}},n=xGlobal.country;n={lang:null!=n?n:"zh-cn",gid:{fm:"",pg:"",idx:""},http:[]};n.gid.fm=b;n.gid.pg=f;n.gid.idx=g;for(var p in e[h])null!=l[p]&&(l[p]="field"!=p||null!=e[h][p]&&""!=e[h][p]?e[h][p]:[]);n.http.push(l);n.http[0].gid={name:e[h].name,id:e[h].query.id+","+h};e[h].query.key&&(n.http[0].gid.key=e[h].query.key);n.http[0].type=a?a:"query";if(null!=n.http[0].field&&0<n.http[0].field.length){a=n.http[0].field.split(",");
b=[];for(f=0;f<a.length;f++)g=a[f].replace(/ /g,""),g=trim(g),g=g.toLowerCase(),b.push(g);n.http[0].field=b}if(null!=n.http[0].condition&&null!=e[h].query.condition){a=e[h].query.condition;var q;null!=e[h].must&&(q=e[h].must.split(","));if(1==a.startsWith("select")){q=scriptES(a,q);if(null!=q.condition)var v=q.condition;null!=q.field&&(n.http[0].field=q.field);if(0==q.mustCheckStatu)return}else if(q=analysisES(a,q),v=q.esCondition,0==q.mustCheckStatu)return;null!=e[h].param&&(v.param=e[h].param);
n.http[0].condition=v}null!=e[h].query.limit&&0<e[h].query.limit.length?e[h].batchMode&&"limit"==e[h].batchMode.toLowerCase()?(n.http[0].from=e[h].query.limit[0],n.http[0].fromSize=e[h].query.limit[1]):(n.http[0].pageNo=e[h].query.limit[0],n.http[0].pageSize=e[h].query.limit[1]):(n.http[0].pageNo=e[0].pageNo?e[0].pageNo:"0",n.http[0].pageSize=e[0].pageSize?e[0].pageSize:"10");m.name=n.http[0].gid.name;m.id=n.http[0].gid.id;return JSON.stringify(n)}
function getHttpHeader(){var a=getCookie("access_token"),b=getCookie("userType");b=null==b?"0":b;"undefined"!=typeof GTenant&&(a=GTenant.sharedInstance().getUserData(),a=null!=a.accesstoken?a.accesstoken:a.access_token);null==a&&"undefined"!=typeof window&&null!=window&&null!=window.localStorage&&(a=window.localStorage.getItem("G_access_token"));return{"Content-Type":"application/json;charset=utf-8",usertype:b,Authorization:"Bearer "+a}}
function savaCallbackList(a,b,f,g,e,h,m){var l=""+b,n=""+f,p=""+g;null==a[l]&&(a[l]={});null==a[l][n]&&(a[l][n]={});null==a[l][n][p]&&(a[l][n][p]={frameId:l,pageId:n,index:p});if(a[l][n][p].result)var q=a[l][n][p].result;else{q=[];for(var v=0;v<e.length;v++)q[v]={}}v=a[l][n][p].nameList?a[l][n][p].nameList:[];for(var u=a[l][n][p].alias?a[l][n][p].alias:[],D=a[l][n][p].rotate?a[l][n][p].rotate:[],F=a[l][n][p].cacheBusList?a[l][n][p].cacheBusList:[],z=a[l][n][p].id?a[l][n][p].id:[],y,B=0;B<e.length;B++)null!=
e[B].query&&e[B].http&&null!=e[B].query.condition&&(v[B]={},v[B].name=e[B].name,v[B].query=xDeepCopy(e[B].query),v[B].noChartData=e[B].noChartData,v[B].synchField=e[B].synchField,v[B].http=e[B].http,v[B].condition=e[B].query.condition,v[B].limit=e[B].query.limit,v[B].cache=0==e[B].cache?!1:!0,v[B].queryStatus=e[B].queryStatus,e[B].alias&&(u[B]=e[B].alias),e[B].rotate&&(D[B]=e[B].rotate),e[B].cacheBus&&(null==F&&(F=[]),F[B]=e[B].cacheBus),y=e[B].query.id+","+h);a=a[l][n][p];a.id=z;a.frameId=""+b;a.pageId=
""+f;a.index=""+g;a.callback=m;a.result=q;a.nameList=v;a.alias=u;a.rotate=D;a.cacheBusList=F;null==a.requestInfo&&(a.requestInfo={});a.requestInfo[""+y]=m}function findQueryPacket(a,b,f,g){a=""+a;b=""+b;f=""+f;var e;g[a]&&g[a][b]&&g[a][b][f]&&(e=g[a][b][f]);return e}
function deleteQueryPacket(a,b,f){var g=""+a.gid.fm,e=""+a.gid.pg;a=""+a.gid.idx;if(b[g]&&b[g][e]&&b[g][e][a]){var h=b[g][e][a];return null!=f&&null!=h.requestInfo&&null!=h.requestInfo[f]&&(f=delete h.requestInfo[f],0!=objLength(h.requestInfo))?f:delete b[g][e][a]}}var xTableDataCache={},lastClearTableDataCacheTime;
function setTableDataToCache(a,b,f){xTableDataCache[a]||(xTableDataCache[a]={updateTime:Date.parse(new Date),result:xDeepCopy(f)});if(f.table&&f.table.info){xTableDataCache[a].table||(xTableDataCache[a].table={data:[],field:[]});for(b=0;b<f.table.data.length;b++)xTableDataCache[a].table.data[b]=f.table.data[b];xTableDataCache[a].table.field=xDeepCopy(f.table.field);xTableDataCache[a].table.totalRows=f.table.info.totalRows}else return!1}
function getTableDataFromCache(a,b){if(xTableDataCache[a]){var f=Date.parse(new Date);if(lastClearTableDataCacheTime){if(3E4<f-lastClearTableDataCacheTime){lastClearTableDataCacheTime=f;for(var g in xTableDataCache)3E5<f-xTableDataCache[g].updateTime&&delete xTableDataCache[g];if(null==xTableDataCache[a])return}}else lastClearTableDataCacheTime=f;xTableDataCache[a].lastaccess=f;if(xTableDataCache[a].table){b?(0>=b[0]?(f=0,g=b[1]):(f=b[0]*b[1],g=f+b[1]),g>xTableDataCache[a].table.totalRows&&(g=xTableDataCache[a].table.totalRows)):
(f=0,g=null==xTableDataCache[a].table.info||"row"==xTableDataCache[a].table.info.rank?xTableDataCache[a].table.data.length:xTableDataCache[a].table.data[0].length);for(var e=[],h=f;h<g;h++)if(xTableDataCache[a].table.data[h])e[h]=xTableDataCache[a].table.data[h];else return;h=xTableDataCache[a].result.table.info;for(var m=f;m<g;m++)xTableDataCache[a].result.table.data[m]=e[m];var l=!1;m=0;for(var n=h.begin;n<xTableDataCache[a].result.table.data.length;n++)if(m++,!xTableDataCache[a].result.table.data[n])if(xTableDataCache[a].table.data[n])xTableDataCache[a].result.table.data[n]=
xTableDataCache[a].table.data[n];else{l=!0;break}if(1==l){xTableDataCache[a].result.table.data=[];m=0;for(l=f;l<g;l++)m++,xTableDataCache[a].result.table.data[l]=e[l];xTableDataCache[a].result.table.info.dataLength=m;h.begin=f;h.thisBegin=f;h.dataRows=xTableDataCache[a].result.table.data.length;h.rows=b?b[1]:h.dataRows}else f<h.begin&&(h.begin=f,h.thisBegin=f),h.dataRows=xTableDataCache[a].result.table.data.length,h.rows=g-f,xTableDataCache[a].result.table.info.dataLength=m;return xTableDataCache[a].result}}}
function refrshCacheTableData(a,b,f,g,e,h){if(getTableDataFromCache(e,h)&&(a=findQueryPacket(a,b,f,xSocket.queryList))&&a.callback){a.result||(a.result=[]);if(0==a.nameList[g].cache)return!1;a.result[g]&&(a.result[g].updateCounter=createUpdateCounter(a.result[g].updateCounter));callback_result(a);return!0}return!1}
function callback_result(a,b,f){b=void 0===b?"http":b;if(a.result&&a.callback)if("undefined"!=typeof NSDK){b=""+a.frameId;f=""+a.pageId;var g=""+a.index,e=xDeepCopy(a.result);b=create_NSDK_pack(b,f,g,e,null);a.callback(b,"sql")}else a.callback(a.result,b,void 0,void 0,f)}
function callback_cacheBus(a,b){if((b=findQueryPacket(b.fm,b.pg,b.idx,xSocket.queryList))&&b.result){for(var f=0;f<b.result.length;f++)null==b.result[f]&&(b.result[f]={updateCounter:0}),f==a.callbackList.queryIndex&&(b.result[f]=xDeepCopy(a.result),b.result[f]&&(b.result[f].updateCounter=createUpdateCounter(b.result[f].updateCounter)));if(null==a.callbackList.callback)return b.result;callback_result(b,"http","submitBus")}}
var httpMessage,gtsVersion,send_wsQuerys=function(a,b){var f=[],g=[],e=[];if(a){if("undefined"!==typeof NSDK&&0==(void 0===b?!1:b)){for(var h=null,m=0;m<a.length;m++)b=a[m],"cancel"===b.type?b.cancels.forEach(function(p){var q=p.frameId,v=p.pageId,u=p.index;mainWebServer&&mainWebServer.removePushSubscribe(q,v,u);if(xSocket.queryList[q]&&xSocket.queryList[q][v]&&xSocket.queryList[q][v][u]){var D=xSocket.queryList[q][v][u];h?D&&h.gid.idx.add(p.index):D&&(p=new Set([u]),h={lang:"zh-cn",gid:{fm:q,pg:v,
idx:p},type:"cancel"})}}):"query"===b.type&&b.querys.forEach(function(p){var q=p.frameId,v=p.pageId,u=p.index,D=p.queryInfo;p=p.callback;q.includes("GUI")?send_wsQuerys(a,!0):(D=makeWsMessage("query",q,v,u,D,p),h&&h.gid&&0<h.gid.idx.size&&h.gid.idx.has(u)&&(h.gid.idx.delete(u),0==h.gid.idx.size&&(h=null)),D.pushServer&&0<D.pushServer.length?(g.push(D.pushServer[0]),e.push(D.queryPacket)):D.server&&0<D.server.length&&D.server[0].req&&(p=D.server[0].req,0===D.server.length?server.push({server:D.server[0].server,
page:[{lang:"zh-cn",gid:{fm:q,pg:v,idx:u},req:D.server[0].req}]}):(q={lang:"zh-cn",gid:{fm:q,pg:v,idx:u},req:p},f[0]&&f[0].server===D.server[0].server?f[0].page.push(q):f.push({server:D.server[0].server,page:[q]}))))});var l,n;if(null==(l=h)?0:null==(n=l.gid)?0:n.idx)h.gid.idx=[].concat($jscomp.arrayFromIterable(h.gid.idx)),0==f.length?f[0]={server:mainWebServer,page:[h]}:f.forEach(function(p){p.server===mainWebServer&&p.page.unshift(h)})}else for(l=0;l<a.length;l++)if(1!=serviceIsIncrement(mainWebServer)&&
a[l].querys&&(1>=a[l].querys.length||null==gtsVersion))for(n=0;n<a[l].querys.length;n++)b=a[l].querys[n],"undefined"!=typeof GLink_client?GLink_client.sharedInstance().sendMessage("query",b.frameId,b.pageId,b.index,b.queryInfo,b.callback):sendMessage("query",b.frameId,b.pageId,b.index,b.queryInfo,b.callback);else for(m in n=function(p,q){for(var v=0;v<q.length;v++){var u=q[v],D=""+u.frameId,F=""+u.pageId,z=""+u.index;var y=null;if("pause"==p||"cancel"==p)if(1==serviceIsIncrement(mainWebServer))y=
makeStopMessage(p,D,F,z);else{sendMessage(p,D,F,z);continue}else if("restart"==p){if(xSocket.queryList[D]&&xSocket.queryList[D][F]&&null!=z){var B=xSocket.queryList[D][F][z];if(B&&B.queryInfo){for(y=0;y<B.queryInfo.length;y++)B.queryInfo[y].sql&&B.queryInfo[y].query&&(B.queryInfo[y].queryStatus=1);B.lastMessage=null;y=makeWsMessage("query",D,F,z,B.queryInfo,B.callback)}}}else y=makeWsMessage(p,D,F,z,u.queryInfo,u.callback);if(null!=y){if(y.pushServer&&y.pushServer.length){for(F=0;F<y.pushServer.length;F++){for(D=
0;D<g.length&&y.pushServer[F]!=g[D];D++);D==g.length&&g.push(y.pushServer[F])}for(F=0;F<e.length&&e[F]!=y.queryPacket;F++);F==e.length&&e.push(y.queryPacket)}if((y=y.server)&&0<y.length)for(c=0;c<y.length;c++){for(F=0;F<f.length&&f[F].server!=y[c].server;F++);F==f.length&&(f[F]={server:y[c].server,page:[]});for(B=0;B<f[F].page.length;B++)if(f[F].page[B].gid.fm==u.frameId&&f[F].page[B].gid.pg==u.pageId&&f[F].page[B].gid.idx==u.index){"undefined"!=typeof NSDK?B++:B;break}if(B==f[F].page.length)f[F].page[B]=
{gid:{fm:u.frameId,pg:u.pageId,idx:u.index}},1==serviceIsIncrement(f[F].server)?y[c].req?f[F].page[B].req=y[c].req:y[c].type&&(f[F].page[B].type=y[c].type):f[F].page[B].sql=y[c].sql;else if(1==serviceIsIncrement(f[F].server))if(z=f[F].page[B].req,D=y[c].req,null==z||null==D)z=f[F].page[B].type,null!=D&&null!=z&&(f[F].page[B].req=D,delete f[F].page[B].type);else for(B=0;B<D.length;B++){var t=!1;for(F=0;F<z.length;F++)if(null!=z[F]&&xIsSame(D[B].gid,z[F].gid)){t=!0;for(var G in D[B])z[F][G]=D[B][G];
break}0==t&&(z[z.length]=D[B])}}}}},a[l])if("type"==m){b=a[l][m];n(b,a[l][b+"s"]);break}if(g&&0<g.length)for(s=0;s<g.length;s++)g[s].sendPushSubscribeRequest(!0);if(0<f.length)for(s=0;s<f.length;s++)m=function(p){for(var q=[],v=0;v<p.page.length;v++){var u={lang:"zh-cn",gid:{fm:""+p.page[v].gid.fm,pg:""+p.page[v].gid.pg,idx:""+p.page[v].gid.idx}};if(p.server&&1==serviceIsIncrement(p.server)){var D=p.page[v].req;if(null==D)if(null!=p.page[v].type)if(u.type=p.page[v].type,D=void 0,0<q.length&&(D=q[q.length-
1]),null==D)D=[],D.push(u.gid.idx),u.gid.idx=D,"Array"==p.page[v].gid.idx.constructor.name&&(u.gid.idx=p.page[v].gid.idx);else if("Array"==D.gid.idx.constructor.name){var F=D.gid.idx[D.gid.idx.length-1];D.gid.fm==u.gid.fm&&D.gid.pg==u.gid.pg&&F!=u.gid.idx&&D.gid.idx.push(u.gid.idx);continue}else D=[],D.push(u.gid.idx),u.gid.idx=D;else console.log("\u9519\u8bef\u7684\u5408\u5e76\u8bf7\u6c42:  ",p.page[v]);else u.req=D}else D=JSON.stringify(p.page[v].sql),u.sql=makeMessageString(D);q.push(u)}return q}(f[s]),
0<m.length&&(1==m.length&&(m=m[m.length-1]),m=JSON.stringify(m),f[s].server&&f[s].server.send&&(f[s].server.send(m),tolsend++));if(0<e.length)for(l=0;l<e.length;l++)e[l].result&&callback_result(e[l],"sql","")}},send_httpQuerys=function(a){if(a)for(var b={},f=0;f<a.length;b={$jscomp$loop$prop$httpRequest$233:b.$jscomp$loop$prop$httpRequest$233},f++)if(1>=a[f].querys.length){var g=a[f].querys[0];"undefined"!=typeof GLink_client?GLink_client.sharedInstance().postHttpMessage("query",g.frameId,g.pageId,
g.index,g.queryInfo,g.queryIndex,g.callback):postHttpMessage("query",g.frameId,g.pageId,g.index,g.queryInfo,g.queryIndex,g.callback)}else{if(null!=xGlobal.HttpNoMerge){var e=!1;for(g=0;g<xGlobal.HttpNoMerge.length;g++)if(a[f].http.toLowerCase()==xGlobal.HttpNoMerge[g].toLowerCase()){for(e=0;e<a[f].querys.length;e++)g=a[f].querys[e],"undefined"!=typeof GLink_client?GLink_client.sharedInstance().postHttpMessage("query",g.frameId,g.pageId,g.index,g.queryInfo,g.queryIndex,g.callback):postHttpMessage("query",
g.frameId,g.pageId,g.index,g.queryInfo,g.queryIndex,g.callback);e=!0;break}if(1==e)continue}e="[";for(var h=0;h<a[f].querys.length;h++){g=a[f].querys[h];var m=makeHttpMessage("query",g.frameId,g.pageId,g.index,g.queryInfo,g.queryIndex,g.callback);m&&m.msg&&(savaCallbackList(xSocket.queryList,g.frameId,g.pageId,g.index,g.queryInfo,g.queryIndex,g.callback),e+=m.msg+",")}if("["!=e){e=e.substr(0,e.length-1)+"]";b.$jscomp$loop$prop$httpRequest$233=new XNetwork;b.$jscomp$loop$prop$httpRequest$233.open("POST",
a[f].http);g=getHttpHeader();for(var l in g)b.$jscomp$loop$prop$httpRequest$233.setRequestHeader(l,g[l]);b.$jscomp$loop$prop$httpRequest$233.index=f;b.$jscomp$loop$prop$httpRequest$233.onreadystatechanges=function(n){return function(p){if(0!=p&&4==n.$jscomp$loop$prop$httpRequest$233.readyNetState&&200==n.$jscomp$loop$prop$httpRequest$233.httpStatus)try{var q=JSON.parse(n.$jscomp$loop$prop$httpRequest$233.responseTexts);null==q.length&&(q=[q]);for(p=0;p<q.length;p++)for(var v=0;v<q[p].result.length;v++){var u=
q[p].result[v].table.gid.id.split(","),D=parseInt(u[1]);onReceiveHttpMessage(q[p].gid,D,q[p])}}catch(F){for(console.log(F),console.log(n.$jscomp$loop$prop$httpRequest$233.responseTexts),q=n.$jscomp$loop$prop$httpRequest$233.index,p=0;p<a[q].querys.length;p++)onReceiveHttpMessage({fm:a[q].querys[p].frameId,gp:a[q].querys[p].pageId,idx:a[q].querys[p].index},a[q].querys[p].queryIndex,null)}}}(b);b.$jscomp$loop$prop$httpRequest$233.send(e)}}};
function makeHttpMessage(a,b,f,g,e,h,m){findQueryPacket(b,f,g,xSocket.queryList);var l={name:"",id:""},n=packHttpMessage(a,b,f,g,e,h,l);if(null==n)e=xDeepCopy(GlobalErrorPack),e.errorCode=ERRORHTTP.NULL_MUST_PARAM,e.queryIndex=h,m(null,null,null,e);else{var p={fm:b,pg:f,idx:g},q;if("query"==a&&xGlobal.xQuerySubmitBus&&(q=xGlobal.xQuerySubmitBus.query(e[h],h,m,p))&&(e[h].cacheBus=q,q.callbackList)){a=findQueryPacket(p.fm,p.pg,p.idx,xSocket.queryList);n=e[h].query.id+","+h;q.result&&q.result.table&&
q.result.table.info&&q.result.table.info.id!=n&&(q.result.table.info.id=n);null==a&&(savaCallbackList(xSocket.queryList,b,f,g,e,h,m),a=findQueryPacket(p.fm,p.pg,p.idx,xSocket.queryList));a.result[h]=q.result;callback_cacheBus(q,p);return}if(null==q&&"query"==a&&0!=e[h].cache){if(q=getTableDataFromCache(e[h].query.condition,e[h].query.limit)){savaCallbackList(xSocket.queryList,b,f,g,e,h,m);(a=findQueryPacket(b,f,g,xSocket.queryList))&&a.callback&&(a.result||(a.result=[]),a.result[h]=xDeepCopy(q),a.result[h].table.info.name=
l.name,a.result[h].table.info.id=l.id,a.result[h].httpId=parseInt(l.id),a.result[h]&&(a.result[h].updateCounter=createUpdateCounter(a.result[h].updateCounter)),callback_result(a));return}if(a=findQueryPacket(b,f,g,xSocket.queryList))for(m=0;m<a.nameList.length;m++)null==e[m]?(a.result[m]=null,a.nameList[m]=null):a.result&&e[m].query&&a.nameList[m]&&null!=a.nameList[m].condition&&(e[m].http!=a.nameList[m].http||e[m].query.condition!=a.nameList[m].condition)&&(a.result[m]={})}return{gid:p,msg:n,queryIndex:h}}}
function onReceiveHttpMessage(a,b,f,g){var e=[],h=findQueryPacket(a.fm,a.pg,a.idx,xSocket.queryList);if(h&&h.callback)if(null==f)m=b,null==h.result&&(h.result=[]),null==h.result[m]&&(h.result[m]={}),h.result[m].updateCounter=createUpdateCounter(h.result[m].updateCounter),f=xDeepCopy(GlobalErrorPack),f.errorCode=ERRORHTTP.SERVER_UNAVAILABLE,f.queryIndex=m,f.errorMsg=g,h.callback(null,null,null,f);else{if(h.result)for(var m=0;m<h.result.length;m++)h.result[m]&&h.result[m].updateCounter&&(e[m]=h.result[m].updateCounter);
h.result=xHttpDecode(h,f);if(h.result){g=null;for(m=0;m<h.result.length;m++)if(h.result[m]&&h.result[m].updateCounter!=e[m])if(null==g&&h.cacheBusList&&null!=h.cacheBusList[m])g=xGlobal.xQuerySubmitBus.onQueryResult(h,m);else if(h.nameList[m]&&h.nameList[m].condition){var l=h.nameList[m].condition;var n=h.nameList[m].limit;0!=h.nameList[m].cache&&setTableDataToCache(h.nameList[m].condition,h.nameList[m].limit,h.result[m])}if(null!=g)for(m=0;m<g.length;m++)g[m]&&!xIsSame(g[m].callbackList.gid,a)&&
callback_cacheBus(g[m],g[m].callbackList.gid);g={};null==g[h.pageId]&&(g[h.pageId]=getPageFromFramePage("",h.pageId),g[h.pageId]&&g[h.pageId].beginQuery("onReceiveMessage"));if(0==refrshCacheTableData(a.fm,a.pg,a.idx,b,l,n)&&h.result){for(m=0;m<h.result.length;m++)h.result[m]&&h.result[m].localCacheReady&&(h.result[m].localCacheReady=!1,h.result[m].updateCounter=createUpdateCounter(h.result[m].updateCounter));"undefined"!=typeof NSDK?(null!=h.result[0]&&null!=h.result[0].table?(m=h.result,null!=f.seqId&&
null!=f.result&&null!=f.result[0]&&null!=f.result[0].table&&null!=f.result[0].table.gid&&null==h.result[0].table.gid&&(m=f.result[0].table.gid,m.id=f.seqId,a=xDeepCopy(h.result),a[0].table.gid=m,delete f.seqId,m=a),f.data={result:m}):f.data={result:f.result},delete f.result,delete f.resultTableGid,h.callback(f,"http")):h.callback(h.result,"http")}for(var p in g)g[p]&&g[p].endQuery("onReceiveMessage")}}}
function postHttpMessage(a,b,f,g,e,h,m){var l=makeHttpMessage(a,b,f,g,e,h,m);if(null!=l){var n=findQueryPacket(b,f,g,xSocket.queryList),p=0;n&&(null==n.serialNumber?(n.serialNumber=[],n.serialNumber[l.queryIndex]=1):null==n.serialNumber[l.queryIndex]?n.serialNumber[l.queryIndex]=1:n.serialNumber[l.queryIndex]++,p=n.serialNumber[l.queryIndex]);var q=new XNetwork;n=e[h].http;if("http"!=n.substr(0,4)||-1!=n.indexOf("{{"))n=e[h].query.server;q.open("POST",n);n=getHttpHeader();for(var v in n)q.setRequestHeader(v,
n[v]);q.gid=l.gid;q.queryIndex=l.queryIndex;q.serialNumber=p;null!=e[h]&&null!=e[h].seqId&&(q.seqId=e[h].seqId);p=!1;if(null!=xGlobal.HttpNoMerge)for(v=0;v<xGlobal.HttpNoMerge.length;v++)if((n=e[h].http)&&n.toLowerCase()==xGlobal.HttpNoMerge[v].toLowerCase()){p=!0;break}q.body=l.msg;if("query"==a)savaCallbackList(xSocket.queryList,b,f,g,e,h,m),q.onreadystatechanges=function(u){if(0!=u){if(4==q.readyNetState&&200==q.httpStatus){var D;try{if((D=JSON.parse(q.responseTexts))&&D.msg&&"999998"==D.code&&
"Invalid access token:"==D.msg.substr(0,21))if("undefined"!=typeof NSDK)1!=D[0].status&&(D=createErrorResult(D,q.body));else{null==httpMessage?httpMessage=new XMessageTip(window,[{title:"\u8bf7\u6c42\u5931\u8d25,\u6b64\u7528\u6237\u540d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff01",textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:12,marginTop:5}],"\u26a0\ufe0f",function(){httpMessage=null}):httpMessage.setMessage([{title:"\u8bf7\u6c42\u5931\u8d25,\u6b64\u7528\u6237\u540d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff01",
textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:12,marginTop:5}],"\u26a0\ufe0f");return}if(D&&D.msg&&"999999"==D.code)if("undefined"!=typeof NSDK)1!=D.status&&(D=createErrorResult(D,q.body));else{onReceiveHttpMessage(q.gid,q.queryIndex,null,q.responseTexts);return}if("undefined"==typeof D.length||null==D.length)D=[D];for(u=0;u<D.length;u++)if(D[u]&&D[u].result){for(var F=0;F<D[u].result.length;F++){var z=D[u].result[F].table.gid.id.split(","),y=parseInt(z[1]);D[u].result[F].table&&
D[u].result[F].table.gid.key&&D[u].result[F].table.key&&(D[u].result[F].table.info.key=D[u].result[F].table.gid.key)}var B=findQueryPacket(q.gid.fm,q.gid.pg,q.gid.idx,xSocket.queryList);B&&B.serialNumber&&B.serialNumber[y]&&q.serialNumber<B.serialNumber[y]||("undefined"!=typeof NSDK&&null!=q.seqId&&(D[u].seqId=q.seqId),onReceiveHttpMessage(D[u].gid,y,D[u]))}}catch(t){console.log(t),console.log(q.responseTexts),onReceiveHttpMessage(q.gid,q.queryIndex,null,q.responseTexts)}}if("undefined"!=typeof NSDK){if(4==
q.readyNetState&&200!=q.httpStatus)for(D=createErrorResult([{code:q.httpStatus+"",msg:"",status:!1,result:null}],q.body),u=0;u<D.length;u++)if(D[u]&&D[u].result){for(F=0;F<D[u].result.length;F++)z=D[u].result[F].table.gid.id.split(","),y=parseInt(z[1]),D[u].result[F].table&&D[u].result[F].table.gid.key&&D[u].result[F].table.key&&(D[u].result[F].table.info.key=D[u].result[F].table.gid.key);onReceiveHttpMessage(D[u].gid,y,D[u])}}else 401==q.httpStatus&&"Unauthorized"==q.XMLHttpRequest.statusText&&(null==
httpMessage?httpMessage=new XMessageTip(window,[{title:"\u8bf7\u6c42\u5931\u8d25,\u6b64\u7528\u6237\u540d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff01",textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:12,marginTop:5}],"\u26a0\ufe0f",function(){httpMessage=null}):httpMessage.setMessage([{title:"\u8bf7\u6c42\u5931\u8d25,\u6b64\u7528\u6237\u540d\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55\uff01",textBaseLine:"top",lineHeight:20,height:20,layerType:"normal",fontSize:12,
marginTop:5}],"\u26a0\ufe0f"))}};else if("submit"==a){savaCallbackList(xSocket.submitList,b,f,g,e,h,m);if(xGlobal.xQuerySubmitBus&&(a=xGlobal.xQuerySubmitBus.onSubmit(e,h)))for(b=0;b<a.length;b++)callback_cacheBus(a[b],a[b].callbackList.gid);q.onreadystatechanges=function(u){if(0!=u&&4==q.readyNetState&&200==q.httpStatus)try{var D=JSON.parse(q.responseTexts);if(D)for(null==D.length&&(D=[D]),u=0;u<D.length;u++){var F=D[u].gid,z=findQueryPacket(F.fm,F.pg,F.idx,xSocket.submitList);if(z&&z.callback)if("undefined"!=
typeof D[u].result&&"undefined"!=D[u].result[0]&&"undefined"!=D[u].result[0].table&&"undefined"!=D[u].result[0].table.gid&&"undefined"!=D[u].result[0].table.gid.id){var y=D[u].result[0].table.gid.id;(0,z.requestInfo[y])(D[u],"http");deleteQueryPacket(D[u],xSocket.submitList,y)}else z.callback(D[u],"http"),deleteQueryPacket(D[u],xSocket.submitList)}}catch(B){console.log(B)}}}try{0==p?q.send("["+l.msg+"]"):q.send(l.msg)}catch(u){console.log(u+"\n"+l.msg)}}}
function createErrorResult(a,b){bodyObj=JSON.parse(b);b=bodyObj.gid;var f=[],g={table:{gid:bodyObj.http[0].gid}};f.push(g);if(null==a[0]){var e=[];e[0]=a;a=e}a[0].result=f;a[0].gid=b;a[0].resultTableGid=g;return a}
function postHttpImges(a,b,f){if(10<b.size/1048576)xGlobal.isMobile?pkMobileLogin.dialog("photo's size is too big"):showWarningTip("photo's size is too big");else if(100<b.size/1024){var g=new FileReader;g.readAsDataURL(b);g.onload=function(e){e=e.target.result;var h=new Image;h.src=e;h.onload=function(){var m=h.height/h.width*200,l=document.createElement("canvas"),n=l.getContext("2d");l.width=200;l.height=m;n.drawImage(h,0,0,200,m);m=l.toDataURL("image/jpeg",1);m=getBlobByBase64(m);toPostImage(a,
m,f)}}}else toPostImage(a,b,f)}function getBlobByBase64(a){var b=a.split(",");a=b[0].match(/:(.*?);/)[1];b=atob(b[1]);for(var f=b.length,g=new Uint8Array(f);f--;)g[f]=b.charCodeAt(f);return new Blob([g],{type:a})}
function toPostImage(a,b,f){var g=new FormData;g.append("file",b,"avatar.jpg");var e=new XMLHttpRequest;e.open("POST",a,!0);e.setRequestHeader("Authorization","Bearer "+getCookie("access_token"));e.send(g);e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var h;try{(h=JSON.parse(e.responseText))&&h.status?f&&f(h):xGlobal.isMobile?pkMobileLogin.dialog(h.msg):showWarningTip(h.msg)}catch(m){console.log(m)}}}}
function makeMessageString(a){a=a.replace(/"/g,"__2__");a=a.replace(/\n/g,"\\n");a=a.replace(/\t/g,"\\t");return a=a.replace(/\\/g,"\\\\")}
var resendMessage=function(a,b,f,g){if(null!=a.lastServer){if(1==serviceIsIncrement(a.lastServer[0])){var e={lang:"zh-cn",gid:{fm:b,pg:f,idx:g},resend:1,req:[]};for(h in a.lastMessage)a.lastMessage[h].buffer&&delete a.lastMessage[h].buffer,e.req.push(a.lastMessage[h]);e=JSON.stringify(e);null!=a.lastServer[0].send&&a.lastServer[0].send(e)}else{var h=[];for(var m=0;m<a.lastServer.length;m++){for(j=0;j<h.length&&a.lastServer[m]!=h[j];j++);if(j==h.length&&a.lastServer[m]&&a.lastServer[m].send&&a.lastMessage[m]){e=
{lang:"zh-cn",gid:{fm:b,pg:f,idx:g}};a.lastMessage[m].buffer&&delete a.lastMessage[m].buffer;if(1==serviceIsIncrement(a.lastServer[m]))e.req=[a.lastMessage[m]];else{var l=JSON.stringify([a.lastMessage[m]]);e.sql=makeMessageString(l)}e=JSON.stringify(e);a.lastServer[m].send&&a.lastServer[m].send(e);h[h.length]=a.lastServer[m]}}}a.needResendMessage=!1}};
function makeStopMessage(a,b,f,g){b=""+b;var e=""+f;if(xSocket.queryList[b]&&xSocket.queryList[b][e]){f=[];if(null!=g){var h=xSocket.queryList[b][e][""+g];if(h&&(h.lastMessage&&delete h.lastMessage,h.status=a,h.lastServer))for(g=0;g<h.lastServer.length;g++){b=!0;for(e=0;e<f.length;e++)if(f[e]==h.lastServer[g]){b=!1;break}1==b&&h.lastServer[g]&&f.push({server:h.lastServer[g],type:"pause"==a?"cancel":a})}}return{server:f,pushServer:[],queryPacket:h}}}
function makeWsMessage(a,b,f,g,e,h){a={gid:{name:"",id:""},type:null==a?"query":a};var m=""+b,l=""+f,n=""+g;null==xSocket.queryList[m]&&(xSocket.queryList[m]={});null==xSocket.queryList[m][l]&&(xSocket.queryList[m][l]={});null==xSocket.queryList[m][l][n]&&(xSocket.queryList[m][l][n]={frameId:m,pageId:l,index:n,result:[]});m=xSocket.queryList[m][l][n];"pause"==m.status&&(m.status="active",m.lastMessage&&delete m.lastMessage);l=m.nameList?m.nameList:[];n=m.id?m.id:[];var p=m.cacheBusList?m.cacheBusList:
[],q=m.cacheWindow?m.cacheWindow:[],v=m.alias?m.alias:[],u=m.rotate?m.rotate:[],D=m.result,F=m.globalSub?m.globalSub:null,z=[],y,B;m.hasPushScribeServer=!1;m.queryInfo=e;for(y=0;y<e.length;y++)if(null!=e[y].sql&&null!=e[y].query&&null!=e[y].queryStatus){if(1==e[y].queryStatus||2==e[y].queryStatus)if(theServer=e[y].server?e[y].query.server:mainWebServer,m.result&&m.result[y]&&(m.result[y].queryStatus=e[y].queryStatus),theServer&&theServer.checkPushSubscribe&&1==theServer.checkPushSubscribe(m,y,e[y])){null==
B&&(B=[]);var t;for(t=0;t<B.length&&B[t]!=theServer;t++);t==B.length&&B.push(theServer);continue}var G=null,x=xDeepCopy(a);null==l[y]&&(l[y]={});if(e[y]&&(1==e[y].queryStatus||2==e[y].queryStatus)&&e[y].sql&&e[y].query&&e[y].query.script){q[y]=e[y].query.cacheWindow;t=0;1==e[y].query.globalSub&&(F=!0);null==l[y].query||l[y].query.script!=e[y].query.script?null==l[y].query||null==l[y].query.scriptId?G=0:(t=l[y].query.scriptId,G=l[y].query.scriptId+1):t=G=l[y].query.scriptId;l[y]={};l[y].query=xDeepCopy(e[y].query);
l[y].query.scriptId=G;l[y].queryStatus=e[y].queryStatus;x.gid.name=e[y].name;x.gid.id=G;x.gid.idx=y;x.sql=e[y].query.script;var J=checkAsKeyWord(e[y].query.script);null!=J.alias&&(e[y].alias=J.alias);x.sql=J.sql;null!=e[y].type&&(x.type=e[y].type);e[y].query.limit&&(x.limit=e[y].query.limit[0]+","+e[y].query.limit[1]);e[y].alias&&(v[y]=e[y].alias);e[y].rotate&&(u[y]=e[y].rotate);m.cacheBusList&&(p[y]=m.cacheBusList[y]);theServer=e[y].server?e[y].query.server:mainWebServer;null==m.lastMessage&&(m.lastMessage=
[]);m.callback=h;theServer.readCache(m,e,y)?(m.result[y].gid=x.gid,e[y].query.buffer&&(x.buffer=[e[y].query.buffer.data.begin,e[y].query.buffer.data.rows,e[y].query.buffer.data.totalRows,e[y].query.buffer.data.diskRows,e[y].query.buffer.data.diskLastTime],e[y].query.buffer.relation&&x.buffer.push(e[y].query.buffer.relation))):e[y].query.buffer&&delete e[y].query.buffer;1==serviceIsIncrement(theServer)&&(delete x.sql,delete x.type,J=scriptAst.autoGenerate(J.sql),e[y].query.limit&&(J.limit=e[y].query.limit),
x=Object.assign({},x,J));if(1==serviceIsIncrement(theServer)&&null!=m.lastMessage[y]){var A=m.lastMessage[y];J={};J.gid=x.gid;var H=Object.assign({},x,A),I=[],N;for(N in H)I.push(N);for(H=0;H<I.length;H++){var M=I[H];null!=x[M]&&null==A[M]?J[M]=x[M]:null==x[M]&&null!=A[M]?J[M]="delete":null==x[M]||null==A[M]||"buffer"!=M&&0!=xIsSame(x[M],A[M])||(J[M]=x[M])}A=!0;for(var C in J)if("gid"!=C&&"subscribe"!=C){A=!1;break}A&&(J.gid.id=t);m.lastMessage[y]=xDeepCopy(x);if(1==objLength(J)&&null!=J.gid)continue;
x=J}else m.lastMessage[y]=xDeepCopy(x);null==m.lastServer&&(m.lastServer=[]);m.lastServer[y]=theServer;for(t=0;t<z.length&&z[t].server!=theServer;t++);m.server&&m.server[y]&&m.server[y].server!=theServer&&(x.requery=1);t==z.length&&(z[t]={server:theServer},1==serviceIsIncrement(theServer)?z[t].req=[]:z[t].sql=[]);1==serviceIsIncrement(theServer)?z[t].req.push(x):z[t].sql.push(x)}else l[y].query&&(G=l[y].query.scriptId);e&&e[y]&&e[y].query&&(l[y].name=e[y].name,l[y].id=G,l[y].noChartData=e[y].noChartData,
l[y].synchField=e[y].synchField)}m.status="active";m.id=n;m.frameId=b;m.pageId=f;m.index=g;m.server=z;m.result=D;m.nameList=l;m.alias=v;m.rotate=u;m.cacheBusList=p;m.cacheWindow=q;m.callback=h;m.globalSub=F;return{server:z,pushServer:B,queryPacket:m}}
function sendMessage(a,b,f,g,e,h){b=""+b;f=""+f;var m=""+g;if("pause"==a||"cancel"==a){if(xSocket.queryList[b]&&xSocket.queryList[b][f]){h=[];if(null!=g){var l=xSocket.queryList[b][f][m];if(l){l.lastMessage&&delete l.lastMessage;if(l.lastServer){l.status=a;for(var n=0;n<l.lastServer.length;n++){for(var p=!0,q=0;q<h.length;q++)if(h[q]==l.lastServer[n]){p=!1;break}1==p&&l.lastServer[n]&&h.push(l.lastServer[n])}}if("cancel"==a)if(null!=e)for(n=0;n<e.length;n++){var v=e[n];l.result[v]&&(l.result[v]=null);
l.lastMessage&&l.lastMessage[v]&&(l.lastMessage=null)}else l.result=null,delete xSocket.queryList[b][f][m];else l.result&&l.result[g]&&(l.result[g].subscribe=!1)}}else{var u=xSocket.queryList[b][f];for(v in u)if(l=u[v]){l.lastMessage&&delete l.lastMessage;if(l.lastServer)for(n=0;n<l.lastServer.length;n++){if(l.status!=a){l.status=a;p=!0;for(q=0;q<h.length;q++)if(h[q]==l.lastServer[n]){p=!1;break}1==p&&l.lastServer[n]&&h.push(l.lastServer[n])}}else"active"==l.status&&(l.status=a);if("cancel"==a&&l)l.result=
null;else if(l.result)for(n=0;n<l.result.length;n++)l.result[n]&&(l.result[n].subscribe=!1)}}for(n=0;n<h.length;n++){v={lang:"zh-cn",gid:{fm:b,pg:f,idx:null==g?"":m},type:"pause"==a?"cancel":a};if(e)if(1==serviceIsIncrement(h[n]))v.idx=e;else{delete v.type;v.sql=[];p=void 0;for(q=0;q<e.length;q++)if(u=e[q],l.nameList&&null!=l.nameList[u])v.sql.push({gid:{name:l.nameList[u].name,id:l.nameList[u].id,idx:u},type:"cancel"});else{p=!0;break}if(1==p)break}p=JSON.stringify(v);h[n].send&&h[n].send(p)}}}else{if("restart"==
a)if(xSocket.queryList[b]&&xSocket.queryList[b][f]){l=xSocket.queryList[b][f][m];if(null==l)return;l.lastMessage&&delete l.lastMessage;l.status="active";e=l.queryInfo}else return;a=makeWsMessage(a,b,f,m,e,h);h=a.server;if(a.pushServer&&0<a.pushServer.length)for(s=0;s<a.pushServer.length;s++)a.pushServer[s].sendPushSubscribeRequest();for(n=0;n<h.length;n++)v={lang:"zh-cn",gid:{fm:b,pg:f,idx:m}},h[n].server&&1==serviceIsIncrement(h[n].server)?v.req=h[n].req:(g=JSON.stringify(h[n].sql),v.sql=makeMessageString(g)),
p=JSON.stringify(v),h[n].server&&h[n].server.send&&(h[n].server.send(p),h[n].message=p,debugWebSocket&&v.gid.fm==debugWebSocket.gid.fm&&v.gid.pg==debugWebSocket.gid.pg&&v.gid.idx==debugWebSocket.gid.idx&&(p=p.replace(/__2__/g,'"'),console.log("send : "+debugWebSocket.sendCounter++),console.log(p)));tolsend++;0==h.length&&a.pushServer&&0<a.pushServer.length&&callback_result(a.queryPacket,"sql")}}var mainWebServer=null;
function mainDbServerStart(){if(null==mainWebServer)if("undefined"!=typeof wsUrl&&wsUrl&&""!=wsUrl)mainWebServer=new WebsocketServer(wsUrl),mainWebServer.connect();else return;mainWebServer.dbserverLogin=function(){var a={type:"login",gid:{pg:"1",idx:"-1"},account:"",userid:"",token:"",protocol:1,sdk:1,subscribe:["quote"]},b=getCookie("user"),f=getCookie("userId"),g=getCookie("access_token");a.account=b;a.userid=f;a.token=g;a=JSON.stringify(a);(new XGtsJason(null)).compress_json(a);mainWebServer.send(a)};
mainWebServer.setToken=function(a){var b,f,g;1===(null==(b=mainWebServer)?void 0:null==(f=b.socket)?void 0:null==(g=f.webSocket)?void 0:g.readyState)&&(b={type:"setToken",gid:{pg:"1",idx:"-1"},account:"",userid:"",token:""},f=getCookie("user"),g=getCookie("userId"),b.account=f,b.userid=g,b.token=a,a=JSON.stringify(b),mainWebServer.send(a))};xGlobal.callback_login=null!=mainWebServer.dbserverLogin?mainWebServer.dbserverLogin:function(){}}
function checkAsKeyWord(a){if(null!=a){if(null!=a.match(/selectTree/i))var b=a.match(/selectTree/i).index;else null!=a.match(/select/i)&&(b=a.match(/select/i).index);if(null!=a.match(/from/i))var f=a.match(/from/i).index;if(null!=b&&null!=f){b=a.substring(b,f);if(1<b.split(" as ").length){var g=scriptAst.autoGenerate(b);b=g.field;g=g.type;a=a.substring(f,a.length);f=[];for(var e=[],h=0;h<b.length;h++){var m=b[h];"as"==m?(e.splice(e.length-1,1),h++,e.push(b[h])):(g=0==h?g+(" "+m):g+(","+m),f.push(m),
e.push(m))}return{sql:g+" "+a,alias:e.join(",")}}return{sql:a,alias:null}}}}function serviceIsIncrement(a){return a&&a.requestMode&&"increment"==a.requestMode?!0:!1}function create_NSDK_pack(a,b,f,g,e){return{gid:{fm:a,pg:b,idx:f},data:{result:g},type:e}}
function xIsSame0(a,b){if(null==a&&null==b)return!0;if(null!=a&&null==b||null==a&&null!=b||a.constructor.name!=b.constructor.name)return!1;if("Array"==a.constructor.name){if(a.length!=b.length)return!1;for(var f=0;f<a.length;f++)if(0==xIsSame0(a[f],b[f]))return!1}else if("Object"==a.constructor.name)for(f in a){if(null==b[f]&&a[f]!=b[f]||0==xIsSame0(a[f],b[f]))return!1}else if(a!=b)return!1;return!0}
function xIsSame(a,b){if(null==a&&null==b)return!0;if(null!=a&&null==b||null==a&&null!=b||a.constructor.name!=b.constructor.name)return!1;if("Array"==a.constructor.name){if(a.length!=b.length)return!1;for(var f=0;f<a.length;f++)if(0==xIsSame(a[f],b[f]))return!1}else if("Object"==a.constructor.name)for(f in a){if(null==b[f]&&a[f]!=b[f]||0==xIsSame(a[f],b[f]))return!1}else if(a!=b)return!1;return xIsSame0(b,a)}
function clearLastmsgForId(a,b,f){a=""+a;b=""+b;f=""+f;mainWebServer.removePushSubscribe(a,b,f);sendMessage("cancel",a,b,f);xSocket.queryList[a]&&xSocket.queryList[a][b]&&xSocket.queryList[a][b][f]&&delete xSocket.queryList[a][b][f]};function GAnalysisES(a,b){if(null==a||""==a)return{};var f={seq:"(=)",eq:"=",gte:">=",lte:"<=",mustNot:"!=",gt:">",lt:"<",in:" in ",order:"order"},g={must:[]},e=!0;a=a.split(" and ");for(var h=0;h<a.length;h++){var m=a[h],l;for(l in f){var n=m.indexOf(f[l]);if("eq"==l&&-1!=n){var p=m[n-1];if(">"==p||"<"==p||"!"==p||"("==p)continue}if(-1!=n){var q=m.split(f[l]);p=trim(q[0]);p=p.replace(/_A_N_D_/g,"and");p=p.toLowerCase();var v=trim(q[1]);if(b)for(n=0;n<b.length;n++)p==b[n].toLowerCase()&&(""!=v&&v&&
"''"!=v&&'""'!=v||(e=!1));if(""==v||!v||"''"==v||'""'==v)break;else if("' '"==v||'" "'==v)v="",q[1]="''";if("break"==p)break;var u=void 0;n=!0;switch(f[l]){case ">=":case "<=":case ">":case "<":u={range:{}};u.range[p]={};for(var D in g)for(var F=g[D],z=0;z<F.length;z++){var y=F[z],B;for(B in y)null!=y[B][p]&&(u.range[p]=y[B][p],n=!1)}F=!0;if(0==trim(v).indexOf('"')||0==trim(v).indexOf("'"))F=!1;F?v=parseInt(trim(q[1])):(v=trimSingle(trim(q[1])),v=trimDbSingle(v),v=v.replace(/_A_N_D_/g,"and"));u.range[p][l]=
v;break;case "=":case "(=)":n=!0;v=[];if("(=)"==f[l]){v=trimSingle(trim(q[1]));v=trimDbSingle(v);v=JSON.parse(v);q={term:{}};q.term[p]=v;u=q;break}F=!1;if("string"==typeof q[1]&&0==trim(q[1]).indexOf("[")){if("[]"==q[1]){n=!1;break}F=!0;z=trim(q[1]).slice(1,-1);z=z.split(",");for(y=0;y<z.length;y++)if('""'!=trim(z[y])&&"''"!=trim(z[y])&&""!=trim(z[y])){if(0==z[y].indexOf("D'")){if("D''"==z[y]||'D""'==z[y])continue;var t=z[y].slice(2,-1);if(8==t.length){var G=t.slice(0,4);G+="-"+t.slice(4,6);G+="-"+
t.slice(6,8);z[y]="'"+G+"'"}}t=!0;if(0==trim(z[y]).indexOf('"')||0==trim(z[y]).indexOf("'"))t=!1;t?t=parseInt(trim(z[y])):(t=trimSingle(trim(z[y])),t=trimDbSingle(t),t=t.replace(/_A_N_D_/g,"and"));v.push(t)}}if(F){if(q=[],!(0>=v.length)){for(u=0;u<v.length;u++)q.push(v[u]);u={terms:{}};u.terms[p]=q}}else{if(0==q[1].indexOf("D'")){if("D''"==q[1]||'D""'==q[1])continue;u=q[1].slice(2,-1);8==u.length&&(v=u.slice(0,4),v+="-"+u.slice(4,6),v+="-"+u.slice(6,8),q[1]="'"+v+"'")}u=!0;if(0==trim(q[1]).indexOf('"')||
0==trim(q[1]).indexOf("'"))u=!1;if(u)v=parseInt(trim(q[1]));else{v=trimSingle(trim(q[1]));v=trimDbSingle(v);if(2<q.length)for(u=2;u<q.length;u++)F=trimSingle(trim(q[u])),F=trimDbSingle(F),v+="="+F;v=v.replace(/_A_N_D_/g,"and")}q={term:{}};q.term[p]=v;u=q}break;case " in ":n=!0;v.startsWith("(")&&v.endsWith(")")&&(v=v.slice(1,-1));u=v.split(",");q=[];for(v=0;v<u.length;v++)u[v]=u[v].replace(/'/g,""),q.push(u[v]);u={terms:{}};u.terms[p]=q;break;case "order":g.sort||(g.sort={});g.sort[p]={order:v};break;
case "!=":for(n=!1,g.must_not||(g.must_not=[]),p=analysisES(""==v?p+"=' '":p+"="+v).esCondition,q=0;q<p.must.length;q++)g.must_not[q]=p.must[q]}if(null!=u&&1==n){g.must.push(u);break}else if(0==n)break}}}return{esCondition:g,mustCheckStatu:e}};(function(a,b){"object"===typeof exports?module.exports=exports=b():"function"===typeof define&&define.amd?define([],b):a.GCryptoJS=b()})(this,function(){var a=a||function(b,f){if("undefined"!==typeof window&&window.crypto)var g=window.crypto;!g&&"undefined"!==typeof window&&window.msCrypto&&(g=window.msCrypto);!g&&"undefined"!==typeof global&&global.crypto&&(g=global.crypto);if(!g&&"function"===typeof require)try{g=require("crypto")}catch(z){}var e=Object.create||function(){function z(){}return function(y){z.prototype=
y;y=new z;z.prototype=null;return y}}(),h={},m=h.lib={},l=m.Base=function(){return{extend:function(z){var y=e(this);z&&y.mixIn(z);y.hasOwnProperty("init")&&this.init!==y.init||(y.init=function(){y.$super.init.apply(this,arguments)});y.init.prototype=y;y.$super=this;return y},create:function(){var z=this.extend();z.init.apply(z,arguments);return z},init:function(){},mixIn:function(z){for(var y in z)z.hasOwnProperty(y)&&(this[y]=z[y]);z.hasOwnProperty("toString")&&(this.toString=z.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),
n=m.WordArray=l.extend({init:function(z,y){z=this.words=z||[];this.sigBytes=y!=f?y:4*z.length},toString:function(z){return(z||q).stringify(this)},concat:function(z){var y=this.words,B=z.words,t=this.sigBytes;z=z.sigBytes;this.clamp();if(t%4)for(var G=0;G<z;G++)y[t+G>>>2]|=(B[G>>>2]>>>24-G%4*8&255)<<24-(t+G)%4*8;else for(G=0;G<z;G+=4)y[t+G>>>2]=B[G>>>2];this.sigBytes+=z;return this},clamp:function(){var z=this.words,y=this.sigBytes;z[y>>>2]&=4294967295<<32-y%4*8;z.length=b.ceil(y/4)},clone:function(){var z=
l.clone.call(this);z.words=this.words.slice(0);return z},random:function(z){for(var y=[],B=0;B<z;B+=4){var t=y,G=t.push;a:{if(g){if("function"===typeof g.getRandomValues)try{var x=g.getRandomValues(new Uint32Array(1))[0];break a}catch(J){}if("function"===typeof g.randomBytes)try{x=g.randomBytes(4).readInt32LE();break a}catch(J){}}throw Error("Native crypto module could not be used to get secure random number.");}G.call(t,x)}return new n.init(y,z)}}),p=h.enc={},q=p.Hex={stringify:function(z){var y=
z.words;z=z.sigBytes;for(var B=[],t=0;t<z;t++){var G=y[t>>>2]>>>24-t%4*8&255;B.push((G>>>4).toString(16));B.push((G&15).toString(16))}return B.join("")},parse:function(z){for(var y=z.length,B=[],t=0;t<y;t+=2)B[t>>>3]|=parseInt(z.substr(t,2),16)<<24-t%8*4;return new n.init(B,y/2)}},v=p.Latin1={stringify:function(z){var y=z.words;z=z.sigBytes;for(var B=[],t=0;t<z;t++)B.push(String.fromCharCode(y[t>>>2]>>>24-t%4*8&255));return B.join("")},parse:function(z){for(var y=z.length,B=[],t=0;t<y;t++)B[t>>>2]|=
(z.charCodeAt(t)&255)<<24-t%4*8;return new n.init(B,y)}},u=p.Utf8={stringify:function(z){try{return decodeURIComponent(escape(v.stringify(z)))}catch(y){throw Error("Malformed UTF-8 data");}},parse:function(z){return v.parse(unescape(encodeURIComponent(z)))}},D=m.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new n.init;this._nDataBytes=0},_append:function(z){"string"==typeof z&&(z=u.parse(z));this._data.concat(z);this._nDataBytes+=z.sigBytes},_process:function(z){var y,B=this._data,
t=B.words,G=B.sigBytes,x=this.blockSize,J=G/(4*x);J=z?b.ceil(J):b.max((J|0)-this._minBufferSize,0);z=J*x;G=b.min(4*z,G);if(z){for(y=0;y<z;y+=x)this._doProcessBlock(t,y);y=t.splice(0,z);B.sigBytes-=G}return new n.init(y,G)},clone:function(){var z=l.clone.call(this);z._data=this._data.clone();return z},_minBufferSize:0});m.Hasher=D.extend({cfg:l.extend(),init:function(z){this.cfg=this.cfg.extend(z);this.reset()},reset:function(){D.reset.call(this);this._doReset()},update:function(z){this._append(z);
this._process();return this},finalize:function(z){z&&this._append(z);return this._doFinalize()},blockSize:16,_createHelper:function(z){return function(y,B){return(new z.init(B)).finalize(y)}},_createHmacHelper:function(z){return function(y,B){return(new F.HMAC.init(z,B)).finalize(y)}}});var F=h.algo={};return h}(Math);return a});
(function(a,b){"object"===typeof exports?module.exports=exports=b(require("./core")):"function"===typeof define&&define.amd?define(["./core"],b):b(a.GCryptoJS)})(this,function(a){(function(){var b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(f,g){f=this._hasher=new f.init;"string"==typeof g&&(g=b.parse(g));var e=f.blockSize,h=4*e;g.sigBytes>h&&(g=f.finalize(g));g.clamp();f=this._oKey=g.clone();g=this._iKey=g.clone();for(var m=f.words,l=g.words,n=0;n<e;n++)m[n]^=1549556828,l[n]^=909522486;
f.sigBytes=g.sigBytes=h;this.reset()},reset:function(){var f=this._hasher;f.reset();f.update(this._iKey)},update:function(f){this._hasher.update(f);return this},finalize:function(f){var g=this._hasher;f=g.finalize(f);g.reset();return g.finalize(this._oKey.clone().concat(f))}})})()});
(function(a,b){"object"===typeof exports?module.exports=exports=b(require("./core")):"function"===typeof define&&define.amd?define(["./core"],b):b(a.GCryptoJS)})(this,function(a){(function(b){var f=a.lib,g=f.WordArray,e=f.Hasher;f=a.algo;var h=[],m=[];(function(){function n(u){for(var D=b.sqrt(u),F=2;F<=D;F++)if(!(u%F))return!1;return!0}function p(u){return 4294967296*(u-(u|0))|0}for(var q=2,v=0;64>v;)n(q)&&(8>v&&(h[v]=p(b.pow(q,.5))),m[v]=p(b.pow(q,1/3)),v++),q++})();var l=[];f=f.SHA256=e.extend({_doReset:function(){this._hash=
new g.init(h.slice(0))},_doProcessBlock:function(n,p){for(var q=this._hash.words,v=q[0],u=q[1],D=q[2],F=q[3],z=q[4],y=q[5],B=q[6],t=q[7],G=0;64>G;G++){if(16>G)l[G]=n[p+G]|0;else{var x=l[G-15],J=l[G-2];l[G]=((x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3)+l[G-7]+((J<<15|J>>>17)^(J<<13|J>>>19)^J>>>10)+l[G-16]}x=t+((z<<26|z>>>6)^(z<<21|z>>>11)^(z<<7|z>>>25))+(z&y^~z&B)+m[G]+l[G];J=((v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22))+(v&u^v&D^u&D);t=B;B=y;y=z;z=F+x|0;F=D;D=u;u=v;v=x+J|0}q[0]=q[0]+v|0;q[1]=q[1]+u|0;q[2]=
q[2]+D|0;q[3]=q[3]+F|0;q[4]=q[4]+z|0;q[5]=q[5]+y|0;q[6]=q[6]+B|0;q[7]=q[7]+t|0},_doFinalize:function(){var n=this._data,p=n.words,q=8*this._nDataBytes,v=8*n.sigBytes;p[v>>>5]|=128<<24-v%32;p[(v+64>>>9<<4)+14]=b.floor(q/4294967296);p[(v+64>>>9<<4)+15]=q;n.sigBytes=4*p.length;this._process();return this._hash},clone:function(){var n=e.clone.call(this);n._hash=this._hash.clone();return n}});a.SHA256=e._createHelper(f);a.HmacSHA256=e._createHmacHelper(f)})(Math);return a.SHA256});
(function(a,b,f){"object"===typeof exports?module.exports=exports=b(require("./core"),require("./sha256"),require("./hmac")):"function"===typeof define&&define.amd?define(["./core","./sha256","./hmac"],b):b(a.GCryptoJS)})(this,function(a){return a.HmacSHA256});
(function(a,b){"object"===typeof exports?module.exports=exports=b(require("./core")):"function"===typeof define&&define.amd?define(["./core"],b):b(a.GCryptoJS)})(this,function(a){(function(){var b=a.lib.WordArray;a.enc.Base64={stringify:function(f){var g=f.words,e=f.sigBytes,h=this._map;f.clamp();f=[];for(var m=0;m<e;m+=3)for(var l=(g[m>>>2]>>>24-m%4*8&255)<<16|(g[m+1>>>2]>>>24-(m+1)%4*8&255)<<8|g[m+2>>>2]>>>24-(m+2)%4*8&255,n=0;4>n&&m+.75*n<e;n++)f.push(h.charAt(l>>>6*(3-n)&63));if(g=h.charAt(64))for(;f.length%
4;)f.push(g);return f.join("")},parse:function(f){var g=f.length,e=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var m=0;m<e.length;m++)h[e.charCodeAt(m)]=m}if(e=e.charAt(64))e=f.indexOf(e),-1!==e&&(g=e);e=[];for(var l=m=0;l<g;l++)if(l%4){var n=h[f.charCodeAt(l-1)]<<l%4*2,p=h[f.charCodeAt(l)]>>>6-l%4*2;e[m>>>2]|=(n|p)<<24-m%4*8;m++}return b.create(e,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();return a.enc.Base64});
var GSignModel=function(){this.signature=this.nonce=this.timestamp=this.app_key=null},GCrypto=function(){};GCrypto.sign=function(a,b,f,g){var e={app_key:a,timestamp:b,nonce:f},h="",m=Object.keys(e).sort(),l;for(l in m)h+=m[l]+"="+e[m[l]]+"&";h=h.slice(0,-1);g=GCryptoJS.HmacSHA256(h,g);g=GCryptoJS.enc.Base64.stringify(g);e=new GSignModel;e.app_key=a;e.timestamp=b;e.nonce=f;e.signature=g;return e};
GCrypto.paramSign=function(a,b,f){var g=Date.now();a=Object.assign(a,{app_key:b,timestamp:g,nonce:3E4*Math.random()});b="";g=Object.keys(a).sort();for(var e in g)b+=g[e]+"="+a[g[e]]+"&";b=b.slice(0,-1);f=GCryptoJS.HmacSHA256(b,f);f=GCryptoJS.enc.Base64.stringify(f);return Object.assign(a,{signature:f})};!function(a,b,f){"undefined"!=typeof window&&(b.Fingerprint2=f())}(0,this,function(){var a=function(A,H){A=[A[0]>>>16,65535&A[0],A[1]>>>16,65535&A[1]];H=[H[0]>>>16,65535&H[0],H[1]>>>16,65535&H[1]];var I=[0,0,0,0];return I[3]+=A[3]+H[3],I[2]+=I[3]>>>16,I[3]&=65535,I[2]+=A[2]+H[2],I[1]+=I[2]>>>16,I[2]&=65535,I[1]+=A[1]+H[1],I[0]+=I[1]>>>16,I[1]&=65535,I[0]+=A[0]+H[0],I[0]&=65535,[I[0]<<16|I[1],I[2]<<16|I[3]]},b=function(A,H){A=[A[0]>>>16,65535&A[0],A[1]>>>16,65535&A[1]];H=[H[0]>>>16,65535&H[0],H[1]>>>
16,65535&H[1]];var I=[0,0,0,0];return I[3]+=A[3]*H[3],I[2]+=I[3]>>>16,I[3]&=65535,I[2]+=A[2]*H[3],I[1]+=I[2]>>>16,I[2]&=65535,I[2]+=A[3]*H[2],I[1]+=I[2]>>>16,I[2]&=65535,I[1]+=A[1]*H[3],I[0]+=I[1]>>>16,I[1]&=65535,I[1]+=A[2]*H[2],I[0]+=I[1]>>>16,I[1]&=65535,I[1]+=A[3]*H[1],I[0]+=I[1]>>>16,I[1]&=65535,I[0]+=A[0]*H[3]+A[1]*H[2]+A[2]*H[1]+A[3]*H[0],I[0]&=65535,[I[0]<<16|I[1],I[2]<<16|I[3]]},f=function(A,H){return 32===(H%=64)?[A[1],A[0]]:32>H?[A[0]<<H|A[1]>>>32-H,A[1]<<H|A[0]>>>32-H]:(H-=32,[A[1]<<H|
A[0]>>>32-H,A[0]<<H|A[1]>>>32-H])},g=function(A,H){return 0===(H%=64)?A:32>H?[A[0]<<H|A[1]>>>32-H,A[1]<<H]:[A[1]<<H-32,0]},e=function(A,H){return[A[0]^H[0],A[1]^H[1]]},h=function(A){return A=e(A,[0,A[0]>>>1]),A=b(A,[4283543511,3981806797]),A=e(A,[0,A[0]>>>1]),A=b(A,[3301882366,444984403]),e(A,[0,A[0]>>>1])},m=function(A,H){H=H||0;var I=(A=A||"").length%16,N=A.length-I,M=[0,H];H=[0,H];for(var C,E,K=[2277735313,289559509],Q=[1291169091,658871167],O=0;O<N;O+=16)C=[255&A.charCodeAt(O+4)|(255&A.charCodeAt(O+
5))<<8|(255&A.charCodeAt(O+6))<<16|(255&A.charCodeAt(O+7))<<24,255&A.charCodeAt(O)|(255&A.charCodeAt(O+1))<<8|(255&A.charCodeAt(O+2))<<16|(255&A.charCodeAt(O+3))<<24],E=[255&A.charCodeAt(O+12)|(255&A.charCodeAt(O+13))<<8|(255&A.charCodeAt(O+14))<<16|(255&A.charCodeAt(O+15))<<24,255&A.charCodeAt(O+8)|(255&A.charCodeAt(O+9))<<8|(255&A.charCodeAt(O+10))<<16|(255&A.charCodeAt(O+11))<<24],C=b(C,K),C=f(C,31),C=b(C,Q),M=e(M,C),M=f(M,27),M=a(M,H),M=a(b(M,[0,5]),[0,1390208809]),E=b(E,Q),E=f(E,33),E=b(E,K),
H=e(H,E),H=f(H,31),H=a(H,M),H=a(b(H,[0,5]),[0,944331445]);switch(C=[0,0],E=[0,0],I){case 15:E=e(E,g([0,A.charCodeAt(O+14)],48));case 14:E=e(E,g([0,A.charCodeAt(O+13)],40));case 13:E=e(E,g([0,A.charCodeAt(O+12)],32));case 12:E=e(E,g([0,A.charCodeAt(O+11)],24));case 11:E=e(E,g([0,A.charCodeAt(O+10)],16));case 10:E=e(E,g([0,A.charCodeAt(O+9)],8));case 9:E=e(E,[0,A.charCodeAt(O+8)]),E=b(E,Q),E=f(E,33),E=b(E,K),H=e(H,E);case 8:C=e(C,g([0,A.charCodeAt(O+7)],56));case 7:C=e(C,g([0,A.charCodeAt(O+6)],48));
case 6:C=e(C,g([0,A.charCodeAt(O+5)],40));case 5:C=e(C,g([0,A.charCodeAt(O+4)],32));case 4:C=e(C,g([0,A.charCodeAt(O+3)],24));case 3:C=e(C,g([0,A.charCodeAt(O+2)],16));case 2:C=e(C,g([0,A.charCodeAt(O+1)],8));case 1:C=e(C,[0,A.charCodeAt(O)]),C=b(C,K),C=f(C,31),C=b(C,Q),M=e(M,C)}return M=e(M,[0,A.length]),H=e(H,[0,A.length]),M=a(M,H),H=a(H,M),M=h(M),H=h(H),M=a(M,H),H=a(H,M),("00000000"+(M[0]>>>0).toString(16)).slice(-8)+("00000000"+(M[1]>>>0).toString(16)).slice(-8)+("00000000"+(H[0]>>>0).toString(16)).slice(-8)+
("00000000"+(H[1]>>>0).toString(16)).slice(-8)},l={preprocessor:null,audio:{timeout:1E3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},n=function(A,H){if(Array.prototype.forEach&&
A.forEach===Array.prototype.forEach)A.forEach(H);else if(A.length===+A.length)for(var I=0,N=A.length;I<N;I++)H(A[I],I,A);else for(I in A)A.hasOwnProperty(I)&&H(A[I],I,A)},p=function(A,H){var I=[];return null==A?I:Array.prototype.map&&A.map===Array.prototype.map?A.map(H):(n(A,function(N,M,C){I.push(H(N,M,C))}),I)},q=function(A){if(null==navigator.plugins)return A.NOT_AVAILABLE;for(var H=[],I=0,N=navigator.plugins.length;I<N;I++)navigator.plugins[I]&&H.push(navigator.plugins[I]);return u(A)&&(H=H.sort(function(M,
C){return M.name>C.name?1:M.name<C.name?-1:0})),p(H,function(M){var C=p(M,function(E){return[E.type,E.suffixes]});return[M.name,M.description,C]})},v=function(A){var H=[];Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(window,"ActiveXObject")||"ActiveXObject"in window?H=p("AcroPDF.PDF;Adodb.Stream;AgControl.AgControl;DevalVRXCtrl.DevalVRXCtrl.1;MacromediaFlashPaper.MacromediaFlashPaper;Msxml2.DOMDocument;Msxml2.XMLHTTP;PDF.PdfCtrl;QuickTime.QuickTime;QuickTimeCheckObject.QuickTimeCheck.1;RealPlayer;RealPlayer.RealPlayer(tm) ActiveX Control (32-bit);RealVideo.RealVideo(tm) ActiveX Control (32-bit);Scripting.Dictionary;SWCtl.SWCtl;Shell.UIHelper;ShockwaveFlash.ShockwaveFlash;Skype.Detection;TDCCtl.TDCCtl;WMPlayer.OCX;rmocx.RealPlayer G2 Control;rmocx.RealPlayer G2 Control.1".split(";"),
function(I){try{return new window.ActiveXObject(I),I}catch(N){return A.ERROR}}):H.push(A.NOT_AVAILABLE);return navigator.plugins&&(H=H.concat(q(A))),H},u=function(A){for(var H=!1,I=0,N=A.plugins.sortPluginsFor.length;I<N;I++)if(navigator.userAgent.match(A.plugins.sortPluginsFor[I])){H=!0;break}return H},D=function(){var A,H=function(Q){return A.clearColor(0,0,0,1),A.enable(A.DEPTH_TEST),A.depthFunc(A.LEQUAL),A.clear(A.COLOR_BUFFER_BIT|A.DEPTH_BUFFER_BIT),"["+Q[0]+", "+Q[1]+"]"};if(!(A=G()))return null;
var I=[],N=A.createBuffer();A.bindBuffer(A.ARRAY_BUFFER,N);var M=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);A.bufferData(A.ARRAY_BUFFER,M,A.STATIC_DRAW);N.itemSize=3;N.numItems=3;M=A.createProgram();var C=A.createShader(A.VERTEX_SHADER);A.shaderSource(C,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}");A.compileShader(C);var E=A.createShader(A.FRAGMENT_SHADER);
A.shaderSource(E,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}");A.compileShader(E);A.attachShader(M,C);A.attachShader(M,E);A.linkProgram(M);A.useProgram(M);M.vertexPosAttrib=A.getAttribLocation(M,"attrVertex");M.offsetUniform=A.getUniformLocation(M,"uniformOffset");A.enableVertexAttribArray(M.vertexPosArray);A.vertexAttribPointer(M.vertexPosAttrib,N.itemSize,A.FLOAT,!1,0,0);A.uniform2f(M.offsetUniform,1,1);A.drawArrays(A.TRIANGLE_STRIP,
0,N.numItems);try{I.push(A.canvas.toDataURL())}catch(Q){}I.push("extensions:"+(A.getSupportedExtensions()||[]).join(";"));I.push("webgl aliased line width range:"+H(A.getParameter(A.ALIASED_LINE_WIDTH_RANGE)));I.push("webgl aliased point size range:"+H(A.getParameter(A.ALIASED_POINT_SIZE_RANGE)));I.push("webgl alpha bits:"+A.getParameter(A.ALPHA_BITS));I.push("webgl antialiasing:"+(A.getContextAttributes().antialias?"yes":"no"));I.push("webgl blue bits:"+A.getParameter(A.BLUE_BITS));I.push("webgl depth bits:"+
A.getParameter(A.DEPTH_BITS));I.push("webgl green bits:"+A.getParameter(A.GREEN_BITS));I.push("webgl max anisotropy:"+function(Q){var O=Q.getExtension("EXT_texture_filter_anisotropic")||Q.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||Q.getExtension("MOZ_EXT_texture_filter_anisotropic");return O?(Q=Q.getParameter(O.MAX_TEXTURE_MAX_ANISOTROPY_EXT),0===Q&&(Q=2),Q):null}(A));I.push("webgl max combined texture image units:"+A.getParameter(A.MAX_COMBINED_TEXTURE_IMAGE_UNITS));I.push("webgl max cube map texture size:"+
A.getParameter(A.MAX_CUBE_MAP_TEXTURE_SIZE));I.push("webgl max fragment uniform vectors:"+A.getParameter(A.MAX_FRAGMENT_UNIFORM_VECTORS));I.push("webgl max render buffer size:"+A.getParameter(A.MAX_RENDERBUFFER_SIZE));I.push("webgl max texture image units:"+A.getParameter(A.MAX_TEXTURE_IMAGE_UNITS));I.push("webgl max texture size:"+A.getParameter(A.MAX_TEXTURE_SIZE));I.push("webgl max varying vectors:"+A.getParameter(A.MAX_VARYING_VECTORS));I.push("webgl max vertex attribs:"+A.getParameter(A.MAX_VERTEX_ATTRIBS));
I.push("webgl max vertex texture image units:"+A.getParameter(A.MAX_VERTEX_TEXTURE_IMAGE_UNITS));I.push("webgl max vertex uniform vectors:"+A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS));I.push("webgl max viewport dims:"+H(A.getParameter(A.MAX_VIEWPORT_DIMS)));I.push("webgl red bits:"+A.getParameter(A.RED_BITS));I.push("webgl renderer:"+A.getParameter(A.RENDERER));I.push("webgl shading language version:"+A.getParameter(A.SHADING_LANGUAGE_VERSION));I.push("webgl stencil bits:"+A.getParameter(A.STENCIL_BITS));
I.push("webgl vendor:"+A.getParameter(A.VENDOR));I.push("webgl version:"+A.getParameter(A.VERSION));try{var K=A.getExtension("WEBGL_debug_renderer_info");K&&(I.push("webgl unmasked vendor:"+A.getParameter(K.UNMASKED_VENDOR_WEBGL)),I.push("webgl unmasked renderer:"+A.getParameter(K.UNMASKED_RENDERER_WEBGL)))}catch(Q){}return A.getShaderPrecisionFormat&&n(["FLOAT","INT"],function(Q){n(["VERTEX","FRAGMENT"],function(O){n(["HIGH","MEDIUM","LOW"],function(L){n(["precision","rangeMin","rangeMax"],function(P){var S=
A.getShaderPrecisionFormat(A[O+"_SHADER"],A[L+"_"+Q])[P];"precision"!==P&&(P="precision "+P);P=["webgl ",O.toLowerCase()," shader ",L.toLowerCase()," ",Q.toLowerCase()," ",P,":",S].join("");I.push(P)})})})}),I},F=function(){if(void 0!==navigator.languages)try{if(navigator.languages[0].substr(0,2)!==navigator.language.substr(0,2))return!0}catch(A){return!0}return!1},z=function(){var A,H=navigator.userAgent.toLowerCase(),I=navigator.productSub;if(("Chrome"===(A=0<=H.indexOf("firefox")?"Firefox":0<=
H.indexOf("opera")||0<=H.indexOf("opr")?"Opera":0<=H.indexOf("chrome")?"Chrome":0<=H.indexOf("safari")?"Safari":0<=H.indexOf("trident")?"Internet Explorer":"Other")||"Safari"===A||"Opera"===A)&&"20030107"!==I)return!0;H=eval.toString().length;if(37===H&&"Safari"!==A&&"Firefox"!==A&&"Other"!==A||39===H&&"Internet Explorer"!==A&&"Other"!==A||33===H&&"Chrome"!==A&&"Opera"!==A&&"Other"!==A)return!0;try{throw"a";}catch(M){try{M.toSource();var N=!0}catch(C){N=!1}}return N&&"Firefox"!==A&&"Other"!==A},y=
function(){var A=document.createElement("canvas");return!(!A.getContext||!A.getContext("2d"))},B=function(){if(!y())return!1;var A=G();return!!window.WebGLRenderingContext&&!!A},t=function(A,H){window.___fp_swf_loaded=function(M){A(M)};var I,N=H.fonts.swfContainerId;(I=document.createElement("div")).setAttribute("id",(void 0).fonts.swfContainerId);document.body.appendChild(I);window.swfobject.embedSWF(H.fonts.swfPath,N,"1","1","9.0.0",!1,{onReady:"___fp_swf_loaded"},{allowScriptAccess:"always",menu:"false"},
{})},G=function(){var A=document.createElement("canvas"),H=null;try{H=A.getContext("webgl")||A.getContext("experimental-webgl")}catch(I){}return H||(H=null),H},x=[{key:"userAgent",getData:function(A){A(navigator.userAgent)}},{key:"webdriver",getData:function(A,H){A(null==navigator.webdriver?H.NOT_AVAILABLE:navigator.webdriver)}},{key:"language",getData:function(A,H){A(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||H.NOT_AVAILABLE)}},{key:"colorDepth",
getData:function(A,H){A(window.screen.colorDepth||H.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(A,H){A(navigator.deviceMemory||H.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(A,H){A(window.devicePixelRatio||H.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(A,H){A(navigator.hardwareConcurrency?navigator.hardwareConcurrency:H.NOT_AVAILABLE)}},{key:"screenResolution",getData:function(A,H){var I=[window.screen.width,window.screen.height];H=(H.screen.detectScreenOrientation&&
I.sort().reverse(),I);A(H)}},{key:"availableScreenResolution",getData:function(A,H){if(window.screen.availWidth&&window.screen.availHeight){var I=[window.screen.availHeight,window.screen.availWidth];H=(H.screen.detectScreenOrientation&&I.sort().reverse(),I)}else H=H.NOT_AVAILABLE;A(H)}},{key:"timezoneOffset",getData:function(A){A((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(A,H){window.Intl&&window.Intl.DateTimeFormat?A((new window.Intl.DateTimeFormat).resolvedOptions().timeZone):
A(H.NOT_AVAILABLE)}},{key:"sessionStorage",getData:function(A,H){try{var I=!!window.sessionStorage}catch(N){I=H.ERROR}A(I)}},{key:"localStorage",getData:function(A,H){try{var I=!!window.localStorage}catch(N){I=H.ERROR}A(I)}},{key:"indexedDb",getData:function(A,H){try{var I=!!window.indexedDB}catch(N){I=H.ERROR}A(I)}},{key:"addBehavior",getData:function(A){A(!(!document.body||!document.body.addBehavior))}},{key:"openDatabase",getData:function(A){A(!!window.openDatabase)}},{key:"cpuClass",getData:function(A,
H){A(navigator.cpuClass||H.NOT_AVAILABLE)}},{key:"platform",getData:function(A,H){A(navigator.platform?navigator.platform:H.NOT_AVAILABLE)}},{key:"doNotTrack",getData:function(A,H){A(navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:H.NOT_AVAILABLE)}},{key:"plugins",getData:function(A,H){"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?H.plugins.excludeIE?
A(H.EXCLUDED):A(v(H)):A(q(H))}},{key:"canvas",getData:function(A,H){if(y()){var I=[],N=document.createElement("canvas");N.width=2E3;N.height=200;N.style.display="inline";var M=N.getContext("2d");H=(M.rect(0,0,10,10),M.rect(2,2,6,6),I.push("canvas winding:"+(!1===M.isPointInPath(5,5,"evenodd")?"yes":"no")),M.textBaseline="alphabetic",M.fillStyle="#f60",M.fillRect(125,1,62,20),M.fillStyle="#069",H.dontUseFakeFontInCanvas?M.font="11pt Arial":M.font="11pt no-real-font-123",M.fillText("Cwm fjordbank glyphs vext quiz, \ud83d\ude03",
2,15),M.fillStyle="rgba(102, 204, 0, 0.2)",M.font="18pt Arial",M.fillText("Cwm fjordbank glyphs vext quiz, \ud83d\ude03",4,45),M.globalCompositeOperation="multiply",M.fillStyle="rgb(255,0,255)",M.beginPath(),M.arc(50,50,50,0,2*Math.PI,!0),M.closePath(),M.fill(),M.fillStyle="rgb(0,255,255)",M.beginPath(),M.arc(100,50,50,0,2*Math.PI,!0),M.closePath(),M.fill(),M.fillStyle="rgb(255,255,0)",M.beginPath(),M.arc(75,100,50,0,2*Math.PI,!0),M.closePath(),M.fill(),M.fillStyle="rgb(255,0,255)",M.arc(75,75,75,
0,2*Math.PI,!0),M.arc(75,75,25,0,2*Math.PI,!0),M.fill("evenodd"),N.toDataURL&&I.push("canvas fp:"+N.toDataURL()),I);A(H)}else A(H.NOT_AVAILABLE)}},{key:"webgl",getData:function(A,H){B()?A(D()):A(H.NOT_AVAILABLE)}},{key:"webglVendorAndRenderer",getData:function(A){if(B()){try{var H=G(),I=H.getExtension("WEBGL_debug_renderer_info");var N=H.getParameter(I.UNMASKED_VENDOR_WEBGL)+"~"+H.getParameter(I.UNMASKED_RENDERER_WEBGL)}catch(M){N=null}A(N)}else A()}},{key:"adBlock",getData:function(A){var H=document.createElement("div");
H.innerHTML="&nbsp;";var I=!(H.className="adsbox");try{document.body.appendChild(H),I=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(H)}catch(N){I=!1}A(I)}},{key:"hasLiedLanguages",getData:function(A){A(F())}},{key:"hasLiedResolution",getData:function(A){A(window.screen.width<window.screen.availWidth||window.screen.height<window.screen.availHeight)}},{key:"hasLiedOs",getData:function(A){var H;var I=navigator.userAgent.toLowerCase();var N=navigator.oscpu,M=
navigator.platform.toLowerCase();I=(H=0<=I.indexOf("windows phone")?"Windows Phone":0<=I.indexOf("win")?"Windows":0<=I.indexOf("android")?"Android":0<=I.indexOf("linux")||0<=I.indexOf("cros")?"Linux":0<=I.indexOf("iphone")||0<=I.indexOf("ipad")?"iOS":0<=I.indexOf("mac")?"Mac":"Other",("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints)&&"Windows Phone"!==H&&"Android"!==H&&"iOS"!==H&&"Other"!==H)||void 0!==N&&(0<=(N=N.toLowerCase()).indexOf("win")&&"Windows"!==H&&"Windows Phone"!==
H||0<=N.indexOf("linux")&&"Linux"!==H&&"Android"!==H||0<=N.indexOf("mac")&&"Mac"!==H&&"iOS"!==H||(-1===N.indexOf("win")&&-1===N.indexOf("linux")&&-1===N.indexOf("mac"))!=("Other"===H))?!0:0<=M.indexOf("win")&&"Windows"!==H&&"Windows Phone"!==H||(0<=M.indexOf("linux")||0<=M.indexOf("android")||0<=M.indexOf("pike"))&&"Linux"!==H&&"Android"!==H||(0<=M.indexOf("mac")||0<=M.indexOf("ipad")||0<=M.indexOf("ipod")||0<=M.indexOf("iphone"))&&"Mac"!==H&&"iOS"!==H||(0>M.indexOf("win")&&0>M.indexOf("linux")&&
0>M.indexOf("mac")&&0>M.indexOf("iphone")&&0>M.indexOf("ipad"))!==("Other"===H)||void 0===navigator.plugins&&"Windows"!==H&&"Windows Phone"!==H;A(I)}},{key:"hasLiedBrowser",getData:function(A){A(z())}},{key:"touchSupport",getData:function(A){var H=0;void 0!==navigator.maxTouchPoints?H=navigator.maxTouchPoints:void 0!==navigator.msMaxTouchPoints&&(H=navigator.msMaxTouchPoints);try{document.createEvent("TouchEvent");var I=!0}catch(N){I=!1}A([H,I,"ontouchstart"in window])}},{key:"fonts",getData:function(A,
H){var I=["monospace","sans-serif","serif"],N="Andale Mono;Arial;Arial Black;Arial Hebrew;Arial MT;Arial Narrow;Arial Rounded MT Bold;Arial Unicode MS;Bitstream Vera Sans Mono;Book Antiqua;Bookman Old Style;Calibri;Cambria;Cambria Math;Century;Century Gothic;Century Schoolbook;Comic Sans;Comic Sans MS;Consolas;Courier;Courier New;Geneva;Georgia;Helvetica;Helvetica Neue;Impact;Lucida Bright;Lucida Calligraphy;Lucida Console;Lucida Fax;LUCIDA GRANDE;Lucida Handwriting;Lucida Sans;Lucida Sans Typewriter;Lucida Sans Unicode;Microsoft Sans Serif;Monaco;Monotype Corsiva;MS Gothic;MS Outlook;MS PGothic;MS Reference Sans Serif;MS Sans Serif;MS Serif;MYRIAD;MYRIAD PRO;Palatino;Palatino Linotype;Segoe Print;Segoe Script;Segoe UI;Segoe UI Light;Segoe UI Semibold;Segoe UI Symbol;Tahoma;Times;Times New Roman;Times New Roman PS;Trebuchet MS;Verdana;Wingdings;Wingdings 2;Wingdings 3".split(";");
H.fonts.extendedJsFonts&&(N=N.concat("Abadi MT Condensed Light;Academy Engraved LET;ADOBE CASLON PRO;Adobe Garamond;ADOBE GARAMOND PRO;Agency FB;Aharoni;Albertus Extra Bold;Albertus Medium;Algerian;Amazone BT;American Typewriter;American Typewriter Condensed;AmerType Md BT;Andalus;Angsana New;AngsanaUPC;Antique Olive;Aparajita;Apple Chancery;Apple Color Emoji;Apple SD Gothic Neo;Arabic Typesetting;ARCHER;ARNO PRO;Arrus BT;Aurora Cn BT;AvantGarde Bk BT;AvantGarde Md BT;AVENIR;Ayuthaya;Bandy;Bangla Sangam MN;Bank Gothic;BankGothic Md BT;Baskerville;Baskerville Old Face;Batang;BatangChe;Bauer Bodoni;Bauhaus 93;Bazooka;Bell MT;Bembo;Benguiat Bk BT;Berlin Sans FB;Berlin Sans FB Demi;Bernard MT Condensed;BernhardFashion BT;BernhardMod BT;Big Caslon;BinnerD;Blackadder ITC;BlairMdITC TT;Bodoni 72;Bodoni 72 Oldstyle;Bodoni 72 Smallcaps;Bodoni MT;Bodoni MT Black;Bodoni MT Condensed;Bodoni MT Poster Compressed;Bookshelf Symbol 7;Boulder;Bradley Hand;Bradley Hand ITC;Bremen Bd BT;Britannic Bold;Broadway;Browallia New;BrowalliaUPC;Brush Script MT;Californian FB;Calisto MT;Calligrapher;Candara;CaslonOpnface BT;Castellar;Centaur;Cezanne;CG Omega;CG Times;Chalkboard;Chalkboard SE;Chalkduster;Charlesworth;Charter Bd BT;Charter BT;Chaucer;ChelthmITC Bk BT;Chiller;Clarendon;Clarendon Condensed;CloisterBlack BT;Cochin;Colonna MT;Constantia;Cooper Black;Copperplate;Copperplate Gothic;Copperplate Gothic Bold;Copperplate Gothic Light;CopperplGoth Bd BT;Corbel;Cordia New;CordiaUPC;Cornerstone;Coronet;Cuckoo;Curlz MT;DaunPenh;Dauphin;David;DB LCD Temp;DELICIOUS;Denmark;DFKai-SB;Didot;DilleniaUPC;DIN;DokChampa;Dotum;DotumChe;Ebrima;Edwardian Script ITC;Elephant;English 111 Vivace BT;Engravers MT;EngraversGothic BT;Eras Bold ITC;Eras Demi ITC;Eras Light ITC;Eras Medium ITC;EucrosiaUPC;Euphemia;Euphemia UCAS;EUROSTILE;Exotc350 Bd BT;FangSong;Felix Titling;Fixedsys;FONTIN;Footlight MT Light;Forte;FrankRuehl;Fransiscan;Freefrm721 Blk BT;FreesiaUPC;Freestyle Script;French Script MT;FrnkGothITC Bk BT;Fruitger;FRUTIGER;Futura;Futura Bk BT;Futura Lt BT;Futura Md BT;Futura ZBlk BT;FuturaBlack BT;Gabriola;Galliard BT;Gautami;Geeza Pro;Geometr231 BT;Geometr231 Hv BT;Geometr231 Lt BT;GeoSlab 703 Lt BT;GeoSlab 703 XBd BT;Gigi;Gill Sans;Gill Sans MT;Gill Sans MT Condensed;Gill Sans MT Ext Condensed Bold;Gill Sans Ultra Bold;Gill Sans Ultra Bold Condensed;Gisha;Gloucester MT Extra Condensed;GOTHAM;GOTHAM BOLD;Goudy Old Style;Goudy Stout;GoudyHandtooled BT;GoudyOLSt BT;Gujarati Sangam MN;Gulim;GulimChe;Gungsuh;GungsuhChe;Gurmukhi MN;Haettenschweiler;Harlow Solid Italic;Harrington;Heather;Heiti SC;Heiti TC;HELV;Herald;High Tower Text;Hiragino Kaku Gothic ProN;Hiragino Mincho ProN;Hoefler Text;Humanst 521 Cn BT;Humanst521 BT;Humanst521 Lt BT;Imprint MT Shadow;Incised901 Bd BT;Incised901 BT;Incised901 Lt BT;INCONSOLATA;Informal Roman;Informal011 BT;INTERSTATE;IrisUPC;Iskoola Pota;JasmineUPC;Jazz LET;Jenson;Jester;Jokerman;Juice ITC;Kabel Bk BT;Kabel Ult BT;Kailasa;KaiTi;Kalinga;Kannada Sangam MN;Kartika;Kaufmann Bd BT;Kaufmann BT;Khmer UI;KodchiangUPC;Kokila;Korinna BT;Kristen ITC;Krungthep;Kunstler Script;Lao UI;Latha;Leelawadee;Letter Gothic;Levenim MT;LilyUPC;Lithograph;Lithograph Light;Long Island;Lydian BT;Magneto;Maiandra GD;Malayalam Sangam MN;Malgun Gothic;Mangal;Marigold;Marion;Marker Felt;Market;Marlett;Matisse ITC;Matura MT Script Capitals;Meiryo;Meiryo UI;Microsoft Himalaya;Microsoft JhengHei;Microsoft New Tai Lue;Microsoft PhagsPa;Microsoft Tai Le;Microsoft Uighur;Microsoft YaHei;Microsoft Yi Baiti;MingLiU;MingLiU_HKSCS;MingLiU_HKSCS-ExtB;MingLiU-ExtB;Minion;Minion Pro;Miriam;Miriam Fixed;Mistral;Modern;Modern No. 20;Mona Lisa Solid ITC TT;Mongolian Baiti;MONO;MoolBoran;Mrs Eaves;MS LineDraw;MS Mincho;MS PMincho;MS Reference Specialty;MS UI Gothic;MT Extra;MUSEO;MV Boli;Nadeem;Narkisim;NEVIS;News Gothic;News GothicMT;NewsGoth BT;Niagara Engraved;Niagara Solid;Noteworthy;NSimSun;Nyala;OCR A Extended;Old Century;Old English Text MT;Onyx;Onyx BT;OPTIMA;Oriya Sangam MN;OSAKA;OzHandicraft BT;Palace Script MT;Papyrus;Parchment;Party LET;Pegasus;Perpetua;Perpetua Titling MT;PetitaBold;Pickwick;Plantagenet Cherokee;Playbill;PMingLiU;PMingLiU-ExtB;Poor Richard;Poster;PosterBodoni BT;PRINCETOWN LET;Pristina;PTBarnum BT;Pythagoras;Raavi;Rage Italic;Ravie;Ribbon131 Bd BT;Rockwell;Rockwell Condensed;Rockwell Extra Bold;Rod;Roman;Sakkal Majalla;Santa Fe LET;Savoye LET;Sceptre;Script;Script MT Bold;SCRIPTINA;Serifa;Serifa BT;Serifa Th BT;ShelleyVolante BT;Sherwood;Shonar Bangla;Showcard Gothic;Shruti;Signboard;SILKSCREEN;SimHei;Simplified Arabic;Simplified Arabic Fixed;SimSun;SimSun-ExtB;Sinhala Sangam MN;Sketch Rockwell;Skia;Small Fonts;Snap ITC;Snell Roundhand;Socket;Souvenir Lt BT;Staccato222 BT;Steamer;Stencil;Storybook;Styllo;Subway;Swis721 BlkEx BT;Swiss911 XCm BT;Sylfaen;Synchro LET;System;Tamil Sangam MN;Technical;Teletype;Telugu Sangam MN;Tempus Sans ITC;Terminal;Thonburi;Traditional Arabic;Trajan;TRAJAN PRO;Tristan;Tubular;Tunga;Tw Cen MT;Tw Cen MT Condensed;Tw Cen MT Condensed Extra Bold;TypoUpright BT;Unicorn;Univers;Univers CE 55 Medium;Univers Condensed;Utsaah;Vagabond;Vani;Vijaya;Viner Hand ITC;VisualUI;Vivaldi;Vladimir Script;Vrinda;Westminster;WHITNEY;Wide Latin;ZapfEllipt BT;ZapfHumnst BT;ZapfHumnst Dm BT;Zapfino;Zurich BlkEx BT;Zurich Ex BT;ZWAdobeF".split(";")));
N=(N=N.concat(H.fonts.userDefinedFonts)).filter(function(V,X){return N.indexOf(V)===X});H=document.getElementsByTagName("body")[0];var M=document.createElement("div"),C=document.createElement("div"),E={},K={},Q=function(){var V=document.createElement("span");return V.style.position="absolute",V.style.left="-9999px",V.style.fontSize="72px",V.style.fontStyle="normal",V.style.fontWeight="normal",V.style.letterSpacing="normal",V.style.lineBreak="auto",V.style.lineHeight="normal",V.style.textTransform=
"none",V.style.textAlign="left",V.style.textDecoration="none",V.style.textShadow="none",V.style.whiteSpace="normal",V.style.wordBreak="normal",V.style.wordSpacing="normal",V.innerHTML="mmmmmmmmmmlli",V},O=function(V){for(var X=!1,T=0;T<I.length&&!(X=V[T].offsetWidth!==E[I[T]]||V[T].offsetHeight!==K[I[T]]);T++);return X},L=function(){for(var V=[],X=0,T=I.length;X<T;X++){var R=Q();R.style.fontFamily=I[X];M.appendChild(R);V.push(R)}return V}();H.appendChild(M);for(var P=0,S=I.length;P<S;P++)E[I[P]]=
L[P].offsetWidth,K[I[P]]=L[P].offsetHeight;L=function(){for(var V,X,T,R={},W=0,aa=N.length;W<aa;W++){for(var Z=[],ba=0,ca=I.length;ba<ca;ba++){var Y=(V=N[W],X=I[ba],T=void 0,(T=Q()).style.fontFamily="'"+V+"',"+X,T);C.appendChild(Y);Z.push(Y)}R[N[W]]=Z}return R}();H.appendChild(C);P=[];S=0;for(var U=N.length;S<U;S++)O(L[N[S]])&&P.push(N[S]);H.removeChild(C);H.removeChild(M);A(P)},pauseBefore:!0},{key:"fontsFlash",getData:function(A,H){return void 0!==window.swfobject?window.swfobject.hasFlashPlayerVersion("9.0.0")?
H.fonts.swfPath?void t(function(I){A(I)},H):A("missing options.fonts.swfPath"):A("flash not installed"):A("swf object not loaded")},pauseBefore:!0},{key:"audio",getData:function(A,H){var I=H.audio;if(I.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return A(H.EXCLUDED);var N=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==N)return A(H.NOT_AVAILABLE);var M=new N(1,44100,44100),C=M.createOscillator();C.type="triangle";C.frequency.setValueAtTime(1E4,M.currentTime);
var E=M.createDynamicsCompressor();n([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],function(Q){void 0!==E[Q[0]]&&"function"==typeof E[Q[0]].setValueAtTime&&E[Q[0]].setValueAtTime(Q[1],M.currentTime)});C.connect(E);E.connect(M.destination);C.start(0);M.startRendering();var K=setTimeout(function(){return console.warn("Audio fingerprint timed out"),M.oncomplete=function(){},M=null,A("audioTimeout")},I.timeout);M.oncomplete=function(Q){try{clearTimeout(K);
var O=Q.renderedBuffer.getChannelData(0).slice(4500,5E3).reduce(function(L,P){return L+Math.abs(P)},0).toString();C.disconnect();E.disconnect()}catch(L){return void A(L)}A(O)}}},{key:"enumerateDevices",getData:function(A,H){if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return A(H.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then(function(I){A(I.map(function(N){return"id="+N.deviceId+";gid="+N.groupId+";"+N.kind+";"+N.label}))}).catch(function(I){A(I)})}}],J=function(A){throw Error("'new Fingerprint()' is deprecated");
};return J.get=function(A,H){H?A||(A={}):(H=A,A={});(function(C,E){if(null!=E){var K,Q;for(Q in E)null==(K=E[Q])||Object.prototype.hasOwnProperty.call(C,Q)||(C[Q]=K)}})(A,l);A.components=A.extraComponents.concat(x);var I={data:[],addPreprocessedComponent:function(C,E){"function"==typeof A.preprocessor&&(E=A.preprocessor(C,E));I.data.push({key:C,value:E})}},N=-1,M=function(C){if((N+=1)>=A.components.length)H(I.data);else{var E=A.components[N];if(A.excludes[E.key])M(!1);else{if(!C&&E.pauseBefore)return--N,
void setTimeout(function(){M(!0)},1);try{E.getData(function(K){I.addPreprocessedComponent(E.key,K);M(!1)},A)}catch(K){I.addPreprocessedComponent(E.key,String(K)),M(!1)}}}};M(!1)},J.getPromise=function(A){return new Promise(function(H,I){J.get(A,H)})},J.getV18=function(A,H){return null==H&&(H=A,A={}),J.get(A,function(I){for(var N=[],M=0;M<I.length;M++){var C=I[M];C.value===(A.NOT_AVAILABLE||"not available")?N.push({key:C.key,value:"unknown"}):"plugins"===C.key?N.push({key:"plugins",value:p(C.value,
function(E){var K=p(E[2],function(Q){return Q.join?Q.join("~"):Q}).join(",");return[E[0],E[1],K].join("::")})}):-1!==["canvas","webgl"].indexOf(C.key)?N.push({key:C.key,value:C.value.join("~")}):-1!==["sessionStorage","localStorage","indexedDb","addBehavior","openDatabase"].indexOf(C.key)?C.value&&N.push({key:C.key,value:1}):C.value?N.push(C.value.join?{key:C.key,value:C.value.join(";")}:C):N.push({key:C.key,value:C.value})}I=m(p(N,function(E){return E.value}).join("~~~"),31);H(I,N)})},J.x64hash128=
m,J.VERSION="2.1.0",J});function trim(a){return a.replace(/(^\s*)|(\s*$)/g,"")}function ltrim(a){return a.replace(/(^\s*)/g,"")}function rtrim(a){return a.replace(/(\s*$)/g,"")}function trimSingle(a){return a.replace(/(^'*)|('*$)/g,"")}function trimDbSingle(a){return a.replace(/(^"*)|("*$)/g,"")}
function skipFlag(a,b){if('"'==a[b])for(b++;b<a.length&&'"'!=a[b];b++);else if("'"==a[b])for(b++;b<a.length&&"'"!=a[b];b++);else if("`"==a[b])for(b++;b<a.length&&"`"!=a[b];b++);else if("("==a[b])for(b++;b<a.length;b++)if('"'==a[b]||"'"==a[b]||"`"==a[b])b=skipFlag(a,b);else if("("==a[b])b=skipFlag(a,b);else if(")"==a[b])break;return b}function isStringType(a){var b=/(^"*)|("*$)/;return/(^'*)|('*$)/.test(a)||b.test(a)?!0:!1}
function strIsNumber(a){var b=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return/^\d+(\.\d+)?$/.test(a)||b.test(a)?!0:!1}function objLength(a){var b=0,f;for(f in a)b++;return b}
function getTableForMap(a){var b=null;if(a&&a.data&&"row"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data[0].length)for(var f=0;f<a.field.length;f++)b||(b={}),b[a.field[f][0]]={value:a.data[0][f],valueType:a.field[f][1]};else if(a&&a.data&&"col"==a.info.rank&&0<a.data.length&&a.field&&a.field.length==a.data.length)for(f=0;f<a.field.length;f++)b||(b={}),b[a.field[f][0]]={value:a.data[f][0],valueType:a.field[f][1]};return b}
function getNowSaftTime(){var a=new Date,b=a.getFullYear(),f=a.getMonth()+1,g=a.getDate(),e=10>a.getHours()?"0"+a.getHours():a.getHours(),h=10>a.getMinutes()?"0"+a.getMinutes():a.getMinutes(),m=10>a.getSeconds()?"0"+a.getSeconds():a.getSeconds();a=a.getMilliseconds();return b+"-"+f+"-"+g+" "+e+":"+h+":"+m+"."+a}
function getEnvInfo(){return"undefined"!=typeof sdk_cpp_notification&&null!=sdk_cpp_notification?"cpp":"undefined"!=typeof sdk_java_notification&&null!=sdk_java_notification?"android":"undefined"!=typeof sdk_oc_notification&&null!=sdk_oc_notification?"ios":"web"}function makeMessageString(a){a=a.replace(/"/g,"__2__");a=a.replace(/\n/g,"\\n");a=a.replace(/\t/g,"\\t");return a=a.replace(/\\/g,"\\\\")}function xDeepCopy(a){a=JSON.stringify(a);return JSON.parse(a)}
function CheckMustParams(a,b,f){b=a[b];if(null!==b&&""!==b&&void 0!==b)return!0;if(f){for(b=0;b<f.length;b++)if(!CheckMustParams(a,f[b],null))return!1;return!0}return!1}function sleep(a){a*=1E3;for(var b=(new Date).getTime();!((new Date).getTime()-b>a););}function randomIntNum(a,b){switch(arguments.length){case 1:return parseInt(Math.random()*a+1,10);case 2:return parseInt(Math.random()*(b-a+1)+a,10);default:return 0}}
var MAX_INTEGER=Math.pow(2,31)-1,MIN_INTEGER=-1*Math.pow(2,31),EnumParamType=Object.freeze({INTEGER:"integer",NUMBER:"number",STRING:"string",BOOLEAN:"boolean"});
function CheckInputParam(a,b,f,g,e){g=void 0===g?null:g;e=void 0===e?null:e;var h={value:null,status:!0,msg:null};if(f==EnumParamType.INTEGER)if(Number.isInteger(b)){if(b>MAX_INTEGER||b<MIN_INTEGER)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u8d85\u8fc7\u6574\u5f62\u9650\u5236,\u533a\u95f4\u8303\u56f4"+MIN_INTEGER+"\u2014\u2014"+MAX_INTEGER,h;b=Math.trunc(b);if(g){e=!1;f=null;if(g.specialArr){f=g.specialArr;for(var m=0;m<f.length;m++)if(b==f[m]){e=!0;break}f=g.specialArr.toString()}if(null!=
g.max&&b>g.max&&!e)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5927\u4e8e\u6700\u5927\u503c",f&&(h.msg+="\u6216\u4e0d\u662f\u4ee5\u4e0b\u7279\u5b9a\u503c:"+f),h;if(null!=g.min&&b<g.min&&!e)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5c0f\u4e8e\u6700\u5c0f\u503c",f&&(h.msg+="\u6216\u4e0d\u662f\u4ee5\u4e0b\u7279\u5b9a\u503c:"+f),h;if(g.not)for(e=0;e<g.not.length;e++)if(b===g.not[e])return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u80fd\u8bbe\u7f6e\u4e3a"+b,h}}else return h.value=
b,h.status=!1,h.msg=a+"\u5e94\u5f53\u4e3a\u6574\u578b",h;else if(f==EnumParamType.NUMBER)if("number"==typeof b){if(b>MAX_INTEGER||b<MIN_INTEGER)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u8d85\u8fc7\u6574\u578b\u9650\u5236,\u533a\u95f4\u8303\u56f4"+MIN_INTEGER+"\u2014\u2014"+MAX_INTEGER,h;if(g){if(null!=g.max&&b>g.max)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5927\u4e8e\u6700\u5927\u503c",h;if(null!=g.min&&b<g.min)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5c0f\u4e8e\u6700\u5c0f\u503c",
h;if(g.not)for(e=0;e<g.not.length;e++)if(b===g.not[e])return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u80fd\u8bbe\u7f6e\u4e3a"+b,h}}else return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5e94\u5f53\u4e3a\u6570\u5b57",h;else if(f==EnumParamType.STRING)if("string"==typeof b){if(g){f=g.type||[];f=Array.isArray(f)?f:[f];for(m=0;m<f.length;m++)if("date"==f[m]){if(!/^(?:(?:(?:(?=\d{2}(?:(?:[02468][048])|(?:[13579][26])))\d{4}02(?!00)[0-2]\d))|(?:\d{4}(?:(?:(?:(?:0[469])|(?:11))(?!00)(?:(?:[0-2]\d)|(?:30)))|(?:(?:(?:0[13578])|(?:1[02]))(?!00)(?:(?:[0-2]\d)|(?:3[01])))|(?:02(?!(?:00)|(?:29))[0-2]\d))))$/g.test(b))return h.value=
b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u662f\u4e2a\u5408\u6cd5\u7684\u65e5\u671f",h;if(null!=g.min&&b<g.min)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5c0f\u4e8e\u80fd\u8bbe\u5b9a\u7684\u6700\u5c0f\u65e5\u671f",h;if(null!=g.max&&b>g.max)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5927\u4e8e\u80fd\u8bbe\u5b9a\u7684\u6700\u5927\u65e5\u671f",h;if(g.lessEqual&&e[g.lessEqual]&&!(b<=e[g.lessEqual]))return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u5fc5\u987b\u5c0f\u4e8e"+g.lessEqual+
"\u53c2\u6570",h}else if("check"==f[m]){if(!g.reg.test(b))return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u7b26\u5408\u4ee3\u7801\u683c\u5f0f",h}else if("array"==f[m]&&b.split(",").length>g.max)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u6700\u591a\u53ea\u80fd\u4f20\u5165"+g.max+"\u4e2a\u4ee3\u7801",h;if(g.matchValue){e=0;m=!1;Array.isArray(g.matchValue)?f=g.matchValue:(f=g.matchValue.value,m=g.matchValue.ignoreCase||!1);for(;e<f.length;e++)if(m?b.toLocaleUpperCase()==f[e].toLocaleUpperCase():
b==f[e]){g.mapValue&&null!=g.mapValue[e]&&(b=g.mapValue[e]);break}if(e==f.length)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u53c2\u6570",h}if("object"===typeof g.invalid&&0<g.invalid.length)for(e=0;e<g.invalid.length;e++)if(g.invalid[e]===b)return h.value=b,h.status=!1,h.msg=a+"\u53c2\u6570\u4e0d\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u53c2\u6570",h}}else return h.value=b,h.status=!1,h.msg=a+"\u5e94\u5f53\u4e3a\u5b57\u7b26\u4e32",h;else if(f==EnumParamType.BOOLEAN&&
"boolean"!=typeof b)return h.value=b,h.status=!1,h.msg=a+"\u5e94\u5f53\u4e3a\u5e03\u5c14\u503c",h;h.value=b;h.status=!0;h.msg=a+"\u53c2\u6570\u6821\u9a8c\u901a\u8fc7";return h}function JSCreate(a){for(var b="",f=0;f<a.length;f++){var g=a[f],e=g[0];g=g[2];1==e.startsWith("_")?console.log("\u8fc7\u6ee4 "+e):(e="//"+g+" \nconst SDK_FIELD_"+e.toUpperCase()+" = '"+e+"'; \n",b+=e)}console.log(b)}
function iOSCreate(a){for(var b="",f=0;f<a.length;f++){var g=a[f],e=g[0];g=g[2];1==e.startsWith("_")?console.log("\u8fc7\u6ee4 "+e):(e="/** \n *"+g+"\n */\nNSString *const SDK_FIELD_"+e.toUpperCase()+' = @"'+e+'"; \n',b+=e)}console.log(b);b="";for(f=0;f<a.length;f++)g=a[f],e=g[0],g=g[2],1==e.startsWith("_")?console.log("\u8fc7\u6ee4 "+e):(e="/** \n *"+g+"\n */\nextern NSString *const SDK_FIELD_"+e.toUpperCase()+"; \n",b+=e);console.log(b)}
function isNumberWithStr(a){var b=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return/^\d+(\.\d+)?$/.test(a)||b.test(a)?!0:!1}function getDeviceType(){switch(getEnvInfo()){case "android":return 101;case "cpp":return 201;case "ios":return 101;default:if("undefined"!=typeof navigator)var a=navigator.userAgent;return a&&"string"===typeof a?/Mobi|Android|iPad|iPhone/i.test(a)?101:/Windows|Mac/i.test(a)?201:101:101}}
function checkDeviceIdInternal(){var a=localStorage.getItem("device_id_internal");a&&""!==a||(a=generateDeviceIdInternal(),localStorage.setItem("device_id_internal",a));return a}function generateDeviceIdInternal(){for(var a=[],b=0;36>b;b++)a[b]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);a[14]="4";a[19]="0123456789abcdef".substr(a[19]&3|8,1);a[8]=a[13]=a[18]=a[23]="-";return a.join("")};var NSDKLog=function(){};NSDKLog.log=function(a){NSDKLog.output("log",a)};NSDKLog.info=function(a){NSDKLog.output("info",a)};NSDKLog.error=function(a){NSDKLog.output("error",a)};NSDKLog.output=function(a,b){var f=new GLog;f.level=a;f.msg=b;f.time=getNowSaftTime();NSDK&&null!=NSDK.getRealLog()&&NSDK.getRealLog()(f)};function GDataManager(){var a=this,b=Object.freeze({COMPLETE_DATA:1,DEFECT_DATA:2}),f=function(n,p){var q=p.params;if("undefined"!=typeof q.limit&&-1!=q.limit.indexOf(",")){var v=q.limit.split(",");v[0]=parseInt(v[0]);v[1]=parseInt(v[1])}if(n==CONNECT_TYPE.HTTP_TYPE)null!=v&&(p.limit=v,delete p.params.limit);else if(n==CONNECT_TYPE.WS_TYPE||n===CONNECT_TYPE.CUSTOM_WS_TYPE)null!=v&&(q.limit=v),q.function="select",GDataTool.wsParamsFlatten(p,q);return q},g=function(n,p){var q=p.itemId,v=GDataPackManager.sharedInstance();
if(0==v.isDataPackWithId(q)){var u=new GDataPackModel;v.addDataPackWithId(q,u);if(n&(CONNECT_TYPE.WS_TYPE|CONNECT_TYPE.CUSTOM_WS_TYPE)&&(n=p.params,1==n.url.endsWith("/day")||1==n.url.endsWith("trend")||1==n.url.endsWith("/minute")||1==n.url.endsWith("/minute5"))){u.rawResult={cacheWindow:!0};return}u.rawResult={}}};this.fireData=function(n){var p,q,v,u,D,F,z,y,B,t,G,x,J,A,H;return $jscomp.asyncExecutePromiseGeneratorProgram(function(I){if(1==I.nextAddress){p=n.type;NSDKLog.info("SZSE:(GDataManager.fireData)\u5f53\u524d\u94fe\u63a5\u72b6\u6001\uff0c\u94fe\u63a5\u5730\u5740\uff1a"+
(null==(q=mainWebServer)?void 0:null==(v=q.socket)?void 0:null==(u=v.webSocket)?void 0:u.url)+"\uff0c\u94fe\u63a5\u72b6\u6001\uff1a"+(null==(D=mainWebServer)?void 0:null==(F=D.socket)?void 0:F.readyState));if(1!=NSDK.getConnect().status&&p!=CONNECT_TYPE.CUSTOM_WS_TYPE)return NSDKLog.error("SZSE:(GDataManager.fireData)\u6ca1\u6709\u53ef\u7528\u7684\u8fde\u63a5\uff0c\u8fde\u63a5\u72b6\u6001: "+NSDK.getConnect().status+", \u8fde\u63a5\u7c7b\u578b: "+p),I.return();z=f(p,n);g(p,n);if(p==CONNECT_TYPE.HTTP_TYPE)return y=
GDataTool.httpParamsToString(z),B=GSession.sharedInstance().getHttpUrl()+n.url,t={name:"http",cache:!1,field:n.params.fields,query:{condition:y,script:";"+y},seqId:n.seqId+"",http:B,queryStatus:1},null!=n.limit&&(t.query.limit=n.limit),postHttpMessage("query","Api","sdk",""+n.itemId,[t],0,a.receiveHTTPData),I.jumpTo(0);G=GDataTool.wsParamsToString(z);x={name:p==CONNECT_TYPE.WS_TYPE?"quote":"customquote",queryStatus:1,query:{script:G,server:null,cacheAll:!1},seqId:n.seqId+"",sql:G};null!=z.limit&&
(x.query.limit=z.limit);if(p!=CONNECT_TYPE.CUSTOM_WS_TYPE)return sendMessage("query","Api","sdk",""+n.itemId,[x],a.receiveWSData),I.jumpTo(0);J=GSession.sharedInstance().customQuoteLogin();return I.yield(J.then(function(){x.server=!0;x.query.server=GCustomQuoteWs.sharedInstance().webService;sendMessage("query","Api","sdk",""+n.itemId,[x],a.receiveWSData);return!0},function(){NSDKLog.log("SZSE:(GDataManager.fireData)\u81ea\u5b9a\u4e49\u884c\u60c5\u8bf7\u6c42\u5931\u8d25");return!1}),4)}A=I.yieldResult;
if(!A)return H={id:n.itemId,data:{},seqId:n.seqId,code:500,status:!1,msg:"custom_quote  connection failed"},GRequestManager.sharedInstance().receiveDataFormComLayer(H),I.return();I.jumpToEnd()})};this.stopPushData=function(n){sendMessage("cancel","Api","sdk",n,null,null)};this.cancelPushData=function(n){sendMessage("cancel","Api","sdk",n,null,null)};this.clearLastMsg=function(n){clearLastmsgForId("Api","sdk",n)};this.receiveWSData=function(n,p){if("sql"==p){var q=!0,v=GRequestManager.getItemsWithId(n.gid.idx),
u=null!==n.data?null!==n.data.result?null!==n.data.result[0]?null!==n.data.result[0].table?n.data.result[0].table:null:null:null:null;if((v instanceof GQuoteSubscribe||v instanceof GUpDownDistribution||v instanceof GMoneyFlow||v instanceof GTradeQueue||v instanceof GVolumeDistribution)&&u&&u.field&&u.data)for(v=u.data,u=0;u<v.length;u++)if(1<v[u].length){q=!0;break}else q=!1;if(0==q)return}if("sql"==p||"sql subscribe"==p){var D=n.gid.idx;q=GRequestManager.getItemsWithId(D);if(null==q)console.log("\u975e\u6cd5\u7684\u8fd4\u56de\u6570\u636e");
else{var F=q.getRequestValue();v=[];if(null==F?0:F.limit)v=F.limit.split(","),v[0]=parseInt(v[0]),v[1]=parseInt(v[1]);u=v[0];var z=v[1];v=F.subscribe;if(0==v&&q instanceof GKLine)if(F=F[GKLine.inputParam.PERIOD],[SDK_KLINE_PERIOD_1MINUTE,SDK_KLINE_PERIOD_5MINUTES,SDK_KLINE_PERIOD_15MINUTES,SDK_KLINE_PERIOD_30MINUTES,SDK_KLINE_PERIOD_60MINUTES,SDK_KLINE_PERIOD_120MINUTES].includes(F)){var y=null!==n.data?null!==n.data.result?null!==n.data.result[0]?null!==n.data.result[0].table?n.data.result[0].table:
null:null:null:null,B;if(null!==y&&y.info&&y.field&&0<y.field.length&&y.data&&0<y.data.length){var t=y.info.dataRows;for(B=0;B<y.field.length;B++)if("time"==y.field[B][0].toLocaleLowerCase()){var G=B;break}B=h(y.data[G][0])}if(t&&t<z&&B==h()){if(1==e(q,n,p))return}else q.timestamp=null,q.expTimestamp=null,q.timeNumber=null}else if([SDK_KLINE_PERIOD_DAY,SDK_KLINE_PERIOD_WEEK,SDK_KLINE_PERIOD_MONTH,SDK_KLINE_PERIOD_QUARTER,SDK_KLINE_PERIOD_YEAR].includes(F))if(t=null!==n.data?null!==n.data.result?null!==
n.data.result[0]?null!==n.data.result[0].table?n.data.result[0].table:null:null:null:null,null!==t&&t.info&&(y=t.info.dataRows),y&&1>=y){if(1==e(q,n,p))return}else q.timestamp=null,q.expTimestamp=null,q.timeNumber=null;if(p=GRequestManager.sharedInstance().adjustKLineData(D,n.data))n.data=p;G=null!==n.data?null!==n.data.result?null!==n.data.result[0]?null!==n.data.result[0].table?n.data.result[0].table:null:null:null:null;if(null!==G&&void 0!==u&&void 0!==z){var x=z;p=G.info;B=p.dataBegin;y=p.dataRows;
z=p.rank;t=G.flags;G=G.data;D=p.totalRows;-1===u?(D<x&&(x=D),u=y-x,B=D-x):(D-B<=x&&(x=D-B),u=B-(u-1),B-=u);if("col"===z){if(null!==G){var J=u;z=x;for(D=0;D<G.length;D++){F=G[D];for(var A=[],H=0;H<z;H++){var I=F[J+H];null==I?A.push(null):A.push(I)}G[D]=A}J=y>=x?b.COMPLETE_DATA:b.DEFECT_DATA}null!==t&&m(u,x,t)}else if("row"===z){if(null!=G){J=u;y=x;z=b.COMPLETE_DATA;for(D=0;D<y;D++)F=[],A=G[J+D],null==A?(z=b.DEFECT_DATA,F.push(null)):F.push(A);J=z}null!==t&&m(u,x,t)}p.begin=B;p.rows=x;p.dataBegin=B;
p.dataRows=x;x=J}else void 0!==v&&0==v&&(u=G.info,x=G.data,p=u.rank,J=b.COMPLETE_DATA,"col"===p?(x=u.dataRows,u=u.totalRows,J=b.DEFECT_DATA,x>=u&&(J=b.COMPLETE_DATA)):"row"===p&&(u=G.field.length,null!=x[0]&&x[0].length<u&&(J=b.DEFECT_DATA)),x=J);if(null===v||0!=v||q.dataStatus!=b.COMPLETE_DATA)if(q.dataStatus=x,null===v||0!=v||q.dataStatus==b.COMPLETE_DATA){q=l(n);v=q.itemId;J=GDataPackManager.sharedInstance().getDataPackWithId(v);if(null!=J)var N=J.rawResult;null!=N?(n=n.data,J.rawResult=xDeepCopy(n),
n={id:v,data:n,seqId:q.seqId,code:q.code,status:q.status,msg:q.msg},GRequestManager.sharedInstance().receiveDataFormComLayer(n)):console.log("receiveWSData\u51fd\u6570\uff0c\u5b9e\u4f8b\u5bf9\u8c61\u5df2\u88ab\u9500\u6bc1\uff0c\u65e0\u6cd5\u8fdb\u884c\u6570\u636e\u5408\u5e76!")}}}};var e=function(n,p,q){var v=(new Date).getTime();null==n.timestamp&&(n.timestamp=v);null==n.expTimestamp&&(n.expTimestamp=n.timestamp+1E3);if(null==n.timeNumber)return n.timeNumber=setTimeout(function(){null!=n.timeNumber&&
GDataManager.sharedInstance().receiveWSData(p,q)},1E3),1;n.expTimestamp<v&&(n.timestamp=null,n.expTimestamp=null,n.timeNumber=null)},h=function(n){var p=n?new Date(n):new Date;n=p.getFullYear();var q=p.getMonth()+1+"";q=2>q.length?"0"+q:q;p=p.getDate()+"";p=2>p.length?"0"+p:p;return n+q+p},m=function(n,p,q){for(var v in q){for(var u=q[v],D=[],F=0;F<p;F++)D.push(u[n+F]);q[v]=D}};this.receiveHTTPData=function(n){var p=l(n),q=p.itemId,v=GDataPackManager.sharedInstance().getDataPackWithId(q);n=n.data;
var u=n.result[0];null!=u&&null!=u.table&&null==u.table.info&&(n={result:[]});v.rawResult=xDeepCopy(n);v=xDeepCopy(n);p={id:q,data:v,seqId:p.seqId,code:p.code,status:p.status,msg:p.msg};GRequestManager.sharedInstance().receiveDataFormComLayer(p)};var l=function(n){var p=n.gid.idx,q=null!=n.status?n.status:!0,v=n.msg?n.msg:"success",u=null!=n.data?n.data.result:n.result,D=u[0].table;!n.msg&&D&&D.info&&D.info.msg&&(v=D.info.msg);u=""+(null!=u[0].gid?u[0].gid.id:u[0].table.gid.id);-1!=u.indexOf(",")&&
(u=u.split(","),u=u[1]);D=200;n.code&&(n=Number((n.code+"").replace(/x/ig,"0")),D=isNaN(n)?STATU_CODE.MAINQUOTE_UNKNOW_CODE:1E9>n?n+1E9:n);return{itemId:p,status:q,msg:v,seqId:u,code:D}}}GDataManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataManager);return this.instance};function GDataPackModel(){this.dataSet=this.dataSource=this.dataSourceResult=this.rawResult=null}
function GDataPackManager(){var a={};this.addDataPackWithId=function(b,f){null==a[b]&&(a[b]=f)};this.getDataPackWithId=function(b){return a[b]};this.setDataPackWithId=function(b,f){return null!=a[b]?(a[b]=f,!0):!1};this.delDataPackWithId=function(b){return null!=a[b]?(a[b]=null,delete a[b]):!1};this.isDataPackWithId=function(b){return null!=a[b]?!0:!1};this.getAllDataPack=function(){return a};this.clearAllDataPack=function(){a={}}}
GDataPackManager.sharedInstance=function(){null==this.instance&&(this.instance=new GDataPackManager);return this.instance};function GDataTool(){this.describe="\u5de5\u5177\u7c7b"}
GDataTool.httpParamsToString=function(a){var b=[],f;for(f in a)if("condition"==f)b.push(a[f]);else if("fields"!=f)switch(Object.prototype.toString.call(a[f]).slice(8,-1).toLowerCase()){case "string":b.push(f+" = '"+a[f]+"'");break;case "number":b.push(f+" = "+a[f]);break;case "array":for(var g="[",e=0;e<a[f].length;e++){var h=a[f][e];switch(h.constructor.name.toLowerCase()){case "string":g+=0==e?"'"+h+"'":",'"+h+"'";break;case "number":g+=0==e?""+h:","+h}}g+="]";b.push(f+" = "+g)}for(a=0;a<b.length;a++)var m=
0==a?b[a]:m+(" and "+b[a]);return m};GDataTool.generateHttpMessage=function(a,b,f,g){var e={lang:"zh-cn",gid:{fm:"",pg:"",idx:""},http:[]};e.gid.fm=a;e.gid.pg=b;e.gid.idx=f;a=GDataTool.packHttpMessage(g);e.http.push(a);return JSON.stringify(e)};
GDataTool.packHttpMessage=function(a){var b={gid:{name:"",id:""},field:[],condition:{}};for(f in a)null!=b[f]&&(b[f]="field"!=f||null!=a[f]&&""!=a[f]?a[f]:[]);b.gid={name:a.name,id:a.seqId};if(null!=b.field&&0<b.field.length){var f=b.field.split(",");for(var g=[],e=0;e<f.length;e++){var h=f[e].replace(/ /g,"");h=trim(h);h=h.toLowerCase();g.push(h)}b.field=g}if(null!=b.condition&&null!=a.condition){f=a.condition;var m;null!=a.must&&(m=a.must.split(","));f=GAnalysisES(f,m);m=f.esCondition;if(0==f.mustCheckStatu)return;
null!=a.param&&(m.param=a.param);b.condition=m}null!=a.limit&&0<a.limit.length?a.batchMode&&"limit"==a.batchMode.toLowerCase()?(b.from=a.limit[0],b.fromSize=a.limit[1]):(b.pageNo=a.limit[0],b.pageSize=a.limit[1]):(b.pageNo=null!=a.pageNo?a.pageNo:"0",b.pageSize=null!=a.pageSize?a.pageSize:"10");return b};
GDataTool.wsParamsToString=function(a){var b={type:null,fields:null,from:null,where:null,date:null,last:null,resample:null,relation:null,includeFlags:null,subscribe:null,orderby:null,order:null},f="type fields from where date last resample relation includeFlags subscribe orderby order".split(" ");for(e in a){var g=a[e];if(null!=g)switch(e.toLowerCase()){case "function":b.type=g;break;case "fields":b.fields=g;break;case "url":b.from="from "+g;null!=a.keys&&(b.from=b.from+"("+a.keys.replace(/ /g,"")+
")");break;case "date":b.date="at "+g;break;case "last":b.last="at last "+g;break;case "condition":b.where="where "+g;break;case "resample":b.resample="resample("+g+")";break;case "relations":b.relation="relation("+g+")";break;case "includeflags":1==g&&(b.includeFlags="include flags");break;case "subscribe":1==g&&(b.subscribe="sub 100");break;case "orderby":b.orderby="order by "+g}}for(a=0;a<f.length;a++){var e=f[a];if(null!=b[e]){g=b[e];var h="type"===e?g:h+(" "+g)}}return h};
GDataTool.generateWsMessage=function(a,b,f,g){a={lang:"zh-cn",gid:{fm:a,pg:b,idx:f}};b=[];g=GDataTool.packWsMessage(g);null!=g.limit&&(g.limit=g.limit[0]+","+g.limit[1]);b.push(g);g=makeMessageString(JSON.stringify(b));a.sql=g;return JSON.stringify(a)};GDataTool.packWsMessage=function(a,b){b={gid:{name:a.name,id:a.seqId,idx:void 0===b?0:b},type:"query"};b.sql=a.sql;null!=a.limit&&(b.limit=a.limit);return b};
GDataTool.wsParamsFlatten=function(a,b){for(var f in a)null!=a[f]&&("Object"==a[f].constructor.name?GDataTool.wsParamsFlatten(a[f],b):b[f]=a[f])};
GDataTool.getValueFormatString=function(a,b,f,g,e){if(null==a)return null!=f&&0<=f.indexOf("%N")?"-":"";if(g&&3==(g&3))return"-";if("Array"==a.constructor.name){if("ti"==b){f="";for(var h=0;h<a.length;h++)f+="["+GDataTool.getValueFormatString(a[h][0],"tm","HH:mm")+","+GDataTool.getValueFormatString(a[h][1],"tm","HH:mm")+"] ";return f}return JSON.stringify(a)}"%d"==f&&(b="i");h=2;b&&("i"==b[0]?h=0:1<b.length&&(h=parseInt(b.slice(1))));var m=GDataTool.isTextType(b),l="Number"==a.constructor.name?!0:
!1;e&&e.unit&&1<e.unit&&l?(a/=e.unit,e=""+a,l=e.indexOf("."),b=0<=l?2<e.length-l-1?"f2":"f"+(e.length-l-1):"f"):(null==b||m)&&l&&(m=!1,e=""+a,l=e.indexOf("."),0<=l?(b="f"+(e.length-l-1),h=e.length-l-1):(b="f",h=0));e=a;if(void 0!=f){if(m){if("."==f[0]){if(m=a.indexOf("."),-1!=m)return a.slice(0,m)}else if("["==f[0])return l=parseInt(f.slice(1)),a.slice(0,l);return a}if(0==a&&0<=f.indexOf("%0"))return"-";m=f.indexOf("%B");0<=m&&(e=-1,null!=g&&(e=(g>>5&7)-1),0>e&&(e=1<b.length?parseInt(b.slice(1)):
0),a/=Math.pow(10,e),5<=a||-5>=a)&&(a=Math.round(a));e=a;var n=f;for(l=0;8>l;l++)if(m=f.indexOf("%."+l),-1!=m){if("string"==typeof a)return void 0!=f&&0<=f.indexOf("%%")?a+"%":a;e=a.toFixed(l);void 0!=f&&0<=f.indexOf("%%")&&(e+="%");h=l;break}-1!=f.indexOf("%V")&&(n=xGlobal.integerFormat,null==n&&(n="%5K"));m=n.indexOf("%,");if(0<=m){e+="";a=e.length;for(m=a-1;0<m;m--)if("."==e[m]){a=m;break}if(3<a)for(m=a-3;0<m&&"-"!=e.slice(0,m);m-=3)e=e.slice(0,m)+","+e.slice(m);return e}m=0<=n.indexOf("%K")?0:
0<=n.indexOf("%0K")?0:0<=n.indexOf("%1K")?1:0<=n.indexOf("%2K")?2:0<=n.indexOf("%3K")?3:0<=n.indexOf("%4K")?4:0<=n.indexOf("%5K")?5:0<=n.indexOf("%6K")?6:0<=n.indexOf("%7K")?7:0<=n.indexOf("%8K")?8:-1;if(0<=m){b=!1;0>a&&(a=Math.abs(a),b=!0);f="";1E3>a?e=a.toFixed(h):1E6>a?(0<m&&(h=3),e=(a/1E3).toFixed(h),f="K"):1E9>a?(0<m&&(h=3),e=(a/1E6).toFixed(h),f="M"):1E12>a?(0<m&&(h=3),e=(a/1E9).toFixed(h),f="B"):(0<m&&(h=3),e=(a/1E12).toFixed(h),f="T");0==m||0==h||e.length<=m||h==h+m-e.length+1||(h=h+m-e.length+
1,0>h&&(h=0),a=parseFloat(e),e=a.toFixed(h));1==b&&(e="-"+e);if(0<h)for(h=e.length-1;0<h;h--)if("0"!=e[h]){e=e.substr(0,h+1);"."==e[e.length-1]&&(e=e.substr(0,e.length-1));break}return e+f}m=0<=n.indexOf("%W")?0:0<=n.indexOf("%0W")?0:0<=n.indexOf("%1W")?1:0<=n.indexOf("%2W")?2:0<=n.indexOf("%3W")?3:0<=n.indexOf("%4W")?4:0<=n.indexOf("%5W")?5:0<=n.indexOf("%6W")?6:0<=n.indexOf("%7W")?7:0<=n.indexOf("%8W")?8:-1;if("string"==typeof a)return"-";if(0<=m)return b=!1,0>a&&(a=Math.abs(a),b=!0),f="",1E4>a?
e=a.toFixed(h):1E8>a?(0<m&&(h=3),e=(a/1E4).toFixed(h),f="\u4e07"):1E12>a?(0<m&&(h=3),e=(a/1E8).toFixed(h),f="\u4ebf"):(0<m&&(h=3),e=(a/1E12).toFixed(h),f="\u4e07\u4ebf"),0==m||0==h||e.length<=m||h==h+m-e.length+1||(h=h+m-e.length+1,0>h&&(h=0),a=parseFloat(e),e=a.toFixed(h)),1==b&&(e="-"+e),e+f}if(void 0!=b)if("f"==b[0]||"x"==b[0])null!=g&&0<(g>>5&7)&&(h=(g>>5&7)-1),void 0!=f&&0<=f.indexOf("%+")&&0<=a?e="+"+a.toFixed(h):"number"==typeof a&&(e=a.toFixed(h)),void 0!=f&&0<=f.indexOf("%%")&&(e+="%");else if("i"==
b[0]){if(void 0!=f&&0<=f.indexOf("%+")&&0<=a)return"+"+a}else{if("d"==b)return a=""+a,a.slice(0,4)+"/"+a.slice(4,6)+"/"+a.slice(6,8);if("th"==b||"tm"==b||"ts"==b||"tms"==b||"dd"==b||"dm"==b||"dq"==b||"dy"==b){if("string"==typeof a)return a;g=!1;h=new Date;29991231>a&&("dd"==b||"dm"==b||"dq"==b||"dy"==b)?(h.setFullYear(parseInt(a/1E4),parseInt(a/100%100)-1,parseInt(a%100)),g=!0):h.setTime(a);0==g&&xGlobal.utcTime?(a=h.getUTCFullYear()+"/"+GDataTool.getValidDateTime(h.getUTCMonth()+1)+"/"+GDataTool.getValidDateTime(h.getUTCDate()),
e=GDataTool.getValidDateTime(h.getUTCHours())+":"+GDataTool.getValidDateTime(h.getUTCMinutes())+":"+GDataTool.getValidDateTime(h.getUTCSeconds())):(a=h.getFullYear()+"/"+GDataTool.getValidDateTime(h.getMonth()+1)+"/"+GDataTool.getValidDateTime(h.getDate()),e=GDataTool.getValidDateTime(h.getHours())+":"+GDataTool.getValidDateTime(h.getMinutes())+":"+GDataTool.getValidDateTime(h.getSeconds()));f?(e=f,0==g&&xGlobal.utcTime?(e=e.replace("YYYY",h.getUTCFullYear()),e=e.replace("YY",GDataTool.getValidDateTime(h.getUTCFullYear()%
100)),e=e.replace("MM",GDataTool.getValidDateTime(h.getUTCMonth()+1)),e=e.replace("DD",GDataTool.getValidDateTime(h.getUTCDate())),e=e.replace("HH",GDataTool.getValidDateTime(h.getUTCHours())),e=e.replace("mm",GDataTool.getValidDateTime(h.getUTCMinutes())),e=e.replace("SS",GDataTool.getValidDateTime(h.getUTCSeconds())),e=e.replace("WEEK",GDataTool.getValidDateTime(h.getUTCDay()))):(e=e.replace("YYYY",h.getFullYear()),e=e.replace("YY",GDataTool.getValidDateTime(h.getUTCFullYear()%100)),e=e.replace("MM",
GDataTool.getValidDateTime(h.getMonth()+1)),e=e.replace("WEEK",GDataTool.getValidDateTime(h.getUTCDay())),0==g?(e=e.replace("DD",GDataTool.getValidDateTime(h.getDate())),e=e.replace("HH",GDataTool.getValidDateTime(h.getHours())),e=e.replace("mm",GDataTool.getValidDateTime(h.getMinutes())),e=e.replace("SS",GDataTool.getValidDateTime(h.getSeconds()))):(e=e.replace("DD,",GDataTool.getValidDateTime(h.getDate())),e=e.replace("DD",GDataTool.getValidDateTime(h.getDate())),e=e.replace("HH:",""),e=e.replace("mm:",
""),e=e.replace("SS",""),e=e.replace("HH",""),e=e.replace("mm","")))):e=g?a:a+", "+e;return e}if("ti"==b)for(e="",m=0;m<a.length;m++)f=new Date,f.setTime(a[m][0]),h=new Date,h.setTime(a[m][1]),e+="["+GDataTool.getValidDateTime(f.getHours())+":"+GDataTool.getValidDateTime(f.getMinutes())+","+GDataTool.getValidDateTime(h.getHours())+":"+GDataTool.getValidDateTime(h.getMinutes())+"] "}return e};GDataTool.isTextType=function(a){return null==a||"c"==a||"t"==a||"t"==a[0]&&"1"<=a[1]&&"9">=a[1]?!0:!1};
GDataTool.getValidDateTime=function(a){return 10>a?"0"+a:""+a};GDataTool.GETGFLAG_ISARROW_EQ=function(a){return 0==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_UP=function(a){return 1==(a&3)?!0:!1};GDataTool.GETGFLAG_ISARROW_DN=function(a){return 2==(a&3)?!0:!1};GDataTool.GETGFLAG_ISINVALID=function(a){return 3==(a&3)?!0:!1};GDataTool.GETGFLAG_COLOR=function(a){return a>>2&3};GDataTool.GETGFLAG_DEC=function(a){return a>>5&7?(a>>5&7)-1:-1};
GDataTool.GET_UP_DOWN_FLAGS=function(a){if(1==GDataTool.GETGFLAG_ISARROW_EQ(a))return 0;if(1==GDataTool.GETGFLAG_ISARROW_UP(a))return 1;if(1==GDataTool.GETGFLAG_ISARROW_DN(a))return 2};GDataTool.getSourceTable=function(a){return(a=GDataSourceManager.sharedInstance().getDataSourceWithId(a))?a.result[0]:null};var xGlobal={};var QUOTELEVEL1="quote_level1",QUOTELEVEL2="quote_level2",Level2Market=["MKT.DATA_LEVEL.SH","MKT.DATA_LEVEL.SZ"];
function GRequestManager(){var a=this;this.requestList={};this.quoteLevel=new Map;this.marketMsgQuote=null;var b=function(e){var h={},m=0;e=e.result;if("number"!==typeof(null==e?void 0:e.length)||0==e.length)return{dataSet:null,dataSource:null};var l=e[0].table;var n=l.field;var p=l.data;var q=l.info;e=q.name;var v=q.totalRows;var u=q.begin;var D=null==p?0:(null!=p[0]?p[0]:[]).length;if("row"==q.rank){D=n.length;q=[];if(p)for(var F=0;F<D;F++){q[F]=[];for(var z=0;z<p.length;z++)q[F][z]=null===p[z]?
"-":p[z][F]}l.info.rank="col";l.data=q;D=0<q.length?q[0].length:0}l=xDeepCopy(l);h.rowCount=D;h.dataSource=l;if(null!=n){m=[];for(D=0;D<n.length;D++)p=n[D][0],q=n[D][1],F=1<q.length?parseInt(q.slice(1)):null,z=null==n[D][2]?null:n[D][2],p={index:D,name:p,type:g(q),remark:z,dec:1==Object.is(F,NaN)?null:F},p=new GColumnInfo(p),m[D]=p;h.columnInfos=m;m=n.length}h.name=e;h.begin=u;h.colCount=m;h.totalRows=v;return{dataSet:new GDataSet(h),dataSource:l}};this.receiveDataFormComLayer=function(e){var h=e.id,
m=e.data,l=m.result,n=GRequestManager.getItemsWithId(h);if("number"===typeof(null==l?void 0:l.length)&&0<l.length&&n&&n instanceof GStep&&n.levelFlag===QUOTELEVEL1){var p=["time","price","volume"],q=l[0].table.info.rows,v=l[0].table,u=v.data,D=v.field.map(function(J){return J[0].toLowerCase()});v=STEPALLORDERFIELDS.filter(function(J){return n.confirmFields.includes(J[0].toLowerCase())});var F=[];v.forEach(function(J){p.includes(J[0].toLowerCase())?F.push(u[D.indexOf(J[0].toLowerCase())]):"dealtype"===
J[0].toLowerCase()?F.push(Array(q).fill(70)):F.push(Array(q).fill(0))});l[0].table.data=F;l[0].table.field=v}if("GTick"===n.flagName&&""!==n.fieldBackUp){var z=e.data.result[0].table;v=z.data;l=z.field;z=z.info;if(0!==v.length){var y=l.findIndex(function(J){return"deallots"===J[0].toLowerCase()}),B=l.findIndex(function(J){return"totaldeallots"===J[0].toLowerCase()});l=[];if(-1!==y&&-1!==B)for(var t=0;t<z.rows;t++){var G=void 0;G=v[B][t]>=v[y][t]&&0<v[y][t]?v[B][t]-v[y][t]+1:0;l.push(G)}else for(v=
0;v<z.rows;v++)l.push(null);v=e.data.result[0].table.field;z=e.data.result[0].table.data;y=[];B=[];var x=n.fieldBackUp.split(",");for(t={$jscomp$loop$prop$i$165$235:0};t.$jscomp$loop$prop$i$165$235<x.length;t={$jscomp$loop$prop$i$165$235:t.$jscomp$loop$prop$i$165$235},t.$jscomp$loop$prop$i$165$235++)"stepbeginindex"===x[t.$jscomp$loop$prop$i$165$235]&&0!==l.length?(y.push(["StepBeginIndex","i!"]),B.push(l)):(G=v.findIndex(function(J){return function(A){return A[0].toLowerCase()===x[J.$jscomp$loop$prop$i$165$235]}}(t)),
-1!==G&&(y.push(v[G]),B.push(z[G])));e.data.result[0].table.field=y;e.data.result[0].table.data=B}}if(null!=NSDK_HOOK.getOnCallback()&&"sysmsg"!==h){e.data=m;h=GRequestManager.getItemsWithId(h);if(null==h?0:h.firstCallbackFlag)NSDKLog.info("SZSE:(GRequestManager.receiveDataFormComLayer): "+h.flagName+" \u7b2c\u4e00\u6b21\u6570\u636e\u8fd4\u56de"),h.firstCallbackFlag=!1;NSDK_HOOK.getOnCallback()(e)}else v=GDataPackManager.sharedInstance().getDataPackWithId(h),z=b(m),l=z.dataSet,z=z.dataSource,null!=
l&&(l.id=h),v.dataSet=l,v.dataSource=z,v.dataSourceResult=m,m=new GResponse,m.itemId=h,m.data=l,m.seqId=e.seqId,m.statusCode=e.code,m.success=e.status,m.msg=e.msg,f(h,m)};this.createDataSet=function(e){return b(e)};var f=function(e,h){(e=GRequestManager.getItemsWithId(e))&&null!=e.getDataCallback()?(e.firstCallbackFlag&&(NSDKLog.info("SZSE:(GRequestManager.distributeData): "+e.flagName+" \u7b2c\u4e00\u6b21\u6570\u636e\u8fd4\u56de"),e.firstCallbackFlag=!1),e.getDataCallback()(h)):console.log("\u8f6c\u53d1\u6570\u636e\u5931\u8d25\uff0c\u627e\u4e0d\u5230\u8bf7\u6c42\u5bf9\u8c61\u6216\u8005\u672a\u8bbe\u7f6e\u6570\u636e\u56de\u8c03")};
this.adjustKLineData=function(e,h){e=NSDK.getRequestItemsById(e);if(e instanceof GKLine)return e=e.getCqMode(),GEngineApply.sharedInstance().getDividendData(h,e)};var g=function(e){if("t"==e)return GDataType.text;if("ta"==e)return GDataType.array_text;if("th"==e||"tm"==e||"tms"==e||"ts"==e)return GDataType.time;if("dy"==e||"dq"==e||"dm"==e||"dd"==e)return GDataType.date;if(e.startsWith("f")||e.startsWith("x"))return GDataType.double;if(e.startsWith("g"))return GDataType.graph;if("ti"==e)return GDataType.timescale;
if(e.startsWith("i")&&-1==e.indexOf("."))return GDataType.int;if(e.startsWith("i")&&-1!=e.indexOf("."))return GDataType.array_int};this.updateQuoteLevel=function(e,h){Object.values(a.requestList).forEach(function(m){m instanceof GStep&&m.getInputValue().code.endsWith(e)&&m.promotionOrDemotion(h,!1)})};this.getQueryLevel=function(e){e=e.substring(e.lastIndexOf("."));return a.quoteLevel.get(e)};this.addMarketMsgMoniter=function(){if(a.marketMsgQuote)NSDKLog.log("\u5df2\u7ecf\u6dfb\u52a0\u5e02\u573a\u76d1\u542c");
else{var e=Level2Market.map(function(m){return"'"+m+"'"}).join(","),h=new GRequestQuote("sysmsg");GRequestManager.addItems(h);h.setDataCallback(function(m){if(m.success&&0<m.data.getTotalRows()){var l,n,p,q=null==m?void 0:null==(l=m.data)?void 0:null==(n=l.getDataSource())?void 0:null==(p=n.data)?void 0:p[1];q&&q.length===Level2Market.length?Level2Market.forEach(function(v,u){if(q[u]){u=q[u];var D="1"===u?QUOTELEVEL1:QUOTELEVEL2,F=v.substring(v.lastIndexOf("."));a.quoteLevel.get(F)!==D&&(a.quoteLevel.set(F,
D),GSession.sharedInstance().pushMsg(JSON.stringify({msgKey:v,msgContent:u}),STATU_CODE.MAINQUOTE_SYS_MSG),a.updateQuoteLevel(F,D))}}):NSDKLog.log("\u884c\u60c5\u5e02\u573a\u8fd4\u56de\u6570\u636e\u9519\u8bef\uff01")}});h.setAPI("sysMsg");h.setParam("fields","msgContent");h.setParam("condition","msgKey in ("+e+")");h.setParam("subscribe",!0);h.request();a.marketMsgQuote=h}};this.clearMarketMsgQuote=function(){a.marketMsgQuote=null}}
GRequestManager.sharedInstance=function(){null==this.instance&&(this.instance=new GRequestManager);return this.instance};GRequestManager.requestList=GRequestManager.sharedInstance().requestList;GRequestManager.addItems=function(a){var b=a.getItemId();GRequestManager.requestList[b]=a};GRequestManager.getAllRequestItems=function(){return Object.values(GRequestManager.requestList)};GRequestManager.hasRequestItem=function(a){return GRequestManager.requestList[a]?!0:!1};
GRequestManager.getItemsWithId=function(a){return GRequestManager.requestList[a]};GRequestManager.deleteItemsWithId=function(a){if(1==GRequestManager.hasRequestItem(a))return GDataManager.sharedInstance().cancelPushData(a),GDataManager.sharedInstance().clearLastMsg(a),delete GRequestManager.requestList[a]};function GHttp(){var a,b,f,g,e,h;this.setUrl=function(m){a=m};this.getUrl=function(){return a};this.setHeader=function(m,l){null==b&&(b={});b[m]=l};this.setType=function(m){f=m};this.setParam=function(m,l){null==g&&(g={});g[m]=l};this.setBody=function(m){e=m};this.getAllResponseHeaders=function(){if(null!=h)return h.getAllResponseHeaders()};this.getHttpStatus=function(){if(null!=h)return h.getHttpStatus()};this.getResponseHeader=function(m){if(null!=h)return h.getResponseHeader(m)};this.stop=function(){null!=
h&&h.stop()};this.send=function(m){return new Promise(function(l,n){h="cpp"==getEnvInfo()?new cppHttpRequest:new webHttpRequest;if("number"===typeof m){var p;(null==(p=h)?0:p.xmlRequest)&&Reflect.has(h.xmlRequest,"timeout")&&Reflect.has(h.xmlRequest,"ontimeout")?(h.xmlRequest.timeout=m,h.xmlRequest.ontimeout=function(){NSDKLog.error("SZSE: (GHttpNetWork:send) timeout")}):NSDKLog.error("SZSE: (GHttpNetWork:send) set timeout error")}h.send(a,f,b,e,g).then(function(q){1!=q.status?n(q):l(q)})})}}
function gwebGHttp(){var a=this,b,f,g,e,h,m;this.setUrl=function(l){b=l};this.getUrl=function(){return b};this.setHeader=function(l,n){null==f&&(f={});f[l]=n};this.setType=function(l){g=l};this.setParam=function(l,n){null==e&&(e={});e[l]=n};this.setBody=function(l){h=l};this.getAllResponseHeaders=function(){if(null!=m)return m.getAllResponseHeaders()};this.getHttpStatus=function(){if(null!=m)return m.getHttpStatus()};this.getResponseHeader=function(l){if(null!=m)return m.getResponseHeader(l)};this.stop=
function(){null!=m&&m.stop()};this.send=function(){return new Promise(function(l,n){m="cpp"==getEnvInfo()?new cppHttpRequest:new webHttpRequest;m.send(b,g,f,h,e).then(function(p){1!=p.status&&200!=a.getHttpStatus()&&403!=a.getHttpStatus()?n(p):l(p)})})}}
var HttpRequest=function(){var a=this;this.xmlRequest;if(this.constructor==HttpRequest)throw Error("HttpRequest cannot be directly instantiated");this.getAllResponseHeaders=function(){return a.xmlRequest.getAllResponseHeaders()};this.getResponseHeader=function(b){return a.xmlRequest.getResponseHeader(b)};this.getHttpStatus=function(){return a.xmlRequest.status};this.send=function(b,f,g,e,h){return new Promise(function(m){if(null!=h){var l="",n;for(n in h)l+=encodeURIComponent(n)+"="+encodeURIComponent(h[n])+
"&";b+="?"+l.toString()}a.xmlRequest.open(f,b);for(var p in g)null!=g[p]&&a.xmlRequest.setRequestHeader(p,g[p]);l=function(){if(4==a.xmlRequest.readyState){var q={httpCode:a.xmlRequest.status},v=a.xmlRequest.responseText;try{var u=JSON.parse(v);Array.isArray(u)&&(u=u[0]);q=Object.assign(q,u)}catch(D){}NSDKLog.log("SZSE:(GHttpNetwork.stateChange)http\u63a5\u6536\u6570\u636e"+JSON.stringify(q));m(q)}};if(a.constructor==webHttpRequest)a.xmlRequest.onreadystatechange=l;else if(a.constructor==cppHttpRequest)a.xmlRequest.onreadystatechange(l);
null!=e?a.xmlRequest.send(e):a.constructor==cppHttpRequest?a.xmlRequest.send(""):a.xmlRequest.send()})};this.stop=function(){null!=a.xmlRequest&&a.xmlRequest.abort()}},webHttpRequest=function(){HttpRequest.call(this);this.xmlRequest=new XMLHttpRequest};$jscomp.inherits(webHttpRequest,HttpRequest);var cppHttpRequest=function(){HttpRequest.call(this);this.xmlRequest=new net.XMLHttpRequest};$jscomp.inherits(cppHttpRequest,HttpRequest);var ConnectState=Object.freeze({WAIT:1,CONNECTING:2,CONNECTED:4,CLOSE:8}),GQuoteWsBase=function(){var a=this;this.type="";this.webService=null;this.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0;this.closeConflict=!1;this.wsInfo=this.closeCallback=this.loginCallback=null;this.device_id_internal=this.device_type=this.sdk_version=this.wsUrl=this.token=this.userid=this.account="";this.serverList=null;this.connectType=ConnectState.WAIT;this._stopWsConnectWait=null;this.clearSocket=function(){a.webService&&
(a.webService.close(3999,"\u884c\u60c5\u8fde\u63a5\u6b63\u5e38\u5173\u95ed"),a.webService=null)};this.quoteLoginOut=function(b){null!=a.webService&&1==a.webService.socket.readyState&&a.webService.close(3999,"\u884c\u60c5\u8fde\u63a5\u6b63\u5e38\u5173\u95ed");a.closeCallback=b};this.onopen=function(b){null!=b&&GTenant.sharedInstance().getToken().then(function(f){a.token=f;a.connectType=ConnectState.CONNECTING;a.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0;f=JSON.stringify({type:"login",gid:{pg:"1",idx:"-1"},
account:a.account,userid:a.userid,token:a.token,device_type:a.device_type,sdk_version:a.sdk_version,device_id_internal:a.device_id_internal,protocol:1,sdk:1});a.webService.send(f)})};this.onmessage=function(b){a.reloadStatus>LOOP_CONNECT_STATUS.CONNECT0&&(a.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0);null!=b&&(b=JSON.parse(b),"login"==b.type?(a.serverList=null,a.connectType=ConnectState.CONNECTED,null!=a.loginCallback?(GSession.sharedInstance().setQuoteInstance(b.info),NSDKLog.info("SZSE:(GQuoteWsBase.onmessage)\u884c\u60c5\u8fde\u63a5\u6210\u529f:"+
GSession.sharedInstance().getCurrentConnectInfo()),a.loginCallback(!0),a.loginCallback=null):a.type==CONNECT_TYPE.WS_TYPE?(GSession.sharedInstance().setQuoteInstance(b.info),NSDKLog.info("SZSE:(GQuoteWsBase.onmessage)\u884c\u60c5\u91cd\u65b0\u8fde\u63a5\u6210\u529f:"+GSession.sharedInstance().getCurrentConnectInfo()),GSession.sharedInstance().pushMsg("\u884c\u60c5\u91cd\u65b0\u8fde\u63a5\u6210\u529f",STATU_CODE.MAINQUOTE_RECONNECT_SUCCESS)):NSDKLog.info("SZSE:(GQuoteWsBase.onmessage)\u81ea\u5b9a\u4e49\u884c\u60c5\u91cd\u8fde\u6210\u529f")):
"close"==b.type&&(a.closeConflict=!0))};this.onerror=function(b){NSDKLog.info("websocket error \u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u8fde\u63a5\u5931\u8d25:"+b)};this.handleCustomQuoteClose=function(b){if(null!=b)if(NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u81ea\u5b9a\u4e49\u884c\u60c5\u8fde\u63a5\u65ad\u5f00:"+JSON.stringify({errorCode:b.code,msg:b.reason})),a.connectType=ConnectState.CLOSE,1008==b.code&&(a.closeConflict=!0),a.closeConflict){var f=STATU_CODE.MAINQUOTE_CONN_CLOSED_BY_HOST,g="\u884c\u60c5\u670d\u52a1\u4e3b\u52a8\u65ad\u5f00\u4e0eSDK\u7684\u8fde\u63a5: "+
JSON.stringify(b.reason);try{var e=JSON.parse(b.reason).code;[1001001012,1001001013,1001001014].includes(e)&&(f=STATU_CODE.MAINQUOTE_KICK_EACH_OTHER,g="\u51fa\u73b0: "+JSON.stringify(b.reason))}catch(h){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u8fd4\u56de\u4fe1\u606f\u89e3\u6790\u5931\u8d25")}finally{NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u884c\u60c5\u670d\u52a1\u4e3b\u52a8\u65ad\u5f00\uff0c\u6e05\u7406\u72b6\u6001"),GSession.sharedInstance().pushMsg(g,f),a.closeConflict=!1}}else if(1011==b.code){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)1011\u9519\u8bef\uff0c\u81ea\u5b9a\u4e49\u884c\u60c5\u670d\u52a1 token \u6821\u9a8c\u5931\u8d25");
try{f=JSON.parse(b.reason),g=f.code}catch(h){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)1011\u9519\u8bef\uff0c\u81ea\u5b9a\u4e49\u884c\u60c5\u8fd4\u56de\u4fe1\u606f\u89e3\u6790\u5931\u8d25")}g&&5!=g&&1001001007!=g||NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u81ea\u5b9a\u4e49\u884c\u60c5Token\u9a8c\u8bc1\u5931\u8d25\u5207\u6362\u7ad9\u70b9");session.pushMsg("\u81ea\u5b9a\u4e49\u884c\u60c5\u8fde\u63a5\u65ad\u5f00\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",STATU_CODE.MAINQUOTE_RECONNECT_FAILED)}else 3999==b.code?
a.closeCallback(!0):3998==b.code?(a.closeConflict=!1,GSession.sharedInstance().pushMsg("\u81ea\u5b9a\u4e49\u884c\u60c5\u5237\u65b0Token\u5931\u8d25",STATU_CODE.MAINQUOTE_REFRESH_TOKEN_INVALID)):a.quoteClose({code:b.code,message:b.reason})};this.handleQuoteClose=function(b){if(null!=b)if(NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u884c\u60c5\u8fde\u63a5\u65ad\u5f00:"+JSON.stringify({errorCode:b.code,msg:b.reason})),a.connectType=ConnectState.CLOSE,1008==b.code&&(a.closeConflict=!0),a.closeConflict){var f=
STATU_CODE.MAINQUOTE_CONN_CLOSED_BY_HOST,g="\u884c\u60c5\u670d\u52a1\u4e3b\u52a8\u65ad\u5f00\u4e0eSDK\u7684\u8fde\u63a5: "+JSON.stringify(b.reason);try{var e=JSON.parse(b.reason).code;[1001001012,1001001013,1001001014].includes(e)&&(f=STATU_CODE.MAINQUOTE_KICK_EACH_OTHER,g="\u51fa\u73b0: "+JSON.stringify(b.reason))}catch(h){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u8fd4\u56de\u4fe1\u606f\u89e3\u6790\u5931\u8d25")}finally{NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u884c\u60c5\u670d\u52a1\u4e3b\u52a8\u65ad\u5f00\uff0c\u6e05\u7406\u72b6\u6001"),
GSession.sharedInstance().clearData(),GSession.sharedInstance().pushMsg(g,f),a.closeConflict=!1}}else if(1011==b.code){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)1011\u9519\u8bef\uff0c\u884c\u60c5\u670d\u52a1 token \u6821\u9a8c\u5931\u8d25");try{f=JSON.parse(b.reason),g=f.code}catch(h){NSDKLog.info("SZSE:(GQuoteWsBase.onclose)1011\u9519\u8bef\uff0c\u8fd4\u56de\u4fe1\u606f\u89e3\u6790\u5931\u8d25")}g&&5!=g&&1001001007!=g||(NSDKLog.info("SZSE:(GQuoteWsBase.onclose)\u884c\u60c5Token\u9a8c\u8bc1\u5931\u8d25\u5207\u6362\u7ad9\u70b9"),
GSession.sharedInstance().clearData(!1,!1),b=GSession.sharedInstance().getHttpUrl(),GSession.sharedInstance().changeHostLogin(b))}else 3998==b.code?(a.closeConflict=!1,GSession.sharedInstance().clearData(),GSession.sharedInstance().pushMsg("\u5237\u65b0Token\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",STATU_CODE.MAINQUOTE_REFRESH_TOKEN_INVALID)):3999==b.code?a.closeCallback(!0):a.quoteClose({code:b.code,message:b.reason})};this.onclose=function(b){return $jscomp.asyncExecutePromiseGeneratorProgram(function(f){a.type==
CONNECT_TYPE.CUSTOM_WS_TYPE?a.handleCustomQuoteClose(b):a.handleQuoteClose(b);f.jumpToEnd()})};this.setUserData=function(b,f,g){a.account=b;a.userid=f;a.token=g};this.clear=function(){NSDKLog.info("SZSE:(GQuoteWsBase: clear)\u6267\u884c\u6570\u636e\u6e05\u7a7a");var b;(null==(b=a.webService)?0:b.heartbeat)&&a.webService.heartbeat.stopHeartBeat();a.wsInfo=new ConnectInfo(a.type);a.serverList=null;a.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0}};
GQuoteWsBase.prototype.quoteLogin=function(a,b){var f=this,g,e,h,m,l,n,p,q;return $jscomp.asyncExecutePromiseGeneratorProgram(function(v){if(!f.connectType&(ConnectState.CLOSE|ConnectState.WAIT))return v.return();g=a;e=g.account;h=g.user_id;m=g.token;l=g.device_type;n=g.sdk_version;p=g.device_id_internal;f.account=e;f.token=m;f.userid=h;f.device_type=l;f.sdk_version=n;f.device_id_internal=p;(null==(q=f.webService)?0:q.heartbeat)&&f.webService.heartbeat.stopHeartBeat();f.webService&&f.clearSocket();
f.webService=new WebsocketServer(f.wsUrl);f.webService.set_onOpen(f.onopen);f.webService.set_onMessage(f.onmessage);f.webService.set_onClose(f.onclose);f.webService.set_onError(f.onerror);f.webService.set_activeCloseQuote(f.quoteClose.bind(f));"undefined"!=typeof mainWebServer&&f.type==CONNECT_TYPE.WS_TYPE&&(mainWebServer=f.webService);f.webService.connect();f.loginCallback=b;GWsManagers.sharedInstance().addConnect(f.type,f.webService);v.jumpToEnd()})};
GQuoteWsBase.prototype.executeAfterWaiting=function(a){a=void 0===a?10:a;var b=null,f=null,g=new Promise(function(e){b=e;f=setTimeout(function(){e()},1E3*a)});return{stopWait:function(){f&&clearTimeout(f);b&&b();g=b=f=null},waitPromise:g}};
GQuoteWsBase.prototype.quoteClose=function(){var a=this,b,f,g,e,h,m,l;return $jscomp.asyncExecutePromiseGeneratorProgram(function(n){switch(n.nextAddress){case 1:a.wsInfo.loop=a.reloadStatus;b=GSession.sharedInstance();a.reloadStatus==LOOP_CONNECT_STATUS.CONNECT0&&a.wsInfo.nextStatus!==NEXT_STATUS.GETNEW_STATUS&&a.type==CONNECT_TYPE.WS_TYPE&&(b.pushMsg("\u884c\u60c5\u8fde\u63a5\u65ad\u5f00\uff0c\u6b63\u5728\u5c1d\u8bd5\u91cd\u8fde",STATU_CODE.MAINQUOTE_DISCONNECT_ABNORMAL),NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u5f02\u5e38\u65ad\u7ebf\u91cd\u8fde"));
if(a.reloadStatus>=LOOP_CONNECT_STATUS.CONNECT3){if(null!==a.serverList){n.jumpTo(5);break}f=a;return n.yield(b.getServerList(),6)}return n.yield(new Promise(function(p){return setTimeout(p,50)}),4);case 4:a.reloadStatus<<=1;a.type==CONNECT_TYPE.WS_TYPE?NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u5f53\u524d\u6b63\u5728\u91cd\u8fde\u884c\u60c5,\u7b2c"+Math.log2(a.reloadStatus)+"\u6b21"):NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u5f53\u524d\u6b63\u5728\u91cd\u8fde\u81ea\u5b9a\u4e49\u884c\u60c5,\u7b2c"+
Math.log2(a.reloadStatus)+"\u6b21");a.webService.connect();n.jumpTo(0);break;case 6:f.serverList=n.yieldResult;case 5:if(0!==a.serverList.length){n.jumpTo(7);break}a.serverList=null;g=a.executeAfterWaiting(10);e=g.waitPromise;h=g.stopWait;a._stopWsConnectWait=h;return n.yield(e,8);case 8:return a.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0,a.webService.connect(),n.return();case 7:m=a.type==CONNECT_TYPE.WS_TYPE?DOMAIN_TYPE.WS:DOMAIN_TYPE.CUSTOM_WS,l=b.getRandomServer(a.serverList,m),null==l?a.loginCallback?
(a.loginCallback(!1),a.loginCallback=null):a.type==CONNECT_TYPE.WS_TYPE?(NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u884c\u60c5\u91cd\u65b0\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),b.clearData(),b.pushMsg("\u884c\u60c5\u8fde\u63a5\u65ad\u5f00\u4e14\u81ea\u52a8\u91cd\u8fde\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",STATU_CODE.MAINQUOTE_RECONNECT_FAILED)):NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u81ea\u5b9a\u4e49\u884c\u60c5\u91cd\u65b0\u8fde\u63a5\u5931\u8d25"):(l.use=
!0,a.wsInfo.server=l,a.setUrl(l.domain),a.webService.setUrl(a.wsUrl),NSDKLog.info("SZSE:(GQuoteWsBase.quoteClose)\u8bbe\u7f6e WS \u670d\u52a1\u94fe\u63a5\u5730\u5740"),a.wsInfo.nextStatus=NEXT_STATUS.GETNEW_STATUS,a.reloadStatus=LOOP_CONNECT_STATUS.CONNECT0,a.quoteClose()),n.jumpToEnd()}})};GQuoteWsBase.prototype.setToken=function(a,b,f){var g={type:"setToken",gid:{pg:"1",idx:"-1"},account:"",userid:"",token:""};g.account=a;g.userid=b;g.token=f;a=JSON.stringify(g);null!=this.webService&&this.webService.send(a)};
GQuoteWsBase.prototype.stopWsConnectWait=function(){NSDKLog.info("SZSE:(GQuoteWsBase.stopWaitWsConnect)\uff1a\u505c\u6b62 ws \u91cd\u65b0\u8fde\u63a5\u7684 10s \u7b49\u5f85");this._stopWsConnectWait&&this._stopWsConnectWait()};GQuoteWsBase.prototype.setUrl=function(){};function GWsManagers(){var a={};this.addConnect=function(b,f){a[b]=f};this.getWsWithType=function(b){if(null!=a[b])return a[b]};this.getAllConnect=function(){return a};this.delWsWithType=function(b){null!=a[b]&&delete a[b]};this.delAllConnect=function(){a={}}}GWsManagers.sharedInstance=function(){null==this.instance&&(this.instance=new GWsManagers);return this.instance};var GCustomQuoteWs=function(){GQuoteWsBase.call(this);this.type=CONNECT_TYPE.CUSTOM_WS_TYPE;this.wsInfo=new ConnectInfo(CONNECT_TYPE.CUSTOM_WS_TYPE)};$jscomp.inherits(GCustomQuoteWs,GQuoteWsBase);GCustomQuoteWs.prototype.setUrl=function(a){NSDKLog.log("SZSE:(GCustomQuoteWs)\u8bbe\u7f6e\u81ea\u5b9a\u4e49WS\u670d\u52a1\u8fde\u63a5\u5730\u5740: "+a+" ");this.wsUrl=a+"/tenantquote"};GCustomQuoteWs.sharedInstance=function(){null==this.instance&&(this.instance=new GCustomQuoteWs);return this.instance};var GQuoteWs=function(){GQuoteWsBase.call(this);this.type=CONNECT_TYPE.WS_TYPE;this.wsInfo=new ConnectInfo(CONNECT_TYPE.WS_TYPE)};$jscomp.inherits(GQuoteWs,GQuoteWsBase);GQuoteWs.prototype.setUrl=function(a){NSDKLog.info("SZSE:(GquoteWs.setUrl)\u8bbe\u7f6eWS\u670d\u52a1\u8fde\u63a5\u5730\u5740: "+a+" ");this.wsUrl=a+"/quote"};GQuoteWs.sharedInstance=function(){null==this.instance&&(this.instance=new GQuoteWs);return this.instance};function GService(){}GService.Path={tenantLogin:"signthirdparty/login/tenantLogin",refreshToken:"signauth/v2/oauth/token",tenantLoginOut:"auth/oauth/logout",siteList:"gateway/site/list"};
GService.tenantLoginApi=function(a,b,f){return new Promise(function(g,e){var h=new GHttp,m=GSession.sharedInstance().getHttpUrl()+GService.Path.tenantLogin;h.setUrl(m);h.setBody(a);h.setType("post");h.setHeader("Content-Type","application/json");for(var l in b)h.setParam(l,b[l]);NSDKLog.info("SZSE:(GService.tenantLoginApi)\u5f00\u59cb\u767b\u5f55\u5e73\u53f0\u670d\u52a1:"+m);h.send(f).then(function(n){NSDKLog.log("SZSE:(GService.tenantLoginApi)resHeader:",h.getAllResponseHeaders());var p=h.getResponseHeader("domain_identifier");
n=getTableForMap(n.result[0].table);var q={},v;for(v in n)q[v]=n[v].value;q=Object.assign(q,{domain:p});g(q)}).catch(function(n){e(n)})})};GService.tenantLoginOutApi=function(a,b){return new Promise(function(f,g){f({msg:"\u64cd\u4f5c\u6210\u529f\uff01",status:!0})})};
GService.refreshTokenApi=function(a,b){var f,g;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(GSession.sharedInstance().getSignModel(),2);f=e.yieldResult;g=new Promise(function(h,m){var l={grant_type:"refresh_token",refresh_token:a,device_id:b},n=GSession.sharedInstance().getHttpUrl()+GService.Path.refreshToken;f=Object.assign({},f,l);l=new GHttp;for(var p in f)l.setParam(p,f[p]);l.setUrl(n);l.setType("post");l.setHeader("Content-Type","application/x-www-form-urlencoded");
l.send().then(function(q){h(q.result)}).catch(function(q){200==q.httpCode&&q.access_token?h(q):m()})});return e.return(g)})};
GService.siteList=function(a,b){return new Promise(function(f,g){var e=new GHttp,h=a+GService.Path.siteList,m=[{lang:"zh-cn",gid:{fm:"site"},http:[{gid:{name:"site"},type:"query",field:["code","type","domain","state","ip"]}]}];m=JSON.stringify(m);e.setUrl(h);e.setBody(m);e.setType("post");e.setHeader("Content-Type","application/json");e.send(b).then(function(l){console.log(l);1==l.status?f(l):g(l)}).catch(function(l){g(l)})})};var LOOP_CONNECT_STATUS=Object.freeze({CONNECT0:1,CONNECT1:2,CONNECT2:4,CONNECT3:8,CONNECT4:16,CONNECT5:32}),CONNECT_TYPE=Object.freeze({HTTP_TYPE:2,WS_TYPE:4,CUSTOM_HTTP_TYPE:8,CUSTOM_WS_TYPE:16}),NEXT_STATUS=Object.freeze({DEGAULT_STATUS:1,CONTINUE_STATUS:2,GETNEW_STATUS:4,END_STATUS:8,OK_STATUS:16});
function GSession(){function a(z){z=Object.assign(z,{account:String(z.user_id)});GQuoteWs.sharedInstance().quoteLogin(z,function(y){var B,t,G,x;return $jscomp.asyncExecutePromiseGeneratorProgram(function(J){q=0;if(1==y){NSDKLog.info("SZSE:(GSession.quoteLogin)\u767b\u5f55\u6210\u529f\u884c\u60c5\u5f00\u542f");NSDK.getConnect().status=1;B=NSDK.getAllRequestItems();t=$jscomp.makeIterator(B);for(G=t.next();!G.done;G=t.next())x=G.value,x.request();GRequestManager.sharedInstance().addMarketMsgMoniter();
g.pushMsg("\u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u6210\u529f",STATU_CODE.MAINQUOTE_CONNECT_SUCCESS)}else g.pushMsg("\u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u5931\u8d25\uff1a\u884c\u60c5\u767b\u5f55\u5931\u8d25",STATU_CODE.MAINQUOTE_CONNECT_FAILED),g.clearData();J.jumpToEnd()})})}function b(z){return $jscomp.asyncExecutePromiseGeneratorProgram(function(y){return 1==y.nextAddress?(NSDKLog.info("SZSE:(GSession.httpLogin)\u5f00\u59cb\u6267\u884c\u79df\u6237\u767b\u5f55\u6d41\u7a0b"),p=z,y.yield(GTenant.sharedInstance().login(z).then(function(B){NSDKLog.info("SZSE:(GSession.httpLogin)\u79df\u6237\u767b\u5f55\u6210\u529f");
NSDK.getConnect().auth=1;B.domain?g.setHttpUrl(v?"https://"+B.domain:"http://"+B.domain):NSDKLog.info("SZSE:(GSession.httpLogin)\u767b\u5f55\u8fd4\u56dedomain\u4e0d\u5b58\u5728,\u8fd4\u56de\u7ed3\u679c\u5f02\u5e38");var t=B.user_id,G=B.access_token;NSDKLog.info("SZSE:(GSession.httpLogin)\u5e73\u53f0\u767b\u5f55\u7ed3\u679c:"+JSON.stringify({userid:t,httpUrl:e}));"undefined"!=typeof window&&(window.localStorage.setItem("G_access_token",G),window.localStorage.setItem("G_userid",t),window.localStorage.setItem("G_localHttp",
e),"undefined"!=typeof httpGatWay&&(httpGatWay=e));return B}).catch(function(B){return $jscomp.asyncExecutePromiseGeneratorProgram(function(t){400===B.httpCode?g.pushMsg("\u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u5931\u8d25: \u5e73\u53f0\u8ba4\u8bc1\u5931\u8d25",STATU_CODE.MAINQUOTE_CONNECT_SIGN_FAILED):g.pushMsg("\u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u5931\u8d25: \u5e73\u53f0\u767b\u5f55\u5931\u8d25\uff1a"+JSON.stringify({errorCode:B.code,msg:B.msg}),STATU_CODE.MAINQUOTE_CONNECT_FAILED);return t.return(null)})}),
2)):y.return(y.yieldResult)})}var f=this,g=this,e,h,m,l,n=[],p,q=0,v=!1===GSession.isUseSSL?!1:!0,u=!1,D,F=[MAINQUOTE_CONNECT_FAILED,MAINQUOTE_RECONNECT_FAILED,HTTPLOGIN_CHANGE_WEBSITE_FAILED,SERVER_ERROR,MAINQUOTE_REFRESH_TOKEN_INVALID];this.setConnectedFlag=function(z){u=z};this.getConnectedFlag=function(){return u};this.setQuoteInstance=function(z){D=z};this.getQuoteInstance=function(){return D};this.setHostModel=function(z){z=JSON.parse(JSON.stringify(z));h=z.httpHostName;m=z.wsHostName;l=z.customWsHostName;
n=z.siteList;if(v=!1===GSession.isUseSSL?!1:!0)for(h="https://"+h,m="wss://"+m,l="wss://"+l,z=0;z<n.length;z++)n[z].siteUrl="https://"+n[z].siteUrl;else for(h="http://"+h,m="ws://"+m,l="ws://"+l,z=0;z<n.length;z++)n[z].siteUrl="http://"+n[z].siteUrl;"undefined"!=typeof window&&(h=localStorage.getItem("httpHost")||h,m=localStorage.getItem("wsHost")||m,l=localStorage.getItem("customWsHost")||l);GQuoteWs.sharedInstance().setUrl(m);GCustomQuoteWs.sharedInstance().setUrl(l);f.setHttpUrl(h)};this.getSiteList=
function(){return n};this.customQuoteLogin=function(){var z=[],y=[];return function(){return new Promise(function(B,t){if(GCustomQuoteWs.sharedInstance().connectType==ConnectState.CONNECTED)B();else{var G=GTenant.sharedInstance().getUserData();G.userid=G.user_id;G.token=G.access_token;G.account=""+G.userid;GCustomQuoteWs.sharedInstance().quoteLogin(G,function(x){1==x?(NSDKLog.log("SZSE:(GSession.customQuoteLogin)\u81ea\u5b9a\u4e49\u884c\u60c5\u5df2\u5f00\u542f"),z.forEach(function(J){J()})):(NSDKLog.log("SZSE:(GSession.customQuoteLogin)\u81ea\u5b9a\u4e49\u884c\u60c5\u767b\u5f55\u5931\u8d25"),
y.forEach(function(J){J()}));z=[];y=[]});z.push(B);y.push(t)}})}}();this.getSiteListModel=function(z){for(var y=0;y<z.length;y++){var B=z[y];if(0==B.use)return B}};this.getSignModel=function(){var z,y;return $jscomp.asyncExecutePromiseGeneratorProgram(function(B){return 1==B.nextAddress?(z=NSDK.getSignFunction()(),!0!==z instanceof Promise?(!0===z instanceof Object&&(y=z),B.jumpTo(2)):B.yield(z.then(function(t){y=t}).catch(function(t){console.error(t)}),2)):B.return(y)})};this.changeHostLogin=function(){var z=
this,y,B,t,G,x;return $jscomp.asyncExecutePromiseGeneratorProgram(function(J){if(1==J.nextAddress)return y=z.getHttpUrl(),J.yield(z.getServerList(),2);B=J.yieldResult;t=y.replace("/application/","");for(G={$jscomp$loop$prop$i$237:0};G.$jscomp$loop$prop$i$237<B.length;G={$jscomp$loop$prop$i$237:G.$jscomp$loop$prop$i$237},G.$jscomp$loop$prop$i$237++)if(B[G.$jscomp$loop$prop$i$237].type===DOMAIN_TYPE.HTTP&&B[G.$jscomp$loop$prop$i$237].domain!==t)return z.setHttpUrl(B[G.$jscomp$loop$prop$i$237].domain),
(x=B.find(function(A){return function(H){return H.siteId===B[A.$jscomp$loop$prop$i$237].siteId&&H.type===DOMAIN_TYPE.WS}}(G)))&&x.domain&&(x.use=!0,GQuoteWs.sharedInstance().setUrl(x.domain)),NSDKLog.info("SZSE:(GSession.changeHostLogin)\u5207\u6362HTTP\u8fde\u63a5\u7ad9\u70b9"),z.login(p,!0),J.return();z.pushMsg("\u884c\u60c5\u670d\u52a1\u65e0\u6cd5\u6821\u9a8ctoken\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",STATU_CODE.HTTPLOGIN_CHANGE_WEBSITE_FAILED);NSDKLog.info("SZSE:(GSession.changeHostLogin)\u5207\u6362\u7ad9\u70b9\u5931\u8d25");
J.jumpToEnd()})};this.pushNotification=function(z){return $jscomp.asyncExecutePromiseGeneratorProgram(function(y){if(1==y.nextAddress)return null==NSDK.getNotification()?y.jumpTo(0):0<=F.indexOf(z.code)?y.yield(new Promise(function(B){setTimeout(B,1E3*(Math.floor(4*Math.random())+1))}),3):y.jumpTo(3);NSDK.getNotification()(z);y.jumpToEnd()})};this.pushJsonMsg=function(z){try{var y=JSON.parse(z),B=y.message,t=y.code;"object"===typeof B&&(B=JSON.stringify(B));g.pushMsg(B,t)}catch(G){"object"==typeof z?
NSDKLog.log("SZSE:(GSession.pushJsonMsg) JSON.parse\u9519\u8bef: "+JSON.stringify(z)):NSDKLog.log("SZSE:(GSession.pushJsonMsg) JSON.parse\u9519\u8bef: "+z)}};this.pushMsg=function(z,y){var B=new GMessage;B.message=z;B.code=y;NSDKLog.info("SZSE:(GSession.pushMsg)\u63a8\u9001\u4fe1\u606f"+JSON.stringify(B));g.pushNotification(B)};this.login=function(z,y){y=void 0===y?!1:y;q++;3<q?(g.pushMsg("\u884c\u60c5\u670d\u52a1\u5f02\u5e38\uff0c\u8bf7\u91cd\u65b0\u8fde\u63a5",STATU_CODE.SERVER_ERROR),q=0):(y||
GEnvConfig.setEnvType(GSession.envType),NSDKLog.info("SZSE:(GSession.login)\u8bbe\u5907id:"+z.deviceId),NSDKLog.info("SZSE:(GSession.login)\u5f00\u59cb\u6267\u884c\u767b\u5f55\u6d41\u7a0b"),z.deviceType=getDeviceType(),b(z).then(function(B){B?(B.device_id=z.deviceId,B.device_type=getDeviceType(),B.sdk_version=NSDK.getSDKVersion().version,B.device_id_internal=checkDeviceIdInternal(),a(B)):(NSDKLog.info("SZSE:(GSession.login)\u5e73\u53f0\u670d\u52a1\u767b\u5f55\u5931\u8d25"),g.clearData())}))};this.reHttpLogin=
function(){f.setHttpUrl(h);return new Promise(function(z,y){b(p).then(function(B){if(null!=B){NSDKLog.info("SZSE:(GSession.reHttpLogin)\u91cd\u65b0\u767b\u5f55\u6210\u529f");var t=B.user_id;B=B.access_token;GQuoteWs.sharedInstance().setToken(t,t,B);GCustomQuoteWs.sharedInstance().setToken(t,t,B);z(!0)}else y(!1)})})};this.getRandomServer=function(z,y){for(var B=[],t=0;t<z.length;t++){var G=z[t];!1===G.use&&G.type==y&&B.push(G)}return 0<B.length?B[Math.floor(Math.random()*B.length)]:null};this.getServerList=
function(z){z=void 0===z?3E3:z;var y=[],B=JSON.parse(JSON.stringify(n));return new Promise(function(t){function G(J){GService.siteList(J,z).then(function(A){A=ResModel.initWithData(A);for(var H=0;H<A.body.length;H++){var I=ServerModel.initWithData(A.body[H]);if(I.type==DOMAIN_TYPE.HTTP)I.domain=v?"https://"+I.domain:"http://"+I.domain;else if(I.type==DOMAIN_TYPE.WS||I.type==DOMAIN_TYPE.CUSTOM_WS)I.domain=v?"wss://"+I.domain:"ws://"+I.domain;y.push(I)}t(y)}).catch(function(A){console.log(A);x()})}
function x(){var J=GSession.sharedInstance().getSiteListModel(B);null==J?t(y):(J.use=!0,G(J.siteUrl))}x()})};this.loginOut=function(){GTenant.sharedInstance().loginOut().then(function(z){return z}).then(function(z){g.clearData(!0);GQuoteWs.sharedInstance().quoteLoginOut(function(y){var B=new GMessage;1==y?(B.message="\u65ad\u5f00\u884c\u60c5\u8fde\u63a5\u6210\u529f",B.code=STATU_CODE.MAINQUOTE_DISCONNECT_NORMAL,NSDKLog.info("SZSE:(GSession.loginOut)\u4e3b\u884c\u60c5\u8fde\u63a5\u6b63\u5e38\u5173\u95ed")):
(B.message="\u65ad\u5f00\u884c\u60c5\u8fde\u63a5\u5931\u8d25",B.code=STATU_CODE.MAINQUOTE_DISCONNECT_FAILED);g.pushNotification(B)});GQuoteWs.sharedInstance().clearSocket();GCustomQuoteWs.sharedInstance().quoteLoginOut(function(y){1==y?NSDKLog.info("SZSE:(GSession.loginOut)\u81ea\u5b9a\u4e49\u884c\u60c5\u8fde\u63a5\u6b63\u5e38\u5173\u95ed"):NSDKLog.info("SZSE:(GSession.loginOut)\u81ea\u5b9a\u4e49\u884c\u60c5\u5173\u95ed\u8fde\u63a5\u5931\u8d25")})}).catch(function(z){console.log(z);g.pushJsonMsg(z.message)})};
this.clearData=function(z,y){z=void 0===z?!1:z;y=void 0===y?!0:y;NSDK.getConnect().clearStatus();g.setConnectedFlag(!1);g.clearUrl();g.setQuoteInstance(null);z&&NSDK.clearAllRequestItems();y&&(q=0);GTenant.sharedInstance().clearUserData();GWsManagers.sharedInstance().delAllConnect();GQuoteWs.sharedInstance().clear();GCustomQuoteWs.sharedInstance().clear();GRequestManager.sharedInstance().clearMarketMsgQuote()};this.setProxyApi=function(){};this.setHttpUrl=function(z){NSDKLog.info("SZSE:(GSession.setHttpUrl)\u8bbe\u7f6eHTTP\u670d\u52a1\u8fde\u63a5\u5730\u5740: "+
z+" ");e=z+"/application/"};this.getHttpUrl=function(){return e};this.getWsHostName=function(){return m};this.setWsHostName=function(z){m=z};this.setCurrentServerList=function(z){currentServerList=[].concat($jscomp.arrayFromIterable(z))};this.clearUrl=function(){e=null};this.getCurrentConnectInfo=function(){var z=GTenant.sharedInstance().getUserData().user_id,y;return JSON.stringify({time:Date.now(),userId:z,platform:e,quote:null==(y=mainWebServer)?void 0:y.getUrl(),quoteInstance:this.getQuoteInstance()})}}
var ConnectInfo=function(a){this.type=a;this.loop=LOOP_CONNECT_STATUS.CONNECT0;this.server=null;this.nextStatus=NEXT_STATUS.DEGAULT_STATUS},ServerModel=function(a){this.siteId=this.domain=this.code=null;this.type=a;this.identifier=this.ip=null;this.use=!1};ServerModel.initWithData=function(a){var b=new ServerModel;Reflect.ownKeys(b).forEach(function(f){!0===Reflect.has(a,f)&&(b[f]=a[f])});return b};var ResModel=function(){this.body=this.status=this.msg=this.code=null};
ResModel.initWithData=function(a){var b=new ResModel;Reflect.ownKeys(b).forEach(function(f){!0===Reflect.has(a,f)&&(b[f]=a[f])});return b};var GHostModel=function(){this.customWsHostName=this.wsHostName=this.httpHostName=null;this.siteList=[]};GHostModel.initWithData=function(a){var b=new GHostModel;Reflect.ownKeys(b).forEach(function(f){if(!0===Reflect.has(a,f)){var g=a[f];if("siteList"===f)for(var e=0;e<g.length;e++){var h=GSiteModel.initWithData(g[e]);b[f].push(h)}else b[f]=g}});return b};
var GSiteModel=function(){this.use=this.siteUrl=null};GSiteModel.initWithData=function(a){var b=new GSiteModel;Reflect.ownKeys(b).forEach(function(f){!0===Reflect.has(a,f)&&(b[f]=a[f])});return b};GSession.sharedInstance=function(){null==this.instance&&(this.instance=new GSession);return this.instance};
var NSDK_HOOK=function(){var a={start:function(){a.setOnNotification();a.setOnCallback();a.setOnRealLog();a.setOnSignCallback()},setOnSignCallback:function(){"undefined"!=typeof net&&"undefined"!=net.sdk_cpp_sign_callback?a.onSignCallback=net.sdk_cpp_sign_callback:"undefined"!=typeof sdk_java_sign_callback?a.onSignCallback=sdk_java_sign_callback:"undefined"!=typeof sdk_oc_sign_callback&&(a.onSignCallback=sdk_oc_sign_callback);NSDK.setSignCallback(a.onSignCallback)},setOnNotification:function(){"undefined"!=
typeof sdk_cpp_notification?a.onNotification=sdk_cpp_notification:"undefined"!=typeof sdk_java_notification?a.onNotification=sdk_java_notification:"undefined"!=typeof sdk_oc_notification&&(a.onNotification=sdk_oc_notification);NSDK.setNotificationCallback(a.onNotification)},setOnRealLog:function(){"undefined"!=typeof sdk_cpp_log?a.onRealLog=sdk_cpp_log:"undefined"!=typeof sdk_java_log?a.onRealLog=sdk_java_log:"undefined"!=typeof sdk_oc_log&&(a.onRealLog=sdk_oc_log);NSDK.setRealLogCallback(a.onRealLog)},
setOnCallback:function(){"undefined"!=typeof sdk_cpp_callback?a.onCallback=sdk_cpp_callback:"undefined"!=typeof sdk_java_callback?a.onCallback=sdk_java_callback:"undefined"!=typeof sdk_oc_callback&&(a.onCallback=sdk_oc_callback)},getOnCallback:function(){return a.onCallback},getOnNotification:function(){return a.onNotification},getOnRealLog:function(){return a.onRealLog},getOnSignCallback:function(){return a.onSignCallback}};return a}();function GTenant(){var a=this,b,f,g,e=function(h){g=(new Date).getTime()+1E3*(parseInt(h.expires_in)-180);b=h;h=null!=b.userid?b.userid:b.user_id;var m=null!=b.accesstoken?b.accesstoken:b.access_token;"undefined"!=typeof window&&(window.localStorage.setItem("G_access_token",m),window.localStorage.setItem("G_userid",h))};this.login=function(h){var m=new ConnectInfo(CONNECT_TYPE.HTTP_TYPE),l=null,n=GSession.sharedInstance();return new Promise(function(p,q){function v(){var B,t;return $jscomp.asyncExecutePromiseGeneratorProgram(function(G){if(1==
G.nextAddress)return NSDKLog.info("SZSE:(GTenant.login)\u5f00\u59cb\u767b\u5f55"),G.yield(GSession.sharedInstance().getSignModel(),2);B=G.yieldResult;t=Object.assign(B,D);GService.tenantLoginApi(y,t,1E4).then(function(x){e(x);f=h;a.resetRefreshTokenTimer(x);NSDKLog.info("SZSE:(GTenant.login)\u767b\u5f55\u6210\u529f: "+JSON.stringify(x));p(x)}).catch(function(x){var J,A;return $jscomp.asyncExecutePromiseGeneratorProgram(function(H){switch(H.nextAddress){case 1:return NSDKLog.info("SZSE:(GTenant.login)\u5e73\u53f0\u767b\u5f55\u5931\u8d25:"+
JSON.stringify({errorCode:x.httpCode,msg:x.msg})),J=x.httpCode,[503,502,504,500,404,0].includes(J)?H.yield(new Promise(function(I){setTimeout(I,50)}),2):(NSDKLog.error("SZSE:(GTenant.login)\u767b\u5f55\u5931\u8d25: "+x.msg),q(x),H.return());case 2:m.loop<<=1;if(m.loop<=LOOP_CONNECT_STATUS.CONNECT3){NSDKLog.info("SZSE:(GTenant.login)\u5e73\u53f0\u767b\u5f55\u91cd\u8bd5: \u7b2c"+Math.log2(m.loop)+"\u6b21");v();H.jumpTo(0);break}if(null!==l){H.jumpTo(4);break}return H.yield(n.getServerList(1E4),5);case 5:l=
H.yieldResult,n.setCurrentServerList(l);case 4:A=n.getRandomServer(l,DOMAIN_TYPE.HTTP),null!==A?(A.use=!0,m.server=A,m.loop=LOOP_CONNECT_STATUS.CONNECT1,m.nextStatus=NEXT_STATUS.CONTINUE_STATUS,NSDKLog.info("SZSE:(GTenant.login)\u5207\u6362HTTP\u8fde\u63a5\u7ad9\u70b9"),n.setHttpUrl(A.domain),v()):q(x),H.jumpToEnd()}})});G.jumpToEnd()})}var u=[],D={};for(F in h)if(null!=h[F])switch(F.toLowerCase()){case "scope":D.scope=h[F];break;case "refresh_authority":D.refresh_authority=h[F];break;default:u.push(F+
" = '"+h[F]+"'")}var F="";for(var z=0;z<u.length;z++)F=0==z?u[z]:F+(" and "+u[z]);F=GAnalysisES(F);var y=[{lang:"zh-cn",gid:{fm:"tenant"},http:[{gid:{name:"tenantCheck"},type:"query",field:"access_token token_type refresh_token expires_in tenantid deviceType clientid tenant_code user_id host_identifier".split(" "),condition:F.esCondition}]}];y=JSON.stringify(y);v()})};this.loginOut=function(h){var m;return $jscomp.asyncExecutePromiseGeneratorProgram(function(l){if(1==l.nextAddress)return l.yield(GService.tenantLoginOutApi().then(function(n){a.clearUserData();
a.clearTimer();return n}).catch(function(n){console.log(n);throw Error(n.message);}),2);m=l.yieldResult;return l.return(m)})};this.getUserData=function(){return b};this.getUserArguments=function(){return f};this.getBasic=function(){return"R2FuZ3Rpc2UtU0RLOmdhbmd0aXNl"};this.getToken=function(){return new Promise(function(h,m){m=(new Date).getTime();var l=b.access_token;m<g?h(l):(m=b.refresh_token,l=a.getUserArguments().deviceId,GService.refreshTokenApi(m,l).then(function(n){console.log(getNowSaftTime()+
" \u5237\u65b0Token\u6210\u529f!");e(n);a.resetRefreshTokenTimer(n);h(n.access_token)}).catch(function(n){NSDKLog.info("SZSE:(GTenant.getToken)\u5237\u65b0Token\u5931\u8d25");GQuoteWs.sharedInstance().webService.close(3998,"\u5237\u65b0Token\u5931\u8d25")}))})};this.refreshToken=function(h){GService.refreshTokenApi(h.refresh_token,h.device_id).then(function(m){console.log(getNowSaftTime()+"    \u5237\u65b0Token\u6210\u529f!");e(m);var l=null!=m.userid?m.userid:m.user_id,n=null!=m.accesstoken?m.accesstoken:
m.access_token,p=""+l;GQuoteWs.sharedInstance().setUserData(p,l,n);GQuoteWs.sharedInstance().setToken(p,l,n);a.resetRefreshTokenTimer(m)}).catch(function(m){NSDKLog.info("SZSE:(GTenant.refreshToken)\u5237\u65b0token\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55");GQuoteWs.sharedInstance().webService.close(3998,"\u5237\u65b0Token\u5931\u8d25")})};this.resetRefreshTokenTimer=function(h){var m=1E3*h.expires_in+Date.now();a.clearTimer();a.refreshTokenTimer&&clearInterval(a.refreshTokenTimer);a.refreshTokenTimer=
setInterval(function(){18E4>m-Date.now()&&(a.refreshToken(h),clearInterval(a.refreshTokenTimer),a.refreshTokenTimer=null)},5E3)};this.clearTimer=function(){null!=a.refreshTokenTimer&&clearInterval(a.refreshTokenTimer)};this.clearUserData=function(){f=b=null;a.clearTimer()}}GTenant.sharedInstance=function(){null==this.instance&&(this.instance=new GTenant);return this.instance};var GEnvConfig=function(){};GEnvConfig.readConfig=function(a){var b=Object.keys(a);GEnvConfig.configData={};b.forEach(function(f){var g=GHostModel.initWithData(a[f]);GEnvConfig.configData[f]=g})};GEnvConfig.setEnvType=function(a){a=GEnvConfig.configData[a];null==a?console.log("\u672a\u67e5\u8be2\u5230\u8be5\u73af\u5883\u7684\u914d\u7f6e\u4fe1\u606f!"):GSession.sharedInstance().setHostModel(a)};
GEnvConfig.addEnvType=function(a){a=void 0===a?[]:a;if(0!==NSDK.getConnect().status)console.log("\u53ea\u80fd\u5728\u672a\u8fde\u63a5\u72b6\u6001\u4fee\u6539\u73af\u5883\u5217\u8868");else{var b=[],f;for(f in ENV_TYPE)b.push(ENV_TYPE[f]);"Array"===Object.prototype.toString.call(a).slice(8,-1)&&(a.forEach(function(g){var e=g.name,h=g.httpHostName,m=g.wsHostName,l=g.customWsHostName;g=g.siteList;if(e&&0>b.indexOf(e)&&h&&m&&l&&g){var n=[];"Array"===Object.prototype.toString.call(g).slice(8,-1)&&g.forEach(function(p){"string"===
typeof p&&0<p.length&&n.push({siteUrl:p,use:!1})});GEnvConfig.envTypeNameList.add(e);GEnvConfig.config[e]={httpHostName:h,wsHostName:m,customWsHostName:l,siteList:n}}}),GEnvConfig.readConfig(GEnvConfig.config))}};var DOMAIN_TYPE=Object.freeze({HTTP:3,WS:4,CUSTOM_WS:5}),ENV_TYPE=Object.freeze({SZSE_PRODUCTION:"szse_pro",SZSE_SIM:"szse_sim",SZSE_TEST:"szse_test"}),$jscomp$compprop1={};
GEnvConfig.config=($jscomp$compprop1[ENV_TYPE.SZSE_PRODUCTION]={httpHostName:"datasdk.mktdata.cn",wsHostName:"quotesdk.mktdata.cn",customWsHostName:"customize-sdk.mktdata.cn",siteList:[{siteUrl:"shlistsdk.mktdata.cn/application/",use:!1},{siteUrl:"gzlistsdk.mktdata.cn/application/",use:!1}]},$jscomp$compprop1[ENV_TYPE.SZSE_SIM]={httpHostName:"sim-datasdk.mktdata.cn",wsHostName:"sim-quotesdk.mktdata.cn",customWsHostName:"sim-customize-sdk.mktdata.cn",siteList:[{siteUrl:"sim-shlistsdk.mktdata.cn/application/",
use:!1},{siteUrl:"sim-gzlistsdk.mktdata.cn/application/",use:!1}]},$jscomp$compprop1[ENV_TYPE.SZSE_TEST]={httpHostName:"test-datasdk.mktdata.com.cn",wsHostName:"test-quotesdk.mktdata.com.cn",customWsHostName:"test-customize-sdk.mktdata.com.cn",siteList:[{siteUrl:"test-shlistsdk.mktdata.com.cn/application/",use:!1},{siteUrl:"test-gzlistsdk.mktdata.com.cn/application/",use:!1}]},$jscomp$compprop1);GEnvConfig.envTypeNameList=new Set([ENV_TYPE.SZSE_PRODUCTION,ENV_TYPE.SZSE_SIM,ENV_TYPE.SZSE_TEST]);GEnvConfig.readConfig(GEnvConfig.config);function GChartEngineData(){this.calcEngineData=function(b,f){if(null==b||null==b.field||null==b.data)return[];if(b&&"row"==b.info.rank){for(var g=[],e=0;e<b.field.length;e++){g[e]=[];for(var h=b.field[e][0].toLowerCase(),m=0;m<b.data.length;m++)g[e][m]=b.flags&&b.flags[h]&&3==(b.flags[h][m]&3)?null:b.data[m][e]}b.data=g;b.info.rank="col"}if(b&&b.data&&b.data[0]&&1<b.data[0].length){a:{for(g=0;g<b.field.length;g++)if("th"==b.field[0][1]||"ts"==b.field[0][1]||"tm"==b.field[0][1]||"tms"==b.field[0][1]){g=
{type:"time",col:g};break a}else if("dd"==b.field[0][1]||"dy"==b.field[0][1]||"dq"==b.field[0][1]||"dm"==b.field[0][1]){g={type:"date",col:g};break a}g=void 0}if(g&&(g=g.col,b.data[g][0]>b.data[g][1])){g=[];for(e=0;e<b.field.length;e++)for(g[e]=[],m=0;m<b.data[e].length;m++)g[e][m]=b.data[e][b.data[e].length-m-1];b.data=g}}for(var l in b)if("table"!=l&&"update"!=l&&"field"!=l&&"data"!=l&&"exchTime"!=l&&"adjust"!=l&&"flags"!=l&&"info"!=l&&"dataStatus"!=l&&"last"!=l&&b[l]&&b[l].table&&b[l].table.data&&
b[l].table.field&&"row"==b[l].table.info.rank){h=b[l].table;g=[];for(e=0;e<h.field.length;e++)for(g[e]=[],m=0;m<h.data.length;m++)g[e][m]=h.data[m][e];h.data=g;h.info.rank="col"}g=-1;l=[];if(b.adjust&&b.data&&f&&void 0!=f.dividend&&b.data[0]){h=f.dividend;f=[];e=[];if(b.adjust&&0<b.adjust.length)if(b.adjust[0][1][0])for(var n=0;n<b.adjust.length;n++)for(m=0;!(e[e.length]=[b.adjust[n][1][m][0],b.adjust[n][1][m][1]],m>=b.adjust[n][1].length-2);m++);else for(n=0;n<b.adjust.length;n++)e[e.length]=[b.adjust[n][0],
b.adjust[n][1]];m=b.data[0];var p=[];if(m&&29991231<m[0])for(var q=new Date,v=0;v<m.length;v++)if(q.setTime(m[v]),n=1E4*q.getFullYear()+100*(q.getMonth()+1)+q.getDate(),u!=n)var u=p[v]=n;else p[v]=n+.1;else p=m;u=p;p=e;for(n=0;n<u.length&&null==u[n];n++);for(m=0;n<u.length&&n<b.info.rows&&m<e.length;)null==u[n]?n++:null==p[m]?m++:u[n]>=p[m][0]||1==b.info.rows?(f[f.length]={index:n,date:e[m][0],factor:e[m][1]},m++):u[n]<p[m][0]&&n++;u=[];e=[];n=!1;for(p=0;p<h.dataField.length;p++)u[p]=b.data[a(h.dataField[p],
b)],e[p]=[];if(0<f.length){if("forward"==h.type.toLowerCase()){n=!0;for(p=f.length-1;0<p;p--)f[p].factor=p==f.length-1?f[p-1].factor/f[p].factor:f[p+1].factor*f[p-1].factor/f[p].factor;f[0].factor=1<f.length?f[1].factor/f[0].factor:1/f[0].factor;for(m=0;m<=f.length;m++)for(0==m?(p=0,g=f[m].index,q=f[m].factor,1==u[0].length&&(g=1,m++)):m==f.length?(p=f[m-1].index,g=u[0]?u[0].length:p,q=1):(p=f[m-1].index,g=f[m].index,q=f[m].factor);p<g;p++)for(v=0;v<u.length;v++)u[v]&&u[v][p]&&(e[v][p]=u[v][p]*q);
g=-1;if(1==u[0].length)for(p=0;p<h.dataField.length;p++)if("close"==h.dataField[p].toLowerCase()){e[p][0]=u[p][0];g=p;break}}else if("backward"==h.type.toLowerCase()){n=!0;for(m=0;m<=f.length;m++)for(0==m?(p=0,g=f[m].index,q=1,1==u[0].length&&(g=1,m++)):(m==f.length?(p=f[m-1].index,g=u[0].length):(p=f[m-1].index,g=f[m].index),q=f[m-1].factor);p<g;p++)for(v=0;v<u.length;v++)e[v][p]=u[v][p]*q;g=-1;if(1==u[0].length)for(p=0;p<h.dataField.length;p++)if("close"==h.dataField[p].toLowerCase()){e[p][0]=u[p][0]*
f[0].factor;g=p;break}}else for(v=0;v<u.length;v++)e[v]=xDeepCopy(u[v]);for(p=0;p<h.dataField.length;p++)v=a(h.dataField[p],b),l[v]=e[p]}if(1==n&&b.adjust&&b.adjust[0]&&b.adjust[0][1]&&b.adjust[0][1][0]&&f&&0<f.length){v=a("high",b);var D=a("low",b),F=a("close",b);if("forward"==h.type.toLowerCase()){e=b.adjust;for(p=n=m=0;p<e.length;p++){var z=h=null;q=null;for(var y=0;y<e[p][1].length;y++){q=1;if(m<f.length)for(;m<f.length;m++)if(e[p][1][y][0]<=f[m].date){q=f[m].factor;break}p==e.length-1&&y==e[p][1].length-
1&&(q=1);var B=e[p][1][y][2]*q,t=e[p][1][y][3]*q;q*=e[p][1][y][4];if(null==h||h<B)h=B;if(null==z||z>t)z=t;y<e[p][1].length-1&&e[p][1][y][0]==e[p][1][y+1][0]&&y++}if(e[p][0]>=b.data[0][n])for(;n<l[v].length;n++)if(e[p][0]==b.data[0][n]){l[v][n]=h;l[D][n]=z;l[F][n]=q;break}else if(e[p][0]<b.data[0][n]){n--;break}}1==u[0].length&&0<=g&&(l[F][n]=u[g][0])}else if("backward"==h.type.toLowerCase()){e=b.adjust;for(p=n=m=0;p<e.length;p++){q=z=h=null;for(y=0;y<e[p][1].length;y++){q=1;if(0<m||1==y)q=f[f.length-
1].factor;if(m<f.length)for(;m<f.length;m++)if(e[p][1][y][0]<=f[m].date){0<m&&(q=f[m-1].factor);break}B=e[p][1][y][2]*q;t=e[p][1][y][3]*q;q*=e[p][1][y][4];if(null==h||h<B)h=B;if(null==z||z>t)z=t;y<e[p][1].length-1&&e[p][1][y][0]==e[p][1][y+1][0]&&y++}if(e[p][0]>=b.data[0][n])for(;n<l[v].length;n++)if(e[p][0]==b.data[0][n]){l[v][n]=h;l[D][n]=z;l[F][n]=q;break}else if(e[p][0]<b.data[0][n]){n--;break}}1==u[0].length&&0<=g&&(l[F][n]=u[g][0]*f[f.length-1].factor)}}}return l};var a=function(b,f){for(var g=
0;g<f.field.length;g++)if(b.toLowerCase()==f.field[g][0].toLowerCase())return g;return null}}GChartEngineData.sharedInstance=function(){null==this.instance&&(this.instance=new GChartEngineData);return this.instance};var formulaExcludeKey=["if","try","catch"],isFormulaExcludeKey=function(a){for(var b=0;b<formulaExcludeKey.length;b++)if(a.slice(0,formulaExcludeKey[b].length)==formulaExcludeKey[b]&&(null==a[formulaExcludeKey[b].length]||" "==a[formulaExcludeKey[b].length]||"("==a[formulaExcludeKey[b].length]||"{"==a[formulaExcludeKey[b].length]))return!0;return!1};
function GChartEngine(){function a(C){var E=0;"number"==typeof C||"boolean"==typeof C?E=1:"string"==typeof C?E=1:"object"==typeof C&&"Array"==C.constructor.name&&(E=3);return E}function b(C,E,K){if(null==C||null==K)return null;var Q=a(C),O=a(K);switch(E){case "+":if(1==Q)if(1==O)var L=C+K;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C+K[E]}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]+K;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||
void 0==K[E]?void 0:C[E]+K[E];break;case "-":if(1==Q)if(1==O)L=C-K;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C-K[E]}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]-K;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]-K[E];break;case "*":if(1==Q)if(1==O)L=C*K;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C*K[E]}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]*K;
else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]*K[E];break;case "/":if(1==Q)if(1==O)L=0!=K?C/K:void 0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]||0==K[E]?void 0:C/K[E]}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]||0==K?void 0:C[E]/K;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:0==K[E]?0:C[E]/K[E];break;case "==":if(1==Q)if(1==O)L=C==K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==
K[E]?void 0:C==K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]==K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]==K[E]?1:0;break;case "!=":if(1==Q)if(1==O)L=C!=K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C!=K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]!=K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]!=K[E]?
1:0;break;case ">":if(1==Q)if(1==O)L=C>K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C>=K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]>K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]>K[E]?1:0;break;case ">=":if(1==Q)if(1==O)L=C>=K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C>=K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]>=
K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]>=K[E]?1:0;break;case "<":if(1==Q)if(1==O)L=C<K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C<K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]<K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]<K[E]?1:0;break;case "<=":if(1==Q)if(1==O)L=C<=K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:
C<=K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]<=K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]<=K[E]?1:0;break;case "&&":case "and":if(1==Q)if(1==O)L=C&&K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C&&K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]&&K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]&&K[E]?
1:0;break;case "||":case "or":if(1==Q)if(1==O)L=C||K?1:0;else{if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==K[E]?void 0:C||K[E]?1:0}else if(3==Q)if(1==O)for(L=[],E=0;E<C.length;E++)L[E]=void 0==C[E]?void 0:C[E]||K?1:0;else if(3==O)for(L=[],E=0;E<K.length;E++)L[E]=void 0==C[E]||void 0==K[E]?void 0:C[E]||K[E]?1:0}return L}function f(C,E){n[C]=E}function g(C,E){if('"'==C[E])for(E++;E<C.length&&'"'!=C[E];E++);else if("'"==C[E])for(E++;E<C.length&&"'"!=C[E];E++);else if("`"==C[E])for(E++;E<C.length&&
"`"!=C[E];E++);else if("("==C[E])for(E++;E<C.length;E++)if('"'==C[E]||"'"==C[E]||"`"==C[E])E=g(C,E);else if("("==C[E])E=g(C,E);else if(")"==C[E])break;return E}var e=this,h=!0,m,l,n={},p,q,v,u,D,F,z,y;e.property={param:[],colors:[]};var B=[],t=[],G;this.setFormulaScript=function(C){e.scripts="";e.formula=C;colorCount=0;e.property={param:[],colors:[]};B=[];h=!0;var E=[];var K="";for(var Q=0,O=C.length,L=0;L<O;L++)if("/"==C[L]&&"/"==C[L+1])for(L+=2;L<O&&"\n"!=C[L]&&"\r"!=C[L];L++);else if('"'==C[L]||
"'"==C[L]||"`"==C[L]||"("==C[L]){var P=0,S=C[L],U=S;"("==U?U=")":S=0;if(isFormulaExcludeKey(K.trim()))P=L,L=g(C,L),K+=C.substr(P,L-P+1),E[Q]=K.trim(),K="",Q++;else for(K+=C[L],L++;L<O;L++)if(K+=C[L],C[L]==U&&"\\"!=C[L-1]){if(0==P)break;P--}else C[L]==S&&"\\"!=C[L-1]&&P++}else if(L<O-3&&"{"==C[L]&&"{"==C[L+1]&&" "==C[L+2]&&(0==L||1<L&&"'"!=C[L-1])){P=0;K+="{{ ";for(L+=3;L<O;L++){if(L<O-3&&"{"==C[L]&&"{"==C[L+1]&&" "==C[L+2])P++;else if(L<O-3&&" "==C[L]&&"}"==C[L+1]&&"}"==C[L+2])if(0==P){K+=" }}";L+=
3;"\r"!=C[L+1]&&"\n"!=C[L+1]||L++;break}else P--;K+=C[L]}E[Q]=K.trim();K="";Q++}else"{"==C[L]&&""==K.trim()?(E[Q]="{",K="",Q++):";"==C[L]||"\r"==C[L]||"\n"==C[L]?(E[Q]=K.trim(),K="",Q++,"\r"!=C[L+1]&&"\n"!=C[L+1]||L++):K+=C[L];""!=K&&(E[Q]=K.trim());for(C=0;C<E.length;C++)if("{{ "==E[C].slice(0,3))e.scripts+=E[C]+"\r\n";else if(isFormulaExcludeKey(E[C]))e.scripts+=E[C]+"\r\n";else if("input"!=E[C].slice(0,5).toLowerCase()||":"!=E[C][5]&&" "!=E[C][5]){K=E[C].indexOf("//");if(0<=K&&(E[C]=E[C].substr(0,
K),E[C]=E[C].trim(),""==E[C]))continue;K=J(E[C]);"String"==K.constructor.name?e.scripts+=E[C]+"\n":0<K.length?(K=H(K),e.scripts+=K+";\n"):e.scripts+="\n"}else K=["input",":",J(E[C].slice(6))],H(K);colorCount=void 0};this.getFormulaScript=function(){return e.formula};this.setSets=function(C){B=[];t=[];for(var E=0;E<C.param.length;E++)B[E].value=C.param[E].value;for(E=0;E<C.colors.length;E++)for(var K in C.colors[E])t[E].name=C.colors[E].name};this.setDefault=function(){B=[];t=[];e.setSets(e.property)};
var x=function(C,E){var K=C[E];"("==K?K=")":"["==K?K="]":"{"==K&&(K="}");for(E++;E<C.length;){if(C[E]==K){E++;break}if('"'==C[E]||"'"==C[E]||"`"==C[E]||"("==C[E]||"["==C[E]||"{"==C[E]){if(E=x(C,E),E>=C.length)break}else E++}return E},J=function(C){function E(L,P){for(var S=0;S<L.length;S++){if("("==L[S]||'"'==L[S]||"'"==L[S]||"`"==L[S])S=x(L,S);var U=Q(L,S,P);if(U)return P=J(L.slice(0,S)),L=J(L.slice(S+U.length)),[P,U,L]}}function K(L,P){for(var S,U=0,V=0;U<L.length;U++){if("("==L[U]||'"'==L[U]||
"'"==L[U]||"`"==L[U])U=x(L,U);var X=Q(L,U,P);X&&(V=J(L.slice(V,U)),void 0==S&&(S=[]),S[S.length]=V,S[S.length]=X,U+=X.length-1,V=U+1)}U>V&&S&&(V=J(L.slice(V)),S[S.length]=V);return S}function Q(L,P,S){if(0<P)for(var U=0;U<S.length;U++)if(L[P]===S[U][0]&&(")"==L[P-1]||" "==L[P-1]||"0"<=L[P-1]&&"9">=L[P-1]||"a"<=L[P-1]&&"z">=L[P-1]||"A"<=L[P-1]&&"Z">=L[P-1])&&S[U]===L.slice(P,P+S[U].length).toLowerCase())return S[U]}var O;C=C.trim();"("==C[0]&&")"==C[C.length-1]&&x(C,0)===C.length&&(C=C.slice(1,C.length-
1));return(O=function(L){var P,S,U=0;for(S=0;S<L.length;S++){if("("==L[S]||'"'==L[S]||"'"==L[S]||"`"==L[S])S=x(L,S);if(","==L[S]||")"==L[S])void 0==P&&(P=[]),U=J(L.slice(U,S)),P[P.length]=1==U.length&&"Array"==U[0].constructor.name&&1<U[0].length?U[0]:U,U=S+1,","==L[S]&&(P[P.length]=",")}void 0!=P&&(U=J(L.slice(U,S)),P[P.length]=1==U.length&&"Array"==U[0].constructor.name&&1<U[0].length?U[0]:U);return P}(C))||(O=function(L){for(var P=0;P<L.length;P++)if("("==L[P]||'"'==L[P]||"'"==L[P]||"`"==L[P])P=
x(L,P);else if(":"==L[P]){var S=L[P];"="==L[P+1]&&(S+="=");var U=J(L.slice(0,P));L=J(L.slice(P+S.length));return 1==L.length&&"Array"==L[0].constructor.name&&1<L[0].length?[U,S,L[0]]:[U,S,L]}}(C))||(O=E(C,["||"," or ","&&"," and"]))||(O=E(C,"== != >= <= > < =".split(" ")))||(O=K(C,["-","+"]))||(O=K(C,["*","/"]))?O:(O=function(L){for(var P="",S,U,V=0;V<L.length;V++)if("("==L[V])if(S=V+1,""!=P){if("RGB"==P||"rgb"==P)return"'"+L.toLowerCase()+"'";for(V++;V<L.length;V++){if("("==L[V]||'"'==L[V]||"'"==
L[V]||"`"==L[V])V=x(L,V);if(")"==L[V]){S=J(L.slice(S,V));void 0==U&&(U=[]);U[U.length]="Array"==S.constructor.name?[P,S]:[P,[S]];for(V++;V<L.length;V++)if(","==L[V]){U[U.length]=",";break}else if(" "!=L[V])break;break}}P=""}else break;else if("A"<=L[V]&&"Z">=L[V]||"a"<=L[V]&&"z">=L[V]||"0"<=L[V]&&"9">=L[V]||"."==L[V]||"_"==L[V])P+=L[V];else break;if(void 0!=U)return U}(C))?O:C.trim()},A=function(C){if("object"==typeof C)for(var E=0;E<C.length;E++){"string"==typeof C[E]&&(C[E]=C[E].trim());var K=A(C[E]);
void 0!=K&&(C[E]=K)}},H=function(C){A(C);if("input"==C[0]){C=C[2];var E=C[0][0]+"="+C[0][1][0];for(var K=2;K<C.length;K+=2)E+=","+C[K][0]+"="+C[K][1][0];E="var "+E;for(K=0;K<C.length;K+=2){var Q=parseFloat(C[K][1][2]),O=parseFloat(C[K][1][4]),L=parseFloat(C[K][1][0]),P=L,S=e.property.param.length;e.property.param[S]={name:C[K][0],value:P,default:L,min:Q,max:O,step:C[K][1][6],script:C[K][1][8]};var U=B.length;B[U]={name:C[K][0],value:P,default:L,min:Q,max:O,step:C[K][1][6],script:C[K][1][8]};"string"!=
typeof B[U].value||"'"!=B[U].value[0]&&'"'!=B[U].value[0]&&"`"!=B[U].value[0]?(B[U].type="number",e.property.param[S].type="number"):(B[U].type="string",B[U].value=B[U].value.slice(1,-1),e.property.param[S].type="string",e.property.param[S].value=B[U].value)}}else E=3===a(C[0])&&1<C.length&&","==C[1]?I(C[0]):I(C);return E},I=function(C){if("object"!=typeof C)return C;var E={$:b.name,save:f.name},K;if(2==C.length)var Q=C[0]+"("+I(C[1])+")";else if("string"!=typeof C[0]||":"!=C[1]&&"="!=C[1]&&":="!=
C[1]){var O=0;for(K=0;K<C.length;K++)if("+"===C[K]||"-"===C[K]||"*"===C[K]||"/"===C[K]||"!="===C[K]||"=="===C[K]||">"===C[K]||">="===C[K]||"<"===C[K]||"<="===C[K]||"&&"===C[K]||"||"===C[K]||"and"==C[K]||"or"==C[K]){O=2;break}else if(","==C[K]){O=0;break}switch(O){case 0:Q="";for(K=0;K<C.length;K++)Q+=I(C[K]),","==C[K]&&(Q+=" ");break;case 1:Q=I(C[0]);break;case 2:Q=I(C[0]);var L;for(K=1;K<C.length;K+=2)Q=L=E.$+"("+Q+", '"+C[K]+"', "+I(C[K+1])+")";Q=L}}else Q="var "+C[0]+"="+I(C[2])+";",":="!=C[1]&&
(Q+=E.save+'("'+(C[0]+'",')+C[0]+")");return Q},N=function(C,E){if(void 0!=C)for(var K=0;K<C.length;K++)if(C[K][0].toLowerCase()==E.toLowerCase())return K;return-1},M=function(C,E,K,Q,O,L){e.property.colors=[];drawList=[];1==h&&(m=[]);p="";l=[];u=0;if((z=C.field)&&C.data)for(C.info.name&&""!=C.info.name&&(F=C.info.name+".",p+="var "+C.info.name+"= {};"),K=0;K<z.length;K++){for(D=0;D<l.length&&z[K][0]!=l[D];D++);D==l.length&&(l[u]=z[K][0],u++,E&&E[K]?(p+="var "+z[K][0]+" = arguments[1]["+K+"];\n",
p+=F+z[K][0]+" = arguments[1]["+K+"];\n"):(p+="var "+z[K][0]+" = arguments[0].data["+K+"];\n",p+=F+z[K][0]+" = arguments[0].data["+K+"];\n"),m&&(m[m.length]=z[K][0]))}for(var P in C)if("info"!=P&&"data"!=P&&"field"!=P&&"flags"!=P&&"dataStatus"!=P&&"exchTime"!=P&&"adjust"!=P&&"last"!=P&&C[P]&&C[P].table&&C[P].table.info&&C[P].table.field&&C[P].table.data)for(z=C[P].table.field,F=P+".",p+="var "+P+"={};\r",K=0;K<z.length;K++){for(D=0;D<l.length&&z[K][0]!=l[D];D++);D==l.length&&(u++,p+=F+z[K][0]+" = arguments[0]."+
P+".table.data["+K+"];\n")}try{eval(p)}catch(S){console.log("data err:"+S+";\n"+p);return}p="";for(K=0;K<B.length;K++)p=0==K?p+"var ":p+", ",p="string"==B[K].type?p+(B[K].name+"='"+B[K].value+"'"):p+(B[K].name+"="+B[K].value),m&&(m[m.length]=B[K].name);p+=";";eval(p);if(h){h=!1;p=e.scripts;p=p.replace(/\n/g,"");p=p.replace(/\r/g,"");C=[];for(K=0;K<p.length;K++)if('"'==p[K]||"'"==p[K]||"`"==p[K])E=K,K=g(p,K),P=C.length,C[P]=p.substr(E,K-E+1),p=p.replace(C[P],"strList_"+P),K=-1;y={segmentIndex_:"arguments[3]",
Time:"arguments[4]",Date:"arguments[5]",$hold:b.name};y=Object.assign({},y,GChartFunction.getReflectMap());p=p.replace(/\./gi,"@@@dot");p=y.makeFormulaScript+'("'+p+'", '+JSON.stringify(m)+","+JSON.stringify(y)+");";P=[];for(K=0;;K++)if(E=p.indexOf("{{ "),0<=E)Q=p.indexOf(" }}"),P[K]=p.substr(E+3,Q-E-3),p=p.substr(0,E)+"||| @"+K+"@ |||"+p.substr(Q+3);else break;e.scripts=eval(p);for(K=0;K<P.length;K++)P[K]=P[K].replace(/\bTime\b/g,"arguments[4]"),P[K]=P[K].replace(/\bDate\b/ig,"arguments[5]"),e.scripts=
e.scripts.replace("||| @"+K+"@ |||",P[K]);for(K=0;K<C.length;K++)e.scripts=e.scripts.replace("strList_"+K,C[K]);e.scripts=e.scripts.replace(/@@@dot/gi,".")}try{eval(e.scripts)}catch(S){if(null==G||G!=S.message)G=S.message,console.log("formual err:"+S+";\n"+e.scripts)}};this.run=function(C,E){q=C.data[N(C.field,"Time")];v=C.data[N(C.field,"Date")];M(C,E,null,C.last,q,v)};this.getCalcResult=function(){return n}};var GChartFunction=function(){};GChartFunction.getReflectMap=function(){if(null!=this.ReflectMap)return this.ReflectMap;var a=Reflect.ownKeys(GChartFunction);this.ReflectMap={};for(var b in a)"name"!=a[b]&&"length"!=a[b]&&"prototype"!=a[b]&&"arguments"!=a[b]&&"getReflectMap"!=a[b]&&(this.ReflectMap[a[b]]=GChartFunction.name+"."+a[b]);return this.ReflectMap};
GChartFunction.makeFormulaScript=function(a,b,f){a=a.replace(/__2__/g,'"');a=a.replace(/__1__/g,"'");for(var g in b){var e="/\\b"+b[g]+"\\b/gi";a='"'+a+'".replace('+e+", '"+b[g]+"')";a=eval(a)}for(g in f)e="/\\b"+g+"\\b/gi",a='"'+a+'".replace('+e+", '"+f[g]+"')",a=eval(a);return a};
GChartFunction.MA=function(a,b){if(a&&"object"==typeof a&&"Array"==a.constructor.name&&0<b&&a.length>=b){var f=[];a.type&&(f.type=a.type);var g=0,e,h,m=0;for(e=0;e<a.length;e++)if(void 0!=a[e]){for(h=0;m<b&&e<a.length;e++,h++)null!=a[e]&&(g+=a[e],m++);break}for(m==b&&(f[e-1]=g/b);e<a.length;e++)if(null!=a[e]&&null!=a[e-b])if(m==b)g+=a[e]-a[e-b],f[e]=g/b;else{for(h=g=0;h<b&&0<=e-h;h--)null!=a[e-h]&&(g+=a[e-h],m++);m==b&&(f[e]=g/b)}}return f};
GChartFunction.DMA=function(a,b){if(a&&1>b){var f=[];a.type&&(f.type=a.type);f[0]=b[0];for(var g=0;g<a.length;g++)f[g]=void 0!=a[g]&&void 0!=a[g-1]?b*a[g]+(1-b)*f[g-1]:void 0}return f};GChartFunction.EMA=function(a,b){if(a){var f=[];a.type&&(f.type=a.type);f[0]=a[0];for(var g=1;g<a.length;g++)f[g]=void 0!=a[g]&&void 0!=f[g-1]?(2*a[g]+(b-1)*f[g-1])/(b+1):a[g]}return f};
GChartFunction.SMA=function(a,b,f){if(a&&b>f&&0!=b){var g=[];a.type&&(g.type=a.type);g[b-1]=a[b-1];for(var e=0;e<a.length;e++)void 0!=a[e]&&void 0!=g[e-1]?g[e]=(f*a[e]+(b-f)*g[e-1])/b:void 0!=a[e]&&(g[e]=a[e])}return g};GChartFunction.TMA=function(a,b,f){if(a){var g;var e=[];e.type&&(d.type=e.type);for(g=0;g<a.length;g++)if(void 0!=a[g]){e[g]=f*a[g];break}for(g++;g<a.length;g++)e[g]=void 0!=a[g]&&void 0!=e[g-1]?b*e[g-1]+f*a[g]:a[g]}return e};
GChartFunction.WMA=function(a,b){if(0<b){var f;var g=[];g.type&&(d.type=g.type);for(f=0;f<a.length;f++){for(var e=0,h=0,m=0;m<b;m++)void 0!=a[f]&&(e+=a[f],h+=1);g[f]=0<h?e/h:void 0}}return g};
GChartFunction.LLV=function(a,b){if(a&&"object"==typeof a&&"Array"==a.constructor.name&&0<b&&a.length>=b){var f;var g=[];g.type&&(d.type=g.type);var e=g[0]=a[0];if(0==b)for(f=1;f<a.length;f++)void 0!=a[f]&&e>a[f]&&(e=a[f]),g[f]=e;else{for(f=1;f<b;f++)f<b&&(void 0!=a[f]&&e>a[f]&&(e=a[f]),g[f]=e);for(;f<a.length;f++){e=a[f-b+1];for(var h=f-b+1;h<=f;h++)void 0!=a[h]&&e>a[h]&&(e=a[h]);g[f]=e}}}return g};
GChartFunction.HHV=function(a,b){if(a&&"object"==typeof a&&"Array"==a.constructor.name&&0<b&&a.length>=b){var f;var g=[];g.type&&(d.type=g.type);var e=g[0]=a[0];if(0==b)for(f=1;f<a.length;f++)void 0!=a[f]&&e<a[f]&&(e=a[f]),g[f]=e;else{for(f=1;f<b;f++)f<b&&(void 0!=a[f]&&e<a[f]&&(e=a[f]),g[f]=e);for(;f<a.length;f++){e=a[f-b+1];for(var h=f-b+1;h<=f;h++)void 0!=a[h]&&e<a[h]&&(e=a[h]);g[f]=e}}}return g};
GChartFunction.HHVBARS=function(a,b){var f=[];a.type&&(f.type=a.type);if(0==b){b=a.length-1;var g=a[b],e=b;for(b--;0<=b;b--)void 0!=a[b]&&(void 0==g?(g=a[b],e=b):g<a[b]&&(g=a[b],e=b));f[b]=e}else for(g=b-1;g<a.length;g++){e=a[g];for(var h=g,m=g;m>=g-b;m--)void 0!=a[m]&&(void 0==e?(e=a[m],h=m):e<a[m]&&(e=a[m],h=m));f[g]=h}return f};
GChartFunction.LLVBARS=function(a,b){var f=[];a.type&&(f.type=a.type);if(0==b){var g=a.length-1;b=a[g];var e=g;for(g--;0<=g;g--)void 0!=a[g]&&(void 0==b?(b=a[g],e=g):b>a[g]&&(b=a[g],e=g));f[g]=e}else for(g=b-1;g<a.length;g++){var h=a[g],m=g;for(e=g;e>=g-b;e--)void 0!=a[e]&&(void 0==h?(h=a[e],m=e):h>a[e]&&(h=a[e],m=e));f[g]=m}return f};GChartFunction.REF=function(a,b){if(a){var f=[];a.type&&(f.type=a.type);if(0==b)for(b=0;b<a.length;b++)f[b]=a[0];else for(var g=b;g<a.length;g++)f[g]=a[g-b]}return f};
GChartFunction.REFX=function(a,b){var f=[];a.type&&(f.type=a.type);if(a){var g;if(0==b)for(g=0;g<a.length;g++)f[g]=a[a.length-1];else for(g=0;g<a.length;g++)f[g]=null==a[g+b]?f[g-1]:a[g+b]}return f};GChartFunction.REF2=function(a,b,f){if(a){var g=[];a.type&&(g.type=a.type);if("Array"==f.constructor.name)for(var e=0;e<b;e++)g[e]=f[e];else for(e=0;e<b;e++)g[e]=f;for(f=b;f<a.length;f++)g[f]=a[f-b]}return g};
GChartFunction.REFDATA=function(a,b){var f;if(b&&0<b.length){var g=[];a.type&&(g.type=a.type);for(f=0;f<b.length;f++)b[f]&&(g[f]=a[f])}return g};GChartFunction.REFBARPOS=function(a){var b;if(a&&0<a.length){var f=[];for(b=0;b<a.length;b++)a[b]&&(f[b]=b)}return f};
GChartFunction.IFF=function(a,b,f){var g=[];if("Array"==a.constructor.name)if("Array"==b.constructor.name)if("Array"==f.constructor.name)for(var e=0;e<a.length;e++)g[e]=1==a[e]?b[e]:f[e];else for(e=0;e<a.length;e++)g[e]=1==a[e]?b[e]:f;else if("Array"==f.constructor.name)for(e=0;e<a.length;e++)g[e]=1==a[e]?b:f[e];else for(e=0;e<a.length;e++)g[e]=1==a[e]?b:f;else if(1==a)if("Array"==b.constructor.name)for(f=0;f<a.length;f++)g[f]=b[f];else for(f=0;f<a.length;f++)g[f]=b;else if("Array"==f.constructor.name)for(b=
0;b<a.length;b++)g[b]=f[b];else for(b=0;b<a.length;b++)g[b]=f;return 0<g.length?g:void 0};GChartFunction.RGB=function(a,b,f){var g=parseInt(a).toString(16),e=parseInt(b).toString(16),h=parseInt(f).toString(16);16>a&&(g="0"+g);16>b&&(e="0"+e);16>f&&(h="0"+h);return"#"+g+e+h};
GChartFunction.DEVSQ=function(a,b){1>b&&(b=1);var f=0,g;if(a.length>=b){var e=[];a.type&&(e.type=a.type);for(g=0;g<b-1;g++)f+=a[g]?a[g]:0;for(var h=b-1;h<a.length;h++){f+=a[h]?a[h]:0;g=f/b;for(var m=0,l=h-b+1;l<h+1;l++)m+=Math.pow((a[l]?a[l]:0)-g,2);e[h]=m;f-=a[h-b+1]?a[h-b+1]:0}}return e};GChartFunction.STD=function(a,b){a=GChartFunction.DEVSQ(a,b);for(var f=--b;f<a.length;f++)a[f]=Math.sqrt(a[f]/b);return a};
GChartFunction.AVEDEV=function(a,b){1>b&&(b=1);var f=0,g,e=[];a.type&&(e.type=a.type);for(g=0;g<b;g++)f+=a[g];for(var h=b,m;h<a.length;h++){f+=a[h];f-=a[h-b];var l=f/b;g=0;for(m=h-b+1;m<=h;m++)g+=Math.abs(a[m]-l);e[h]=g/b}return e};GChartFunction.STDP=function(a,b){a=GChartFunction.DEVSQ(a,b);for(var f=0;f<a.length;f++)a[f]&&(a[f]=Math.sqrt(a[f]/b));return a};GChartFunction.let=function(a,b){1>b&&(b=1);a=GChartFunction.DEVSQ(a,b);for(var f=0;f<a.length;f++)a[f]/=b-1;return a};
GChartFunction.letP=function(a,b){a=GChartFunction.DEVSQ(a,b);for(var f=0;f<a.length;f++)a[f]/=b;return a};GChartFunction.linearRegress=function(a,b,f){var g=0;f<g+b-1&&(f=g+b-1);var e=0,h=0,m=0,l=0;g=f-b+1;for(f=1;f<=b;f++)e+=f,m+=a[g+f-1],h+=f*a[g+f-1],l+=f*f;a=m/b;e/=b;b=(h-b*e*a)/(l-b*e*e);return[a-b*e,b]};GChartFunction.FORCAST=function(a,b){3>b&&(b=3);var f=[];a.type&&(f.type=a.type);for(var g=b-1;g<a.length;g++){var e=GChartFunction.linearRegress(a,b,g);f[g]=e[0]+e[1]*b}return f};
GChartFunction.SLOPE=function(a,b){3>b&&(b=3);var f=[];a.type&&(f.type=a.type);for(var g=b-1;g<a.length;g++){var e=GChartFunction.linearRegress(a,b,g);f[g]=e[1]}return f};
GChartFunction.SAR=function(a,b,f,g,e){var h=[],m;if(4<f.length){var l=0;for(m=1;4>m;m++)l+=f[m];l/=3;var n=0,p=0;g[p]<l?n=1:e[p]>l?n=0:f[p]<f[p+1]&&(n=1);var q=1;m=1==n?e[p]:g[p];var v=g[p],u=e[p],D=0;for(p=0;p<f.length;p++){l=f[p];var F=g[p];var z=e[p];1==n?m>l?(n=0,m=v,q=1,u=z):(1==q&&(D=a,v=F,q=1),F>v&&(D+=a,D>b&&(D=b),v=F),m+=D*(F-m)/1E3,m>z&&(m=z)):m<l?(n=1,m=u,q=1,v=F):(q&&(u=z,D=a,q=0),z<u&&(D+=a,D>b&&(D=b),u=z),m-=D*(m-z)/1E3,m<F&&(m=F));h[p+1]=m}}return h};
GChartFunction.MAX=function(a,b){var f=[];if("Array"==a.constructor.name)if("Array"==b.constructor.name)for(var g=0;g<a.length;g++)f[g]=a[g]>b[g]?a[g]:b[g];else for(g=0;g<a.length;g++)f[g]=a[g]>b?a[g]:void 0==a[g]?void 0:b;else if("Array"==b.constructor.name)for(g=0;g<b.length;g++)f[g]=a>b[g]?a:b[g];else f=a>b?a:b;return f};
GChartFunction.MIN=function(a,b){var f=[];if("Array"==a.constructor.name)if("Array"==b.constructor.name)for(var g=0;g<a.length;g++)f[g]=a[g]<b[g]?a[g]:b[g];else for(g=0;g<a.length;g++)f[g]=a[g]<b?a[g]:b;else if("Array"==b.constructor.name)for(g=0;g<b.length;g++)f[g]=a<b[g]?a:b[g];else f=a<b?a:b;return f};GChartFunction.ABS=function(a){if(void 0!=a){if("Array"==a.constructor.name){var b=[];a.type&&(b.type=a.type);for(var f=0;f<a.length;f++)b[f]=0>a[f]?-a[f]:a[f];return b}return 0>a?-a:a}};
GChartFunction.COUNT=function(a,b){var f=[],g=0;if(0==b)for(b=0;b<a.length;b++)1==a[b]&&g++,f[b]=g;else if(b<a.length){for(var e=0;e<b-1;e++)1==a[e]&&g++;for(e=b-1;e<a.length;e++)1==a[e]&&g++,f[e]=g,1==a[e-b+1]&&g--}return f};GChartFunction.BARPOS=function(a){var b=[];a.type&&(b.type=a.type);for(var f=0;f<a.length;f++)b[f]=f;return b};GChartFunction.BARSTATUS=function(a){var b=[1],f;for(f=0;f<a.length-1;f++)b[f]=0;b[f]=2;return b};
GChartFunction.BARSCOUNT=function(a){var b=[];a.type&&(b.type=a.type);for(var f=0;f<a.length;f++)b[f]=f;return b};GChartFunction.BARSLAST=function(a){var b=[];a.type&&(b.type=a.type);for(var f=0,g=0;g<a.length;g++)void 0!=a[g]&&1==a[g]?f++:f=0,b[g]=f;return b};
GChartFunction.SUMBARS=function(a,b){var f=[];a.type&&(f.type=a.type);if("Array"==b.constructor.name)for(var g=0;g<a.length;g++)for(var e=0,h=g;0<=h;h--){if(e+=a[g],e>=b[g]){f[g]=g-h;break}}else for(g=0;g<a.length;g++)for(e=0,h=g;0<=h;h--)if(e+=a[g],e>=b){f[g]=g-h;break}return f};GChartFunction.BARSSINCE=function(a){var b=[];a.type&&(b.type=a.type);for(var f=0,g=0;g<a.length;g++)void 0!=a[g]&&1==a[g]?f++:f=0,b[g]=f;return b};
GChartFunction.SUM=function(a,b){b=void 0===b?0:b;var f=[];a.type&&(f.type=a.type);if(0==b)for(f[0]=a[0]?a[0]:0,b=1;b<a.length;b++)f[b]=void 0!=a[b]?f[b-1]+a[b]:f[b-1];else if(0<b&&b<=a.length){for(var g=0,e=0;e<b;e++)void 0!=a[e]&&(g+=a[e]);f[b]=g;for(e=b;e<a.length;e++)void 0!=a[e]&&(g+=a[e]),void 0!=a[e-b]&&(g-=a[e-b]),f[e]=g}return f};GChartFunction.HOD=function(a,b){var f=[];a.type&&(f.type=a.type);for(var g=b-1;g<a.length;g++){for(var e=a[g],h=0,m=g-b;m<g;m++)e>a[m]&&h++;f[g]=h}return f};
GChartFunction.LOD=function(a,b){var f=[];a.type&&(f.type=a.type);for(var g=b-1;g<a.length;g++){for(var e=a[g],h=0,m=g-b;m<g;m++)e<a[m]&&h++;f[g]=h}return f};GChartFunction.FILTER=function(a,b){var f=[];a.type&&(f.type=a.type);for(var g=0,e=0;e<a.length;e++)0==g&&void 0!=a[e]&&1==a[e]?(f[e]=1,g=b):(f[e]=0,g--);return f};
GChartFunction.FILTERX=function(a,b){var f=[];a.type&&(f.type=a.type);if(0==b)for(b=a.length-1;0<=b&&(f[b]=a[b],!a[b]);b--);else for(var g=a.length-1;0<=g;g--)if(f[g]=a[g],a[g]){var e=0;for(g--;0<=g&&e<b;e++,g--)f[g]=0;g++}return f};GChartFunction.BACKSET=function(a,b){var f=[];a.type&&(f.type=a.type);for(var g=b;g<a.length;g++)f[g-b]=void 0!=a[g]&&1==a[g]?1:0;return f};
GChartFunction.CalcZigDot=function(a,b){var f=[[0,a[0]]],g=a[0],e,h,m;var l=e=g;for(var n=h=m=0,p=0,q=1;q<a.length;q++){if(.001>g||99999999<g)return-1;var v=(a[q]-g)/g,u=(g-a[q])/g;0==p?v>=b?(p=1,f[f.length]=[q,a[q]],g=a[q]):u>=b?(p=-1,f[f.length]=[q,a[q]],g=a[q]):(v=(a[q]-e)/e,u=(l-a[q])/l,v>=b?(p=1,f[f.length]=[m,a[m]],f[f.length]=[q,a[q]],g=a[q]):u>=b?(p=-1,f[f.length]=[h,a[h]],f[f.length]=[q,a[q]],g=a[q]):l<a[q]?(l=a[q],h=q):e>a[q]&&(e=a[q],m=q)):1==p?0<v?(p=1,f[f.length-1]=[q,a[q]],g=a[q]):u>=
b&&(p=-1,f[f.length]=[q,a[q]],g=a[q]):0<u?(p=-1,f[f.length-1]=[q,a[q]],g=a[q]):v>=b&&(p=1,f[f.length]=[q,a[q]],g=a[q]);p&&0==n&&(n=p)}return f};
GChartFunction.ZIG=function(a,b){b=GChartFunction.CalcZigDot(a,b/100);if(0<b.length){var f=[];a.type&&(f.type=a.type);for(var g=1;g<b.length;g++)for(var e=b[g-1][0];e<=b[g][0];e++)f[e]=b[g-1][1]+(e-b[g-1][0])*(b[g][1]-b[g-1][1])/(b[g][0]-b[g-1][0]);g=b.length-1;if(0<g&&b[g][0]<a.length-1)for(f[a.length]=a[a.length],e=b[g][0];e<a.length;e++)f[e]=b[g][1]+(e-b[g][0])*(a[a.length-1]-b[g][1])/(a.length-1-b[g][0])}return f};
GChartFunction.PEAK=function(a,b,f){if(!(0>=f)){b=GChartFunction.CalcZigDot(a,b/100);if(0<=b.length){var g;var e=[];a.type&&(e.type=a.type);var h=2*f;for(g=0;g<a.length;g++)e[g]=b[h-2*f][1],h<b.length&&g>=b[h][0]&&(h+=2)}return e}};GChartFunction.PEAKBARS=function(a,b,f){if(!(0>=f)){b=GChartFunction.CalcZigDot(a,b/100);if(0<=b.length){var g;var e=[];a.type&&(e.type=a.type);var h=2*f;for(g=0;g<a.length;g++)e[g]=b[h-2*f][0],h<b.length&&g>=b[h][0]&&(h+=2)}return e}};
GChartFunction.formatValue=function(a,b,f,g){if(null!=a){var e=[];a.type&&(e.type=a.type);if(0<=b.indexOf("YY")||0<=b.indexOf("DD")||0<=b.indexOf("MM")){for(f=0;f<a.length;f++)null!=a[f]&&(e[f]=getValueFormatString(a[f],"dd",b));return e}return f&&1<f&&g&&"Number"==a.constructor.name?(a/=f,"\u767e\u5206\u6bd4"==g?a+"%":a+g):a}};function GEngineApply(){this.getDividendData=function(a,b){b=void 0===b?"none":b;var f=a.result[0].table,g=f.field;if(null==g)return a;for(var e=0,h=0;h<g.length;h++){var m=g[h][0];"open"!=m.toLocaleLowerCase()&&"high"!=m.toLocaleLowerCase()&&"low"!=m.toLocaleLowerCase()&&"close"!=m.toLocaleLowerCase()||e++}if(4==e)for(b={dividend:{factorName:"dividend",factorField:"factor",type:b,dataField:["open","high","low","close"]}},b=GChartEngineData.sharedInstance().calcEngineData(f,b),g=0;g<b.length;g++)b[g]&&
(f.data[g]=b[g]);return a};this.getFormulaData=function(a,b,f){f=("GFormula."+b+"("+f+")").replace("&","_");try{f=eval(f)}catch(l){console.log(l);return}var g=a.result[0].table;a=new GChartEngine;a.setFormulaScript(f);a.run(g);f=a.getCalcResult();a={result:[]};var e={};a.result.push(e);e.gid={name:b,id:null,idx:null};b={data:[],field:[],info:{begin:g.info.begin,compressed:"0",dataBegin:g.info.dataBegin,dataRange:g.info.dataRange,dataRows:g.info.dataRows,mode:"table",msg:"",name:b,rank:"col",rows:g.info.rows,
thisBegin:g.info.thisBegin,totalRows:g.info.totalRows}};for(var h in f){g=f[h];var m=[];m[0]=h;m[1]="";b.field.push(m);b.data.push(g)}e.table=b;return a=JSON.stringify(a)}}GEngineApply.sharedInstance=function(){null==this.instance&&(this.instance=new GEngineApply);return this.instance};var GFormula=function(){};GFormula.VOL=function(a,b,f){return"INPUT:M1("+a+",2,500),M2("+b+",2,500),M3("+f+",2,500);\n        MAVOL1:MA(Volume,M1);\n        MAVOL2:MA(Volume,M2);\n        MAVOL3:MA(Volume,M3);\n        "};GFormula.AMO=function(a,b,f){return"INPUT:M1("+a+",2,500),M2("+b+",2,500),M3("+f+",2,500);\n        MAVOL1:MA(Amount,M1);\n        MAVOL2:MA(Amount,M2);\n        MAVOL3:MA(Amount,M3);\n        "};GFormula.KDJ=function(a,b,f){return"INPUT:N("+a+",2,90),M1("+b+",2,30),M2("+f+",2,30);\n        RSV:=(Close-LLV(Low,N))/(HHV(High,N)-LLV(Low,N))*100;\n        K:SMA(RSV,M1,1);\n        D:SMA(K,M2,1);\n        J:3*K-2*D;\n        "};
GFormula.MACD=function(a,b,f){return"INPUT:SHORT("+a+",2,200),LONG("+b+",2,200),MID("+f+",2,200);\n        DIF:EMA(Close,SHORT)-EMA(Close,LONG);\n        DEA:EMA(DIF,MID);\n        MACD:(DIF-DEA)*2;\n        "};GFormula.EXPMA=function(a,b){return"INPUT:M1("+a+",2,500),M2("+b+",2,500);\n        EXP1:EMA(Close,M1);\n        EXP2:EMA(Close,M2);\n        "};GFormula.MA=function(a,b,f,g,e,h){return"INPUT:M1("+a+",0,1000),M2("+b+",0,1000),M3("+f+",0,1000),M4("+g+",0,1000),M5("+e+",0,1000),M6("+h+",0,1000);\n        MA1:MA(Close,M1);\n        MA2:MA(Close,M2);\n        MA3:MA(Close,M3);\n        MA4:MA(Close,M4);\n        MA5:MA(Close,M5);\n        MA6:MA(Close,M6);\n        "};
GFormula.PBX=function(a,b,f,g,e,h){return"INPUT:M1("+a+",3,10),M2("+b+",3,20),M3("+f+",3,30),M4("+g+",3,40),M5("+e+",3,50),M6("+h+",3,60);\n        PBX1:(EMA(Close,M1)+MA(Close,M1*2)+MA(Close,M1*4))/3;\n        PBX2:(EMA(Close,M2)+MA(Close,M2*2)+MA(Close,M2*4))/3;\n        PBX3:(EMA(Close,M3)+MA(Close,M3*2)+MA(Close,M3*4))/3;\n        PBX4:(EMA(Close,M4)+MA(Close,M4*2)+MA(Close,M4*4))/3;\n        PBX5:(EMA(Close,M5)+MA(Close,M5*2)+MA(Close,M5*4))/3;\n        PBX6:(EMA(Close,M6)+MA(Close,M6*2)+MA(Close,M6*4))/3;\n        "};
GFormula.SAR=function(a,b){return"INPUT:S("+a+",1,100),M("+b+",1,100);\n        S1:SAR(S,M,Close,High,Low);\n        "};GFormula.CDP=function(){return"\n        PT:=REF(High+Low+Close,1)/3;\n        NH:PT*2-REF(Low,1);\n        AH:NH+REF(High-Low,1);\n        CDP:REF(High+Low+Close,1)/3;\n        NL:PT*2-REF(High,1);\n        AL:NL-REF(High-Low,1);"};GFormula.RSI=function(a,b,f){return"INPUT:N1("+a+",2,120),N2("+b+",2,250),N3("+f+",2,500);\n        LC:=REF(Close,1);\n        RSI1:SMA(MAX(Close-LC,0),N1,1)/SMA(ABS(Close-LC),N1,1)*100;\n        RSI2:SMA(MAX(Close-LC,0),N2,1)/SMA(ABS(Close-LC),N2,1)*100;\n        RSI3:SMA(MAX(Close-LC,0),N3,1)/SMA(ABS(Close-LC),N3,1)*100;\n        "};
GFormula.DMI=function(a,b){return"INPUT:N("+a+",2,100),MM("+b+",1,100);\n        TR:=SUM(MAX(MAX(High-Low,ABS(HIGH-REF(Close,1))),ABS(LOW-REF(Close,1))),N);\n        HD:=High-REF(High,1);\n        LD:=REF(LOW,1)-LOW;\n        DMP:=SUM(IFF(HD>0 AND HD>LD,HD,0),N);\n        DMM:=SUM(IFF(LD>0 AND LD>HD,LD,0),N);\n        DI1:DMP*100/TR;\n        DI2:DMM*100/TR;\n        ADX:MA(ABS(DI2-DI1)/(DI1+DI2)*100,MM);\n        ADXR:(ADX+REF(ADX,MM))/2;\n        "};
GFormula.PSY=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        PSY:COUNT(Close>REF(Close,1),N)/N*100;\n        PSYMA:MA(PSY,M);\n        "};GFormula.CCI=function(a){return"INPUT:N("+a+",2,100);\n        TYP:=(High+Low+Close)/3;\n        CCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\n        "};GFormula.W_R=function(a,b){return"INPUT:N("+a+",2,100),N1("+b+",2,100);\n        WR1:100*(HHV(High,N)-Close)/(HHV(High,N)-LLV(Low,N));\n        WR2:100*(HHV(High,N1)-Close)/(HHV(High,N1)-LLV(Low,N1));\n        "};
GFormula.DMA=function(a,b,f){return"INPUT:N1("+a+",2,60),N2("+b+",2,250),M("+f+",2,100);\n        DIF:MA(CLOSE,N1)-MA(CLOSE,N2);\n        DIFMA:MA(DIF,M);\n        "};GFormula.CR=function(a,b,f,g){return"INPUT:N("+a+",2,100),M1("+b+",0,100),M2("+f+",0,100),M3("+g+",0,100);\n        MID:=REF(HIGH+LOW,1)/2;\n        CR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\n        MA1:REF(MA(CR,M1),M1/2.5+1);\n        MA2:REF(MA(CR,M2),M2/2.5+1);\n        MA3:REF(MA(CR,M3),M3/2.5+1);\n        MA4:REF(MA(CR,M4),M4/2.5+1);\n        "};
GFormula.BIAS=function(a,b,f){return"INPUT:N1("+a+",2,250),N2("+b+",2,250),N3("+f+",2,250);\n        BIAS1 :(Close-MA(Close,N1))/MA(Close,N1)*100;\n        BIAS2 :(Close-MA(Close,N2))/MA(Close,N2)*100;\n        BIAS3 :(Close-MA(Close,N3))/MA(Close,N3)*100;\n        "};GFormula.ARBR=function(a){return"INPUT:N("+a+",2,120);\n        AR:SUM(High-Open,N)/SUM(Open-Low,N)*100;\n        BR:SUM(MAX(0,High-REF(Close,1)),N)/SUM(MAX(0,REF(Close,1)-Low),N)*100;\n        "};GFormula.AD=function(){return"AD:SUM(((CLOSE-LOW)-(HIGH-CLOSE))/(HIGH-LOW)*Volume,0);"};
GFormula.ADTM=function(a,b){return"INPUT:N("+a+",2,120),M("+b+",2,100);\n        DTM := IFF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\n        DTM := IFF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\n        DBM := IFF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));\n        STM := SUM(DTM,N);\n        SBM := SUM(DBM,N);\n        ADTM:IFF(STM>SBM,(STM-SBM)/STM,IFF(STM==SBM,0,(STM-SBM)/SBM));\n        MAADTM:MA(ADTM,M);\n        "};
GFormula.AMV=function(a,b,f,g){return"INPUT:M1("+a+",2,120),M2("+b+",2,120),M3("+f+",2,120),M4("+g+",2,120);\n        AMOV:=Volume*(OPEN+CLOSE)/2;\n        AMV1:SUM(AMOV,M1)/SUM(Volume,M1);\n        AMV2:SUM(AMOV,M2)/SUM(Volume,M2);\n        AMV3:SUM(AMOV,M3)/SUM(Volume,M3);\n        AMV4:SUM(AMOV,M4)/SUM(Volume,M4);\n        "};GFormula.ASI=function(a,b){return"INPUT:M1("+a+",5,300),M2("+b+",1,300);\n        LC:=REF(CLOSE,1);\n        AA:=ABS(HIGH-LC);\n        BB:=ABS(LOW-LC);\n        CC:=ABS(HIGH-REF(LOW,1));\n        DD:=ABS(LC-REF(OPEN,1));\n        R:= IFF(AA>BB and AA>CC,AA+BB/2+DD/4,IFF(BB>CC and BB>AA,BB+AA/2+DD/4,CC+DD/4));\n        X:=(CLOSE-LC+(CLOSE-OPEN)/2+LC-REF(OPEN,1));\n        SI:16*X/R*MAX(AA,BB);\n        ASI:SUM(SI,M1);\n        ASIT:MA(ASI,M2);\n        "};
GFormula.ATR=function(a){return"INPUT:M1("+a+",2,300);\n        MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));\n        ATR:MA(MTR,M1);\n        "};GFormula.BBIBOLL=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        CV:=CLOSE;\n        BBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;\n        UPR:(BBIBOLL+M*STD(BBIBOLL,N));\n        DWN:(BBIBOLL-M*STD(BBIBOLL,N));\n        "};GFormula.BIAS36=function(a){return"INPUT:M("+a+",2,60);\n        BIAS36:MA(CLOSE,3)-MA(CLOSE,6);\n        BIAS612:MA(CLOSE,6)-MA(CLOSE,12);\n        MABIAS:MA(BIAS36,M);\n        "};
GFormula.CHO=function(a,b,f){return"INPUT:N1("+a+",2,60),N2("+b+",2,100),M("+f+",2,60);\n        MID:=SUM(Volume*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);\n        CHO:MA(MID,N1)-MA(MID,N2);\n        MACHO:MA(CHO,M);\n        "};GFormula.CYR=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        DIVE:=0.01*EMA(Amount,N)/EMA(Volume,N);\n        CYR:(DIVE/REF(DIVE,1)-1)*100;\n        MACYR:MA(CYR,M);\n        "};GFormula.DBCD=function(a,b,f){return"INPUT:N("+a+",2,100),M("+b+",2,100),T("+f+",2,100);\n        BIAS1:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N);\n        DIF:=(BIAS1-REF(BIAS1,M));\n        DBCD1:SMA(DIF,T,1),precis3;\n        MM:MA(DBCD1,5),precis4;\n        "};
GFormula.DDI=function(a,b,f,g){return"INPUT:N("+a+",1,200),N1("+b+",1,200),M("+f+",1,200),M1("+g+",1,200);\n        TR:=MAX(ABS(HIGH-REF(HIGH,1)),ABS(LOW-REF(LOW,1)));\n        DMZ:=IFF((HIGH+LOW)<=(REF(HIGH,1)+REF(LOW,1)),0,MAX(ABS(HIGH-REF(HIGH,1)),ABS(LOW-REF(LOW,1))));\n        DMF:=IFF((HIGH+LOW)>=(REF(HIGH,1)+REF(LOW,1)),0,MAX(ABS(HIGH-REF(HIGH,1)),ABS(LOW-REF(LOW,1))));\n        DIZ:=SUM(DMZ,N)/(SUM(DMZ,N)+SUM(DMF,N));\n        DIF:=SUM(DMF,N)/(SUM(DMF,N)+SUM(DMZ,N));\n        DDI1:DIZ-DIF;\n        ADDI:SMA(DDI1,N1,M);\n        AD1:MA(ADDI,M1);\n        "};
GFormula.DPO=function(a,b){return"INPUT:N("+a+",2,90),M("+b+",2,60);\n        DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);\n        MADPO:MA(DPO,M);\n        "};GFormula.EMV=function(a,b){return"INPUT:N("+a+",2,90),M("+b+",2,60);\n        VOLUME:=MA(Volume,N)/Volume;\n        MID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);\n        EMV:MA(MID*Volume*(HIGH-LOW)/MA(HIGH-LOW,N),N);\n        MAEMV:MA(EMV,M);\n        "};GFormula.ENV=function(a,b,f){return"INPUT:N("+a+",2,120),M1("+b+",2,120),M2("+f+",2,120);\n        UPPER:(1+M1/100)*MA(CLOSE,N);\n        LOWER:(1-M2/100)*MA(CLOSE,N);\n        ENE:(UPPER+LOWER)/2;\n        "};
GFormula.ICHIMOKU=function(a,b,f){return"INPUT:SHORT("+a+",1,300),MID("+b+",1,300),LONG("+f+",1,300);\n        zhx:(HHV(High,SHORT)+LLV(Low,SHORT))/2,COLORRED,LINETHICK2;\n        jzx:(HHV(High,MID)+LLV(Low,MID))/2,COLORFF8040,LINETHICK2;\n        cxd:REFX(CLOSE,MID),COLORGRAY,LINETHICK2;\n        A:REF((zhx+jzx)/2,MID);\n        B:REF((HHV(High,LONG)+LLV(Low,LONG))/2,MID);\n        STICKLINE(A<B,A,B,2,1.5),COLOR339933;\n        STICKLINE(A>=B,A,B,2,0.1),COLOR0033CC;\n        PA:PLOYLINE(1,A),COLORBROWN;\n        PB:PLOYLINE(1,B),COLORLIGREEN;\n        "};
GFormula.KD=function(a,b,f){return"INPUT:N("+a+",2,100),M1("+b+",2,100),M2("+f+",2,100);\n        RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\n        K:SMA(RSV,M1,1);\n        D:SMA(K,M2,1);\n        "};GFormula.LWR=function(a,b,f){return"INPUT:N("+a+",1,500),M1("+b+",1,500),M2("+f+",1,500);\n        RSV:= (HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;\n        LWR1:SMA(RSV,M1,1);\n        LWR2:SMA(LWR1,M2,1);\n        "};
GFormula.MASS=function(a,b,f){return"INPUT:N1("+a+",2,120),N2("+b+",2,120),M("+f+",2,120);\n        MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);\n        MAMASS:MA(MASS,M);\n        "};GFormula.MFI=function(a,b){return"INPUT:N("+a+",2,120),N2("+b+",2,60);\n        TYP := (HIGH + LOW + CLOSE)/3;\n        V1:=SUM(IFF(TYP>REF(TYP,1),TYP*Volume,0),N)/SUM(IFF(TYP<REF(TYP,1),TYP*Volume,0),N);\n        MFI:100-(100/(1+V1));\n        "};GFormula.MI=function(a){return"INPUT:N("+a+",2,120);\n        A:CLOSE-REF(CLOSE,N);\n        MI:SMA(A,N,1);\n        "};
GFormula.MICD=function(a,b,f){return"INPUT:N("+a+",1,100),N1("+b+",1,100),N2("+f+",1,100);\n        MI1:CLOSE-REF(CLOSE,1);\n        AMI:=SMA(MI1,N,1);\n        DIF:MA(REF(AMI,1),N1)-MA(REF(AMI,1),N2);\n        MICD1:SMA(DIF,10,1);\n        "};GFormula.MIKE=function(a){return"INPUT:N("+a+",2,120)\n        HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);\n        HV:=EMA(HHV(HIGH,N),3);\n        LV:=EMA(LLV(LOW,N),3);\n        STOR:EMA(2*HV-LV,3);\n        MIDR:EMA(HLC+HV-LV,3);\n        WEKR:EMA(HLC*2-LV,3);\n        WEKS:EMA(HLC*2-HV,3);\n        MIDS:EMA(HLC-HV+LV,3);\n        STOS:EMA(2*LV-HV,3);\n        "};
GFormula.MTM=function(a,b){return"INPUT:N("+a+",2,120),M("+b+",2,60)\n        MTM:CLOSE-REF(CLOSE,N);\n        MTMMA:MA(MTM,M);\n        "};GFormula.NDB=function(){return"\n        Var1:=IFF((CLOSE-REF(CLOSE,1))/REF(CLOSE,1)>0.98,REF(CLOSE,1),LOW);\n        Var2:=IFF((CLOSE-REF(CLOSE,1))/REF(CLOSE,1)<-0.98,REF(CLOSE,1),HIGH);\n        Var3:=SUM(CLOSE-LOW-HIGH+CLOSE,0);\n        \u8111\u7535\u6ce2: Var3;\n        \u5e73\u5747\u503c5\u65e5: MA(Var3,5);\n        \u5e73\u5747\u503c10\u65e5: MA(Var3,10);\n        "};
GFormula.OBV=function(a){return"INPUT:M("+a+",2,100);\n        VA:=IFF(CLOSE>REF(CLOSE,1),Volume,Volume-Volume-Volume);\n        OBV:SUM(IFF(CLOSE==REF(CLOSE,1),0,VA),0);\n        MAOBV:MA(OBV,M);\n        "};GFormula.OSC=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        OSC:100*(CLOSE-MA(CLOSE,N));\n        MAOSC:EMA(OSC,M);\n        "};GFormula.PRICEOSC=function(a,b){return"INPUT:M1("+a+",1,300),M2("+b+",1,300);\n        PRICEOSC:(MA(CLOSE,M1) - MA(CLOSE,M2))/MA(CLOSE,M1)*100;\n        "};
GFormula.PVT=function(){return"\n        N:=CLOSE-REF(CLOSE,1);\n        M:=N/REF(CLOSE,1);\n        F:=M*Volume;\n        PVT:SUM(F,0);\n        "};GFormula.BBI=function(a,b,f,g){return"INPUT:M1("+a+",2,100),M2("+b+",2,100),M3("+f+",2,100),M4("+g+",2,100);\n        BBI:(MA(Close,M1)+MA(Close,M2)+MA(Close,M3)+MA(Close,M4))/4;\n        "};GFormula.BOLL=function(a){return"INPUT:M("+a+",2,999);\n        BOLL:MA(Close,M);\n        UPPER:BOLL+2*STD(Close,M);\n        lOWER:BOLL-2*STD(Close,M);\n        "};
GFormula.CHANNEL=function(a){return"INPUT:M1("+a+",0,1000);\n        MA1:=MA(Close,M1);\n        UPPER:MA1*1.025;\n        lOWER:MA1*0.975;\n        "};GFormula.RCCD=function(a,b,f){return"INPUT:N("+a+",1,200),N1("+b+",1,200),N2("+f+",1,200);\n        RC:=CLOSE/REF(CLOSE,N);\n        ARC:=SMA(REF(RC,1),N,1);\n        DIF:MA(REF(ARC,1),N1)-MA(REF(ARC,1),N2),precis4;\n        RCCD1:SMA(DIF,N,1),precis4;\n        "};GFormula.ROC=function(a,b){return"INPUT:N("+a+",2,120),M("+b+",2,60);\n        ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\n        MAROC:MA(ROC,M);\n        "};
GFormula.SI=function(){return"\n        LC:=REF(CLOSE,1);\n        AA:=ABS(HIGH-LC);\n        bb:=ABS(LOW-LC);\n        CC:=ABS(HIGH-REF(LOW,1));\n        DD:=ABS(LC-REF(OPEN,1));\n        R:=IFF(AA>bb AND AA>CC,AA+bb/2+DD/4,IFF(bb>CC AND bb>AA,bb+AA/2+DD/4,CC+DD/4));\n        X:=(CLOSE-LC+(CLOSE-OPEN)/2+LC-REF(OPEN,1));\n        SI:16*X/R*MAX(AA,bb);\n        "};GFormula.SKDJ=function(a,b){return"INPUT:N("+a+",2,90),N1("+b+",2,30);\n        LOWV:=LLV(LOW,N);\n        HIGHV:=HHV(HIGH,N);\n        RSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,N1);\n        K:EMA(RSV,N1);\n        D:MA(K,N1);\n        "};
GFormula.SRMI=function(a){return"INPUT:N("+a+",1,100);\n        SRMI:IFF(CLOSE<REF(CLOSE,N),(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),IFF(CLOSE==REF(CLOSE,N),0,(CLOSE-REF(CLOSE,N))/CLOSE));\n        "};GFormula.SD=function(a){return"INPUT:N("+a+",1,100);\n        SD:STD(CLOSE,N);\n        "};GFormula.TRIX=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        MTR:=EMA(EMA(EMA(CLOSE,N),N),N);\n        TRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\n        MATRIX:MA(TRIX,M);\n        "};
GFormula.UDL=function(a,b,f,g,e){return"INPUT:N1("+a+",2,20),N2("+b+",2,30),N3("+f+",2,60),N4("+g+",2,120),M("+e+",2,10);\n        UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;\n        MAUDL:MA(UDL,M);\n        "};GFormula.UOS=function(a,b,f,g){return"INPUT:N1("+a+",2,30),N2("+b+",2,60),N3("+f+",2,120),M("+g+",2,30);\n        TH:=MAX(HIGH,REF(CLOSE,1));\n        TL:=MIN(LOW,REF(CLOSE,1));\n        ACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);\n        ACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);\n        ACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);\n        UOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);\n        MAUOS:EMA(UOS,M);\n        "};
GFormula.VMA=function(a,b,f,g,e){return"INPUT:M1("+a+",2,500),M2("+b+",2,500),M3("+f+",2,500),M4("+g+",2,500),M5("+e+",2,500);\n        VV:=(HIGH+OPEN+LOW+CLOSE)/4;\n        VMA1:MA(VV,M1);\n        VMA2:MA(VV,M2);\n        VMA3:MA(VV,M3);\n        VMA4:MA(VV,M4);\n        VMA5:MA(VV,M5);\n        "};GFormula.VMACD=function(a,b,f){return"INPUT:SHORT("+a+",2,200),LONG("+b+",2,200),MID("+f+",2,200);\n        DIF:EMA(Volume/100,SHORT)-EMA(Volume/100,LONG);\n        DEA:EMA(DIF,MID);\n        MACD:DIF-DEA,COLORSTICK;\n        "};
GFormula.VOSC=function(a,b){return"INPUT:SHORT("+a+",2,100),LONG("+b+",15,200);\n        VOSC:(MA(Volume,SHORT)-MA(Volume,LONG))/MA(Volume,SHORT)*100;\n        "};GFormula.VPT=function(a,b){return"INPUT:N("+a+",2,120),M("+b+",2,60);\n        VPT:SUM(Volume/100*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);\n        MAVPT:MA(VPT,M);\n        "};GFormula.VR=function(a,b){return"INPUT:N("+a+",2,100),M("+b+",2,100);\n        TH:=SUM(IFF(CLOSE>REF(CLOSE,1),Volume,0),N);\n        TL:=SUM(IFF(CLOSE<REF(CLOSE,1),Volume,0),N);\n        TQ:=SUM(IFF(CLOSE==REF(CLOSE,1),Volume,0),N);\n        VR:100*(TH*2+TQ)/(TL*2+TQ);\n        MAVR:MA(VR,M);\n        "};
GFormula.VRSI=function(a,b,f){return"INPUT:N1("+a+",2,100),N2("+b+",2,100),N3("+f+",2,100);\n        LC:=REF(Volume,1);\n        RSI1:SMA(MAX(Volume-LC,0),N1,1)/SMA(ABS(Volume-LC),N1,1)*100;\n        RSI2:SMA(MAX(Volume-LC,0),N2,1)/SMA(ABS(Volume-LC),N2,1)*100;\n        RSI3:SMA(MAX(Volume-LC,0),N3,1)/SMA(ABS(Volume-LC),N3,1)*100;\n        "};GFormula.VSTD=function(a){return"INPUT:N1("+a+",1,100);\n        VSTD:STD(Volume,N1)\n        "};GFormula.WAD=function(a){return"INPUT:M("+a+",2,120);\n        MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);\n        MIDB:=IFF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);\n        WAD:SUM(IFF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);\n        MAWAD:MA(WAD,M);\n        "};
GFormula.XS=function(a){return"INPUT:N("+a+",2,120);\n        VAR2:=CLOSE*Volume;\n        VAR3:=EMA((EMA(VAR2,3)/EMA(Volume,3)+EMA(VAR2,6)/EMA(Volume,6)+EMA(VAR2,12)/EMA(Volume,12)+EMA(VAR2,24)/EMA(Volume,24))/4,N);\n        SUP:1.06*VAR3;\n        SDN:VAR3*0.94;\n        VAR4:=EMA(CLOSE,9);\n        LUP:EMA(VAR4*1.14,5);\n        LDN:EMA(VAR4*0.86,5);\n        "};GFormula.ZX=function(){return"\n        AV:AMOUNT/Volume;\n        "};GFormula.BB=function(a){return"INPUT:N("+a+",5,300)\n        b1:=MA(CLOSE,N);\n        \u5e03\u6797\u6781\u9650:100*(CLOSE-b1)/STD(CLOSE,N);\n        \u5e03\u6797K\u503c:EMA(\u5e03\u6797\u6781\u9650,3);\n        "};
GFormula.WVAD=function(a,b){return"INPUT:N("+a+",2,120),M("+b+",2,60);\n        WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*Volume,N)/10000;\n        MAWVAD:MA(WVAD,M);\n        "};GFormula.V_R=function(){return"\n        x:=(CLOSE-REF(CLOSE,1))/REF(CLOSE,1)*100;\n        VR=1.65*STD(x,250);\n        \u4e0a\u9650:(CLOSE+VR)/CLOSE,precis4;\n        \u4e0b\u9650:(CLOSE-VR)/CLOSE,precis4;\n        "};GFormula.MARSI=function(a,b){return"INPUT:M1("+a+",2,100),M2("+b+",2,60);\n        DIF:= CLOSE-REF(CLOSE,1);\n        VU:=IFF(DIF>=0,DIF,0);\n        VD:=IFF(DIF<0,DIF-DIF-DIF,0);\n        MAU1:=SMA(VU,M1,1);\n        MAD1:=SMA(VD,M1,1);\n        MAU2:=SMA(VU,M2,1);\n        MAD2:=SMA(VD,M2,1);\n        RSI1:MA(100*MAU1/(MAU1+MAD1),M1);\n        RSI2:MA(100*MAU2/(MAU2+MAD2),M2);\n        "};var SDK_REQUEST_QUOTESTATIC="GQuoteStatic",SDK_REQUEST_CUSTOMQUOTE="GRequestCustomQuote",SDK_REQUEST_QUOTESUBSCRIBE="GQuoteSubscribe",SDK_REQUEST_KLINE="GKLine",SDK_REQUEST_TREND="GTrend",SDK_REQUEST_CALLAUTION="GCallAution",SDK_REQUEST_HISTREND="GHisTrend",SDK_REQUEST_TICK="GTick",SDK_REQUEST_ORDER="GOrder",SDK_REQUEST_STEP="GStep",SDK_REQUEST_CANCELORDER="GCancelOrder",SDK_REQUEST_TRADEQUEUE="GTradeQueue",SDK_REQUEST_VOLUMEDISTRIBUTION="GVolumeDistribution",SDK_REQUEST_MONEYFLOW="GMoneyFlow",SDK_REQUEST_PRICEDISTRIBUTION=
"GPriceDistribution",SDK_REQUEST_SECTORCONSTITUENTS="GSectorConstituents",SDK_REQUEST_INDEXTOSECTOR="GIndexToSector",SDK_REQUEST_UPDOWNDISTRIBUTION="GUpDownDistribution",SDK_REQUEST_SORT="GSort",SDK_REQUEST_KEYWIZARD="GKeyWizard",SDK_REQUEST_NSTOCKINFO="NStockInfo",SDK_REQUEST_GSIMPLESNAPSHOT="GSimpleSnapshot",SDK_REQUEST_REQUESTCOMMON="GRequestCommon",SDK_KLINE_PERIOD_1MINUTE="1 minute",SDK_KLINE_PERIOD_5MINUTES="5 minutes",SDK_KLINE_PERIOD_15MINUTES="15 minutes",SDK_KLINE_PERIOD_30MINUTES="30 minutes",
SDK_KLINE_PERIOD_60MINUTES="60 minutes",SDK_KLINE_PERIOD_120MINUTES="120 minutes",SDK_KLINE_PERIOD_DAY="day",SDK_KLINE_PERIOD_WEEK="week",SDK_KLINE_PERIOD_MONTH="month",SDK_KLINE_PERIOD_QUARTER="quarter",SDK_KLINE_PERIOD_YEAR="year",SDK_KLINE_CQMODE_NONE="none",SDK_KLINE_CQMODE_FORWARD="forward",SDK_KLINE_CQMODE_BACKWARD="backward",SDK_SORTTYPE_DESC="DESC",SDK_SORTTYPE_ASC="ASC",SDK_SORTTYPE_NONE="NONE",SDK_KEYWIZARD_CATEGORY_ALL="all",SDK_KEYWIZARD_CATEGORY_STOCK="stock",SDK_KEYWIZARD_CATEGORY_INDEX=
"index",SDK_KEYWIZARD_CATEGORY_FUND="fund",SDK_KEYWIZARD_CATEGORY_BOND="bond",SDK_KEYWIZARD_CATEGORY_OPTION="option",SDK_KEYWIZARD_MARKET_SHSZHK="SH,SZ,HK",SDK_TRADEQUEUE_TYPE_ASK="ask",SDK_TRADEQUEUE_TYPE_BID="bid",SDK_TRADEQUEUE_TYPE_ALL="all",SDK_FORMULA_BB="BB",SDK_FORMULA_AD="AD",SDK_FORMULA_ADTM="ADTM",SDK_FORMULA_AMO="AMO",SDK_FORMULA_AMV="AMV",SDK_FORMULA_ARBR="ARBR",SDK_FORMULA_ASI="ASI",SDK_FORMULA_ATR="ATR",SDK_FORMULA_BBI="BBI",SDK_FORMULA_BBIBOLL="BBIBOLL",SDK_FORMULA_BIAS="BIAS",SDK_FORMULA_BIAS36=
"BIAS36",SDK_FORMULA_BOLL="BOLL",SDK_FORMULA_CCI="CCI",SDK_FORMULA_CHO="CHO",SDK_FORMULA_CHANNEL="CHANNEL",SDK_FORMULA_CR="CR",SDK_FORMULA_CYR="CYR",SDK_FORMULA_DBCD="DBCD",SDK_FORMULA_DDI="DDI",SDK_FORMULA_DMA="DMA",SDK_FORMULA_DMI="DMI",SDK_FORMULA_DPO="DPO",SDK_FORMULA_EMV="EMV",SDK_FORMULA_ENV="ENV",SDK_FORMULA_EXPMA="EXPMA",SDK_FORMULA_ICHIMOKU="ICHIMOKU",SDK_FORMULA_KD="KD",SDK_FORMULA_KDJ="KDJ",SDK_FORMULA_LWR="LWR",SDK_FORMULA_MA="MA",SDK_FORMULA_MACD="MACD",SDK_FORMULA_MARSI="MARSI",SDK_FORMULA_MASS=
"MASS",SDK_FORMULA_MFI="MFI",SDK_FORMULA_MI="MI",SDK_FORMULA_MICD="MICD",SDK_FORMULA_MIKE="MIKE",SDK_FORMULA_MTM="MTM",SDK_FORMULA_NDB="NDB",SDK_FORMULA_OBV="OBV",SDK_FORMULA_OSC="OSC",SDK_FORMULA_PBX="PBX",SDK_FORMULA_PRICEOSC="PRICEOSC",SDK_FORMULA_PSY="PSY",SDK_FORMULA_PVT="PVT",SDK_FORMULA_RCCD="RCCD",SDK_FORMULA_ROC="ROC",SDK_FORMULA_RSI="RSI",SDK_FORMULA_SAR="SAR",SDK_FORMULA_SI="SI",SDK_FORMULA_SKDJ="SKDJ",SDK_FORMULA_SRMI="SRMI",SDK_FORMULA_SD="SD",SDK_FORMULA_TRIX="TRIX",SDK_FORMULA_TWR=
"TWR",SDK_FORMULA_UDL="UDL",SDK_FORMULA_UOS="UOS",SDK_FORMULA_V_R="V&R",SDK_FORMULA_VMA="VMA",SDK_FORMULA_VMACD="VMACD",SDK_FORMULA_VOL="VOL",SDK_FORMULA_VOSC="VOSC",SDK_FORMULA_VPT="VPT",SDK_FORMULA_VR="VR",SDK_FORMULA_VRSI="VRSI",SDK_FORMULA_WVAD="WVAD",SDK_FORMULA_CDP="CDP",SDK_FORMULA_VSTD="VSTD",SDK_FORMULA_W_R="W&R",SDK_FORMULA_WAD="WAD",SDK_FORMULA_XS="XS",SDK_FORMULA_ZX="ZX",SDK_FIELD_CODE="Code",SDK_FIELD_NAME="Name",SDK_FIELD_MATCHVOLUME="MatchVolume",SDK_FIELD_STATE="State",SDK_FIELD_TIME=
"Time",SDK_FIELD_DATE="Date",SDK_FIELD_TRADINGDAY="TradingDay",SDK_FIELD_EXCHTIME="ExchTime",SDK_FIELD_VOLUME="Volume",SDK_FIELD_AMOUNT="Amount",SDK_FIELD_PERCENTCHANGE="PercentChange",SDK_FIELD_PRICE="Price",SDK_FIELD_LAST="Last",SDK_FIELD_LOW="Low",SDK_FIELD_HIGH="High",SDK_FIELD_OPEN="Open",SDK_FIELD_CLOSE="Close",SDK_FIELD_PRECLOSE="PreClose",SDK_FIELD_CHANGE="Change",SDK_FIELD_TRENDMAP="TrendMap",SDK_FIELD_PCTCHG_5M="PctChg_5m",SDK_FIELD_AMPLITUDE="Amplitude",SDK_FIELD_TRENDMINUTE="TrendMinute",
SDK_FIELD_TYPE="Type",SDK_FIELD_TRADINGCURRENCY="TradingCurrency",SDK_FIELD_LOTSIZE="LotSize",SDK_FIELD_TRADINGSTATUS="TradingStatus",SDK_FIELD_PREFIX="PreFix",SDK_FIELD_FREETEXT="FreeText",SDK_FIELD_HIGHLIMIT="HighLimit",SDK_FIELD_LOWLIMIT="LowLimit",SDK_FIELD_STEPBEGININDEX="StepBeginIndex",SDK_FIELD_ORDERNUMBER="OrderNumber",SDK_FIELD_ORDERTYPE="OrderType",SDK_FIELD_DEALLOTS="DealLots",SDK_FIELD_ASKPRICE1="AskPrice1",SDK_FIELD_BIDPRICE1="BidPrice1",SDK_FIELD_ASKVOLUME1="AskVolume1",SDK_FIELD_BIDVOLUME1=
"BidVolume1",SDK_FIELD_ASKVOLUMEDELTA1="AskVolumeDelta1",SDK_FIELD_BIDVOLUMEDELTA1="BidVolumeDelta1",SDK_FIELD_ASKPRICE2="AskPrice2",SDK_FIELD_BIDPRICE2="BidPrice2",SDK_FIELD_ASKVOLUME2="AskVolume2",SDK_FIELD_BIDVOLUME2="BidVolume2",SDK_FIELD_ASKVOLUMEDELTA2="AskVolumeDelta2",SDK_FIELD_BIDVOLUMEDELTA2="BidVolumeDelta2",SDK_FIELD_ASKPRICE3="AskPrice3",SDK_FIELD_BIDPRICE3="BidPrice3",SDK_FIELD_ASKVOLUME3="AskVolume3",SDK_FIELD_BIDVOLUME3="BidVolume3",SDK_FIELD_ASKVOLUMEDELTA3="AskVolumeDelta3",SDK_FIELD_BIDVOLUMEDELTA3=
"BidVolumeDelta3",SDK_FIELD_ASKPRICE4="AskPrice4",SDK_FIELD_BIDPRICE4="BidPrice4",SDK_FIELD_ASKVOLUME4="AskVolume4",SDK_FIELD_BIDVOLUME4="BidVolume4",SDK_FIELD_ASKVOLUMEDELTA4="AskVolumeDelta4",SDK_FIELD_BIDVOLUMEDELTA4="BidVolumeDelta4",SDK_FIELD_ASKPRICE5="AskPrice5",SDK_FIELD_BIDPRICE5="BidPrice5",SDK_FIELD_ASKVOLUME5="AskVolume5",SDK_FIELD_BIDVOLUME5="BidVolume5",SDK_FIELD_ASKVOLUMEDELTA5="AskVolumeDelta5",SDK_FIELD_BIDVOLUMEDELTA5="BidVolumeDelta5",SDK_FIELD_ASKPRICE6="AskPrice6",SDK_FIELD_BIDPRICE6=
"BidPrice6",SDK_FIELD_ASKVOLUME6="AskVolume6",SDK_FIELD_BIDVOLUME6="BidVolume6",SDK_FIELD_ASKVOLUMEDELTA6="AskVolumeDelta6",SDK_FIELD_BIDVOLUMEDELTA6="BidVolumeDelta6",SDK_FIELD_ASKPRICE7="AskPrice7",SDK_FIELD_BIDPRICE7="BidPrice7",SDK_FIELD_ASKVOLUME7="AskVolume7",SDK_FIELD_BIDVOLUME7="BidVolume7",SDK_FIELD_ASKVOLUMEDELTA7="AskVolumeDelta7",SDK_FIELD_BIDVOLUMEDELTA7="BidVolumeDelta7",SDK_FIELD_ASKPRICE8="AskPrice8",SDK_FIELD_BIDPRICE8="BidPrice8",SDK_FIELD_ASKVOLUME8="AskVolume8",SDK_FIELD_BIDVOLUME8=
"BidVolume8",SDK_FIELD_ASKVOLUMEDELTA8="AskVolumeDelta8",SDK_FIELD_BIDVOLUMEDELTA8="BidVolumeDelta8",SDK_FIELD_ASKPRICE9="AskPrice9",SDK_FIELD_BIDPRICE9="BidPrice9",SDK_FIELD_ASKVOLUME9="AskVolume9",SDK_FIELD_BIDVOLUME9="BidVolume9",SDK_FIELD_ASKVOLUMEDELTA9="AskVolumeDelta9",SDK_FIELD_BIDVOLUMEDELTA9="BidVolumeDelta9",SDK_FIELD_ASKPRICE10="AskPrice10",SDK_FIELD_BIDPRICE10="BidPrice10",SDK_FIELD_ASKVOLUME10="AskVolume10",SDK_FIELD_BIDVOLUME10="BidVolume10",SDK_FIELD_ASKVOLUMEDELTA10="AskVolumeDelta10",
SDK_FIELD_BIDVOLUMEDELTA10="BidVolumeDelta10",SDK_FIELD_ASKTIMEQUEUE="AskTimeQueue",SDK_FIELD_BIDTIMEQUEUE="BidTimeQueue",SDK_FIELD_ASKVOLUMEQUEUE="AskVolumeQueue",SDK_FIELD_BIDVOLUMEQUEUE="BidVolumeQueue",SDK_FIELD_AVGASKPRICE="AvgAskPrice",SDK_FIELD_AVGBIDPRICE="AvgBidPrice",SDK_FIELD_TOTALASKVOLUME="TotalAskVolume",SDK_FIELD_TOTALBIDVOLUME="TotalBidVolume",SDK_FIELD_TOTALASKORDERS="TotalAskOrders",SDK_FIELD_TOTALBIDORDERS="TotalBidOrders",SDK_FIELD_IOPV="IOPV",SDK_FIELD_VWAP="VWAP",SDK_FIELD_VOLUMEDELTA=
"VolumeDelta",SDK_FIELD_VOLUMERATIO="VolumeRatio",SDK_FIELD_PCTCHG_1M="PctChg_1m",SDK_FIELD_PCTCHG_15M="PctChg_15m",SDK_FIELD_ASKBIDDELTA="AskBidDelta",SDK_FIELD_ASKBIDRATIO="AskBidRatio",SDK_FIELD_BUYVOLUME="BuyVolume",SDK_FIELD_SELLVOLUME="SellVolume",SDK_FIELD_SELLBUYRATIO="SellBuyRatio",SDK_FIELD_ASKORDERNUMBER="AskOrderNumber",SDK_FIELD_BIDORDERNUMBER="BidOrderNumber",SDK_FIELD_LASTSHARE="LastShare",SDK_FIELD_NETVALUE="NetValue",SDK_FIELD_INTEREST="Interest",SDK_FIELD_CLEARINGPRICE="ClearingPrice",
SDK_FIELD_EXCHTIMEAUCTION="ExchTimeAuction",SDK_FIELD_BIDORDERLOTS="BidOrderLots",SDK_FIELD_ASKORDERLOTS="AskOrderLots",SDK_FIELD_PREVCLEARINGPRICE="PrevClearingPrice",SDK_FIELD_PREVCONTRACTPOSITION="PrevContractPosition",SDK_FIELD_CONTRACTPOSITION="ContractPosition",SDK_FIELD_RISECOUNT="RiseCount",SDK_FIELD_FALLCOUNT="FallCount",SDK_FIELD_SUSPENSIONCOUNT="SuspensionCount",SDK_FIELD_COMPONENT_NUM="Component_Num",SDK_FIELD_MARKETVALUE="MarketValue",SDK_FIELD_FLOATVALUE="FloatValue",SDK_FIELD_MAINFUNDSNETINFLOW=
"MainFundsNetinFlow",SDK_FIELD_BLOCKID="blockid",SDK_FIELD_PB="PB",SDK_FIELD_EPS="EPS",SDK_FIELD_PE_TTM="PE_TTM",SDK_FIELD_TURNOVERRATE="TurnoverRate",SDK_FIELD_PCTCHG_YTD="PctChg_Ytd",SDK_FIELD_PCTCHG_3D="PctChg_3d",SDK_FIELD_PCTCHG_5D="PctChg_5d",SDK_FIELD_PCTCHG_10D="PctChg_10d",SDK_FIELD_PCTCHG_20D="PctChg_20d",SDK_FIELD_PCTCHG_60D="PctChg_60d",SDK_FIELD_PCTCHG_120D="PctChg_120d",SDK_FIELD_PCTCHG_250D="PctChg_250d",SDK_FIELD_MAINFUNDSRATE="MainFundsRate",SDK_FIELD_UPPCTCHANGE="UpPctChange",SDK_FIELD_DOWNPCTCHANGE=
"DownPctChange",SDK_FIELD_UPVOLUME="UpVolume",SDK_FIELD_SCOPENAME="ScopeName",SDK_FIELD_SCOPEVALUE="ScopeValue",SDK_FIELD_UPDOWNVALUE="UpDownValue",SDK_FIELD_SELL_LIST="Sell_List",SDK_FIELD_BUY_LIST="Buy_List",SDK_FIELD_PREMARKETVALUE="PreMarketValue",SDK_FIELD_MARKETVALUECHANGE="MarketValueChange",SDK_FIELD_FLOAT="Float",SDK_FIELD_TOTALSHARE="TotalShare",SDK_FIELD_FLOATVALUEOPEN="FloatValueOpen",SDK_FIELD_FLOATVALUEPRECLOSE="FloatValuePreClose",SDK_FIELD_PE="PE",SDK_FIELD_SELLRATIO="SellRatio",SDK_FIELD_BUYRATIO=
"BuyRatio",SDK_FIELD_PERCENTCHANGEOPEN="PercentChangeOpen",SDK_FIELD_YTDPCTCHG="YTDPctChg",SDK_FIELD_LOW_52W="Low_52w",SDK_FIELD_HIGH_52W="High_52w",SDK_FIELD_RISERATIO="RiseRatio",SDK_FIELD_MARKETHEALTH="MarketHealth",SDK_FIELD_FALLPCTCHANGE="FallPctChange",SDK_FIELD_RISEDISTRIBUTION="RiseDistribution",SDK_FIELD_RISEANDFALL="RiseAndFall",SDK_FIELD_LISTEDDAYS="ListedDays",SDK_FIELD_FLOATVALUEAVG="FloatValueAvg",SDK_FIELD_ADJUDGEDMV="AdjudgedMV",SDK_FIELD_AVGVOL5="AvgVol5",SDK_FIELD_NAPS="NAPS",SDK_FIELD_PCTCHG_750D=
"PctChg_750d",SDK_FIELD_PREMIUMRATE="PremiumRate",SDK_FIELD_PRISTATVOLMAX="PriStatVolMax",SDK_FIELD_VOLSTATBSVOLMAX="VolStatBSVolMax",SDK_FIELD_VOLSTATTOTVOLMAX="VolStatTotVolMax",SDK_FIELD_VOLSTATRANGEARR="VolStatRangeArr",SDK_FIELD_VOLSTATBUYVOLARR="VolStatBuyVolArr",SDK_FIELD_VOLSTATSELLVOLARR="VolStatSellVolArr",SDK_FIELD_VOLSTATNEUVOLARR="VolStatNeuVolArr",SDK_FIELD_MAXVOLUME="MaxVolume",SDK_FIELD_ACCER_3M="PctChg_3m",SDK_FIELD_VWAP_YDA="VWAP_YDA",SDK_FIELD_REMAINDATE="RemainDate",SDK_FIELD_TRADEBSFLAG=
"TradeBSFlag",SDK_FIELD_ORDERSIDE="OrderSide",SDK_FIELD_CANCELORDERNUMBER="CancelOrderNumber",SDK_REQUESTCOMMON_FIELDS="fields",SDK_REQUESTCOMMON_PAGENO="pageNo",SDK_REQUESTCOMMON_PAGESIZE="pageSize",SDK_FIELD_SECURITYTYPE="SecurityType",SDK_FIELD_RISKFLAG="RISKFlag",SDK_FIELD_DLFLAG="DLFlag",SDK_FIELD_UDFLAG="UDFlag",SDK_FIELD_BUYQTYUPPERLIMIT="BuyQtyUpperLimit",SDK_FIELD_SELLQTYUPPERLIMIT="SellQtyUpperLimit",SDK_FIELD_MARKETBUYQTYUPPERLIMIT="MarketBuyQtyUpperLimit",SDK_FIELD_MARKETSELLQTYUPPERLIMIT=
"MarketSellQtyUpperLimit",SDK_FIELD_AFSELLQTYUPPERLIMIT="AFSellQtyUpperLimit",SDK_FIELD_REGISTRATIONFLAG="RegistrationFlag",SDK_FIELD_VIEFLAG="VIEFlag",SDK_FIELD_MARKETIZATIONFLAG="MFFlag",SDK_FIELD_RSLFFLAG="RSLFFlag",SDK_FIELD_MMFFLAG="MMFFlag",SDK_FIELD_HASAUCTIONLIMIT="HasAuctionLimit",SDK_FIELD_AUCTIONLIMITTYPE="AuctionLimitType",SDK_FIELD_AUCTIONREFERPRICETYPE="AuctionReferPriceType",SDK_FIELD_AUCTIONUPDOWNRATE="AuctionUpDownRate",SDK_FIELD_AUCTIONUPDOWNABSOLUTE="AuctionUpDownAbsolute",SDK_FIELD_MPDECLARUPPERLIMIT=
"MPDeclarUpperLimit",SDK_FIELD_MPDECLARLOWERLIMIT="MPDeclarLowerLimit",SDK_FIELD_VOTEFLAG="VoteFlag",SDK_FIELD_UNPROFITABLEFLAG="UnprofitableFlag",SDK_FIELD_PLDECLARUPPERLIMIT="PLDeclarUpperLimit",SDK_FIELD_PLDECLARLOWERLIMIT="PLDeclarLowerLimit",SDK_FIELD_ISLISTDATE="IsListDate",SDK_FIELD_ISEXRIGHT="IsExRight",SDK_FIELD_ISEXDIVI="IsExDivi",SDK_FIELD_ISEARLYSTAGE="IsEarlyStage",SDK_FIELD_UDFLAG_O="UDFlag_O",SDK_FIELD_HASAUCTIONLIMIT_O="HasAuctionLimit_O",SDK_FIELD_AUCTIONLIMITTYPE_O="AuctionLimitType_O",
SDK_FIELD_AUCTIONREFERPRICETYPE_O="AuctionReferPriceType_O",SDK_FIELD_AUCTIONUPDOWNRATE_O="AuctionUpDownRate_O",SDK_FIELD_AUCTIONUPDOWNABSOLUTE_O="AuctionUpDownAbsolute_O",SDK_FIELD_UDFLAG_C="UDFlag_C",SDK_FIELD_HASAUCTIONLIMIT_C="HasAuctionLimit_C",SDK_FIELD_AUCTIONLIMITTYPE_C="AuctionLimitType_C",SDK_FIELD_AUCTIONREFERPRICETYPE_C="AuctionReferPriceType_C",SDK_FIELD_AUCTIONUPDOWNRATE_C="AuctionUpDownRate_C",SDK_FIELD_AUCTIONUPDOWNABSOLUTE_C="AuctionUpDownAbsolute_C",SDK_FIELD_UNDERLYINGCODE="UnderlyingCode",
SDK_FIELD_AFTERTRADEVOLUME="AfterTradeVolume",SDK_FIELD_AFTERTRADEVALUE="AfterTradeValue",SDK_FIELD_AFTERTRADELOTS="AfterTradeLots",SDK_FIELD_PESTATIC="PESTATIC",SDK_FIELD_PEDYNAMIC="PEDYNAMIC",SDK_FIELD_UPNDAY="UPNDAY",SDK_FIELD_PCTCHGYDA="PctChgYDA",SDK_USERSECTOR_GET="userdata/userSector/listUserSectorById",SDK_USERSECTOR_ADD="userdata/userSector/addUserSectorCatalogue",SDK_USERSECTOR_EDIT="userdata/userSector/updateUserSectorCatalogue",SDK_USERSECTOR_DELETE="userdata/userSector/deleteUserSectorCatalogue",
SDK_USERSECTOR_MOVE="userdata/userSector/sortUserSectorCatalogue",SDK_USERSECTOR_USERID="userid",SDK_USERSECTOR_FIELDS="fields",SDK_USERSECTOR_FIELDS_VALUE="sectorid,sectorname",SDK_USERSECTOR_SECTORNAME="sectorName",SDK_USERSECTOR_SECTORID="sectorId",SDK_USERSECTOR_TARGETINDEX="targetIndex",SDK_USERSECURITY_GET="userdata/sectorSecurity/findUserSectorSecuritys",SDK_USERSECURITY_ADD="userdata/sectorSecurity/addUserSectorSecuritys",SDK_USERSECURITY_EDIT="userdata/userSector/updateUserSectorCatalogue",
SDK_USERSECURITY_DELETE="userdata/sectorSecurity/deleteUserSectorSecuritys",SDK_USERSECURITY_CLEAR="userdata/sectorSecurity/deleteAllSecuritys",SDK_USERSECURITY_MOVE="userdata/sectorSecurity/sortUserSectorSecuritys",SDK_USERSECURITY_USERID="userid",SDK_USERSECURITY_SECTORID="sectorId",SDK_USERSECURITY_SECURITYS="securitys",SDK_USERSECURITY_SECURITYCODE="securitycode",SDK_USERSECURITY_TARGETINDEX="targetIndex",SDK_TRANSCONNECTINFO="consultplatform/consult/check/search/sdk_trans_connect_info",SDK_TRANSCONNECTINFO_TRADETYPE=
"trade_type",SDK_TRANSCONNECTINFO_HGT="\u6caa\u80a1\u901a",SDK_TRANSCONNECTINFO_SGT="\u6df1\u80a1\u901a",SDK_TRANSCONNECTINFO_GGTH="\u6e2f\u80a1\u901a\uff08\u6caa\uff09",SDK_TRANSCONNECTINFO_GGTS="\u6e2f\u80a1\u901a\uff08\u6df1\uff09",SDK_TRANSCONNECTINFO_TRADEDATE="trade_date",SDK_TRANSCONNECTINFO_TURNOVERAMT="turnover_amt",SDK_TRANSCONNECTINFO_BUYAMT="buy_amt",SDK_TRANSCONNECTINFO_SELLAMT="sell_amt",SDK_TRANSCONNECTINFO_TURNOVERDEAL="turnover_deal",SDK_TRANSCONNECTINFO_BUYDEAL="buy_deal",SDK_TRANSCONNECTINFO_SELLDEAL=
"sell_deal",SDK_TRANSCONNECTINFO_QUOTABAL="quota_bal",SDK_TRANSCONNECTINFO_PCTOFQUOTABAL="pct_of_quota_bal",SDK_TRANSCONNECTDETAIL="consultplatform/consult/check/search/sdk_trans_connect_detail",SDK_TRANSCONNECTDETAIL_SECURITYABBR="security_abbr",SDK_TRANSCONNECTDETAIL_GCODE="gangtise_code",SDK_TRANSCONNECTDETAIL_TRADEDATE="trade_date",SDK_TRANSCONNECTDETAIL_TRADETYPE="trade_type",SDK_TRANSCONNECTDETAIL_HOLDSHARE="hold_share",SDK_TRANSCONNECTDETAIL_PCTOFTOTALSHARE="pct_of_total_share",SDK_TRANSBLOCKTRADE=
"consultplatform/consult/check/search/sdk_trans_block_trade",SDK_TRANSBLOCKTRADE_SECURITYABBR="security_abbr",SDK_TRANSBLOCKTRADE_GCODE="gangtise_code",SDK_TRANSBLOCKTRADE_TRADEDATE="trade_date",SDK_TRANSBLOCKTRADE_EXCHGMARKET="exchg_market",SDK_TRANSBLOCKTRADE_BUYDEPTNAME="buy_dept_name",SDK_TRANSBLOCKTRADE_SELLDEPTNAME="sell_dept_name",SDK_TRANSBLOCKTRADE_TRADEPRICE="trade_price",SDK_TRANSBLOCKTRADE_TURNOVERVOL="turnover_vol",SDK_TRANSBLOCKTRADE_TURNOVERAMT="turnover_amt",SDK_TRANSMARGININFO="consultplatform/consult/check/search/sdk_trans_margin_info",
SDK_TRANSMARGININFO_TRADEDATE="trade_date",SDK_TRANSMARGININFO_FINCAMT="finc_amt",SDK_TRANSMARGININFO_FINCPRCHAMT="finc_prch_amt",SDK_TRANSMARGININFO_FINCREPAYAMT="finc_repay_amt",SDK_TRANSMARGININFO_LENDAMT="lend_amt",SDK_TRANSMARGININFO_LENDSALEVOL="lend_sale_vol",SDK_TRANSMARGININFO_LENDVOL="lend_vol",SDK_TRANSMARGININFO_LENDREPAYVOL="lend_repay_vol",SDK_TRANSMARGININFO_MARGINAMT="margin_amt",SDK_TRANSMARGINDETAIL="consultplatform/consult/check/search/sdk_trans_margin_detail",SDK_TRANSMARGINDETAIL_SECURITYABBR=
"security_abbr",SDK_TRANSMARGINDETAIL_GCODE="gangtise_code",SDK_TRANSMARGINDETAIL_TRADEDATE="trade_date",SDK_TRANSMARGINDETAIL_FINCAMT="finc_amt",SDK_TRANSMARGINDETAIL_FINCPRCHAMT="finc_prch_amt",SDK_TRANSMARGINDETAIL_FINCREPAYAMT="finc_repay_amt",SDK_TRANSMARGINDETAIL_LENDAMT="lend_amt",SDK_TRANSMARGINDETAIL_LENDSALEVOL="lend_sale_vol",SDK_TRANSMARGINDETAIL_LENDVOL="lend_vol",SDK_TRANSMARGINDETAIL_LENDREPAYVOL="lend_repay_vol",SDK_TRANSMARGINDETAIL_MARGINAMT="margin_amt",SDK_TRANSEXCHGDETAIL="consultplatform/consult/check/search/sdk_trans_exchg_detail",
SDK_TRANSEXCHGDETAIL_TRADEDATE="trade_date",SDK_TRANSEXCHGDETAIL_SECURITYABBR="security_abbr",SDK_TRANSEXCHGDETAIL_GCODE="gangtise_code",SDK_TRANSEXCHGDETAIL_FLCTTYPENAME="flct_type_name",SDK_TRANSEXCHGDETAIL_TRADEDIR="trade_dir",SDK_TRANSEXCHGDETAIL_DEPTSERIAL="dept_serial",SDK_TRANSEXCHGDETAIL_DEPTNAME="dept_name",SDK_TRANSEXCHGDETAIL_BUYAMT="buy_amt",SDK_TRANSEXCHGDETAIL_SELLAMT="sell_amt",SDK_FIELD_DILUTEDEPS="DilutedEPS",SDK_FIELD_ROE="ROE",SDK_FIELD_AHLINKAGE="AHLinkage",SDK_FIELD_ABLINKAGE=
"ABLinkage",SDK_FIELD_CBLINKAGE="CBLinkage",SDK_FIELD_GDR_PREMIUMRATE="GDR_PremiumRate",SDK_FIELD_GDR_CLOSEPRICE="GDR_ClosePrice",SDK_FIELD_GDR_CONVERSIONRATIO="GDR_ConversionRatio",SDK_FIELD_GDRSHARE="GDR_Share",SDK_OPTCONTRACT_TRADEDATE="consultplatform/optcontract/queryLastTradeDate",SDK_OPTCONTRACT_ID="undlie_gangtise_code",SDK_OPTCONTRACT_REAL="is_real",SDK_OPTCONTRACT_EXERCISEPRICEINFO="consultplatform/optcontract/queryExercisePriceInfo",SDK_OPTCONTRACT_DATE="last_trade_date",STEPALLORDERFIELDS=
[["Time","tms"],["DealNumber","i"],["BidOrderNumber","i"],["AskOrderNumber","i"],["Price","x2!"],["Volume","i2!"],["DealType","t"]],MAINQUOTE_CONNECT_SUCCESS=1002001E3,MAINQUOTE_DISCONNECT_NORMAL=1002001001,MAINQUOTE_DISCONNECT_ABNORMAL=1002001002,MAINQUOTE_CONNECT_FAILED=1002001003,MAINQUOTE_DISCONNECT_FAILED=1002001004,MAINQUOTE_CONN_CLOSED_BY_HOST=1002001005,MAINQUOTE_RECONNECT_FAILED=1002001006,HTTPLOGIN_CHANGE_WEBSITE_FAILED=1002001009,MAINQUOTE_RECONNECT_SUCCESS=1002001010,SERVER_ERROR=1002001011,
MAINQUOTE_REFRESH_TOKEN_INVALID=1002001016,MAINQUOTE_SYS_MSG=1002001018,MAINQUOTE_KICK_EACH_OTHER=1002001019,MAINQUOTE_UNKNOW_CODE=1002002001,MAINQUOTE_PARAM_CHECK_FAIL=1002002002,MAINQUOTE_CONNECT_SIGN_FAILED=1002001020,HTTPLOGIN_RELOGIN=1002001007,HTTPLOGIN_CHANGE_WEBSITE=1002001008,HTTPREQUEST_ERROR_RETRY=1002001012,HTTPREQUEST_QUIT=1002001013,SUBSCRIBE_LIMIT=1002001014,MAINQUOTE_UNUSE=1002001015,HTTOLOGIN_RECONNECT=1002001017;var GDataType=Object.freeze({text:"text",array_text:"array-text",time:"time",date:"date",double:"double",graph:"graph",timescale:"timescale",int:"int",array_int:"array-int"});function GResponse(){this.data=this.itemId=this.seqId=this.msg=this.statusCode=this.success=null}
function GColumnInfo(a){var b=a.index,f=a.name,g=a.type,e=a.remark,h=a.dec;this.getIndex=function(){return b};this.getName=function(){return f};this.getDataType=function(){return g};this.getRemark=function(){return e};this.getDec=function(){return h}}function GCellData(){this.getValueText=function(){};this.getRawData=function(){};this.getIsValid=function(){};this.getDecimal=function(){};this.getColorFlags=function(){};this.getUpDownFlags=function(){}}
function GDataSet(a){var b=a.name,f=a.rowCount,g=a.colCount,e=a.begin,h=a.totalRows,m=a.columnInfos,l=a.dataSource;this.getName=function(){return b};this.getBegin=function(){return e};this.getRowCount=function(){return f};this.getTotalRows=function(){return h};this.getColCount=function(){return g};this.getColumnInfos=function(){return m};this.getDataSource=function(){return l};this.getColumn=function(n){var p=this.getColumnInfos(),q;for(q in p)if(p[q].getIndex()==n)return p[q]};this.getColumnByName=
function(n){for(var p=this.getColumnInfos(),q=0;q<p.length;q++){var v=p[q];if(v.getName().toLowerCase()==n.toLowerCase())return v}};this.getCellData=function(n,p){var q=this.getDataSource(),v=q.data[p];if(v&&(v=v[n],void 0!==v)){var u=q.field[p][1],D;if(null!=q.flags){var F=q.field[p][0];null!=q.flags[F.toLowerCase()]&&(D=q.flags[F.toLowerCase()][n])}v=null==v?"-":v;if(null!=v){null==q.cellData&&(q.cellData=[]);null==q.cellData[p]&&(q.cellData[p]=[]);if(null==q.cellData[p][n]||q.cellData[p][n].getRawData()!=
v){F=new GCellData;var z=""+GDataTool.getValueFormatString(v,u,null,D),y=v,B=GDataTool.GETGFLAG_COLOR(D),t=1==GDataTool.GETGFLAG_ISINVALID(D)?0:1,G=GDataTool.GETGFLAG_DEC(D);u&&-1==G&&("i"==u[0]?G=0:1<u.length&&(v=u.slice(1,2),isNumberWithStr(v)&&(G=parseInt(v))));var x=GDataTool.GET_UP_DOWN_FLAGS(D);F.getValueText=function(){return z};F.getRawData=function(){return y};F.getIsValid=function(){return t};F.getDecimal=function(){return G};F.getColorFlags=function(){return B};F.getUpDownFlags=function(){return x};
q.cellData[p][n]=F}return q.cellData[p][n]}}};this.getCellDataByName=function(n,p){if(p=this.getColumnByName(p))return p=p.getIndex(),this.getCellData(n,p)};this.getCellText=function(n,p){n=this.getCellData(n,p);return null==n?"-":n.getValueText()};this.getCellTextByName=function(n,p){p=this.getColumnByName(p).getIndex();return this.getCellText(n,p)};this.getColValues=function(n){return this.getDataSource().data[n]};this.getColValuesByName=function(n){if(n=this.getColumnByName(n))return this.getColValues(n.getIndex())};
this.getRowValues=function(n){for(var p=[],q=this.getColumnInfos(),v=0;v<q.length;v++){var u=q[v].getName();u=this.getCellTextByName(n,u);p.push(u)}return p}};var GRequestCommon=function(){this.flagName="GRequestCommon";var a=null,b={},f=""+NSDK.count++,g=null,e={},h=new Calibration(this);this.firstCallbackFlag=!0;this.setDataCallback=function(m){NSDKLog.info("SZSE:(GRequestCommon.setDataCallback)\u8bbe\u7f6e\u6570\u636e\u56de\u8c03");g=m};this.getDataCallback=function(){return g};this.checkParams=function(){var m=h.check(e);return m?m:!1};this.setAPI=function(m){a=m};this.setParam=function(m,l){if("{{ userid }}"==l||"{{ userId }}"==l){var n=GTenant.sharedInstance().getUserData();
null!=n&&null!=n.user_id&&(l="'"+n.user_id+"'")}"fields"==m.toLowerCase()&&(m="fields");"condition"==m.toLowerCase()?(m="condition",null==b[m]?b[m]=[l]:b[m].push(l)):b[m]=l};this.clearParams=function(){b={};a=null;e={}};this.setInputValue=function(m,l){e[m]=l};this.getInputValue=function(){return e};this.getItemId=function(){return f};this.setRange=function(m,l,n){var p="";null!=m&&(null!=l&&(p+=m+" >= '"+l+"'"),null!=n&&(p+=" and "+m+" <= '"+n+"'"),this.setParam("condition",p))};this.setSortField=
function(m,l){m&&l&&l!==SDK_SORTTYPE_NONE&&this.setParam("condition",m+" order "+l)};this.request=function(){if("string"!==typeof a)NSDKLog.error("SZSE: setAPI \u53c2\u6570\u7c7b\u578b\u9519\u8bef");else{if(a){this.firstCallbackFlag=!0;NSDKLog.info("SZSE:(GRequestCommon.request)\u53d1\u9001\u8bf7\u6c42: {_id: "+f+", _url: "+a+"}");var m=NSDK.requestId++;if(null!=b.condition){for(var l=b.condition,n=l[0],p=1;p<l.length;p++)n+=" and "+l[p];b.condition=n}l=b.pageNo;n=b.pageSize;delete b.pageNo;delete b.pageSize;
null!=l&&null!=n&&(b.limit=l+","+n);l={type:CONNECT_TYPE.HTTP_TYPE,itemId:f,seqId:m,url:a,params:b};GDataManager.sharedInstance().fireData(l);return m}NSDKLog.error("SZSE:(GRequestCommon.request)setAPI\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a")}}},GKeyWizard=function(){GRequestCommon.call(this);this.flagName="GKeyWizard";this.setCategory=function(a){this.setInputValue(GKeyWizard.inputParam.CATEGORY,a)};this.setMarket=function(a){this.setInputValue(GKeyWizard.inputParam.MARKET,a)};this.setPageNo=function(a){this.setInputValue(GKeyWizard.inputParam.PAGENO,
a)};this.setPageSize=function(a){this.setInputValue(GKeyWizard.inputParam.PAGESIZE,a)};this.setFields=function(a){this.setInputValue(GKeyWizard.inputParam.FIELDS,a)};this.match=function(a){var b=this.checkParams();b&&("string"!==typeof a||""===a?NSDKLog.log("SZSE:(GRequestCommon.match)match \u51fd\u6570\u9700\u8981\u4f20\u9012\u975e\u7a7a\u5b57\u7b26\u4e32"):(this.setAPI("keyboardsearch/secu/search/query"),this.setParam("fields",b[GKeyWizard.inputParam.FIELDS]),this.setParam("keyword",a),this.setParam("category",
b[GKeyWizard.inputParam.CATEGORY]),this.setParam("market",b[GKeyWizard.inputParam.MARKET]),this.setParam("limit",b[GKeyWizard.inputParam.PAGENO]+","+b[GKeyWizard.inputParam.PAGESIZE]),this.request()))}};$jscomp.inherits(GKeyWizard,GRequestCommon);GKeyWizard.inputParam={CATEGORY:"category",MARKET:"market",FIELDS:"fields",PAGENO:"pageNo",PAGESIZE:"pageSize"};
var NStockInfo=function(){GRequestCommon.call(this);this.flagName="NStockInfo";var a=this.request;this.setCodes=function(b){this.setInputValue(NStockInfo.inputParam.CODES,b)};this.setFields=function(b){this.setInputValue(NStockInfo.inputParam.FIELDS,b)};this.request=function(){var b=this.checkParams();if(b){this.setAPI("consultplatform/base/securityInformation");var f=b[NStockInfo.inputParam.FIELDS];"$all"===f?this.setParam("fields","Code,Name,SectorID,IndexCode,SectorName,MarginTrade,StockConnect,ExchgMarket,SecuCategory,DilutedEPS,ROE,AHLinkage,ABLinkage,CBLinkage,GDR_PremiumRate,GDR_ClosePrice,GDR_ConversionRatio,GDR_Share"):
f&&0<f.trim().length?this.setParam("fields",f):this.setParam("fields","Code,Name");this.setParam("codes",b[NStockInfo.inputParam.CODES]);a.call(this,b)}}};$jscomp.inherits(NStockInfo,GRequestCommon);NStockInfo.inputParam={CODES:"codes",FIELDS:"fields"};var GRequestQuote=function(a){this.flagName="GRequestQuote";var b={},f=null,g=null,e=a?a:""+NSDK.count++,h=new Calibration(this),m={};this.dataStatus;this.firstCallbackFlag=!0;this.setDataCallback=function(l){NSDKLog.info("SZSE:(GRequestQuote.setDataCallback)\u8bbe\u7f6e\u6570\u636e\u56de\u8c03");g=l};this.setAPI=function(l){f=l};this.setParam=function(l,n){b[l]=n};this.request=function(){this.firstCallbackFlag=!0;NSDKLog.info("SZSE:(GRequestQuote.request)\u53d1\u9001\u8bf7\u6c42: {_id: "+e+", _url: "+
f+"}");GDataManager.sharedInstance().cancelPushData(e);this.dataStatus=null;var l={type:CONNECT_TYPE.WS_TYPE,itemId:e,seqId:0,url:f,params:xDeepCopy(b),subscribe:!0};if(this instanceof GKLine&&this.REQMODE==GKLINEREQMODE.REQ_DATARANGE){var n=new Date,p=String(n.getDate()).padStart(2,0);n=""+n.getFullYear()+String(n.getMonth()+1).padStart(2,0)+p;p=m[GKLine.inputParam.BEGINDATE];if(Number(m[GKLine.inputParam.ENDDATE])<Number(n)||Number(p)>Number(n))l.subscribe=!1}this instanceof GHisTrend&&(l.subscribe=
!1);GDataManager.sharedInstance().fireData(l);return 0};this.clearParams=function(){f=null;b={};m={}};this.checkParams=function(){var l=h.check(m);return l?l:!1};this.cancel=function(){NSDKLog.info("SZSE:(GRequestQuote.cancel)\u53d6\u6d88\u8bf7\u6c42: "+e);GDataManager.sharedInstance().cancelPushData(e)};this.getDataCallback=function(){return g};this.getItemId=function(){return e};this.setInputValue=function(l,n){m[l]=n};this.getInputValue=function(){return m};this.getRequestValue=function(){return b}};
GRequestQuote.inputParam={SUBSCRIBE:"subscribe"};
var GSeQuence=function(){GRequestQuote.call(this);this.flagName="GSeQuence";var a=this.request;this.setCode=function(b){this.setInputValue(GSeQuence.inputParam.CODE,b)};this.setLimit=function(b,f){this.setInputValue(GSeQuence.inputParam.BEGIN,b);this.setInputValue(GSeQuence.inputParam.COUNT,f)};this.request=function(b){var f=b[GSeQuence.inputParam.BEGIN],g=b[GSeQuence.inputParam.COUNT];this.setParam("keys","'"+b[GSeQuence.inputParam.CODE]+"'");this.setParam("limit",f+","+g);a.call(this)}};
$jscomp.inherits(GSeQuence,GRequestQuote);GSeQuence.inputParam={CODE:"code",BEGIN:"begin",COUNT:"count"};
var GQuoteSubscribe=function(){GRequestQuote.call(this);this.flagName="GQuoteSubscribe";var a=null,b=null,f=this.request,g=this.clearParams;this.setCodes=function(e){a=e;this.setInputValue(GQuoteSubscribe.inputParam.CODES,a)};this.addCodes=function(e){var h=null==a?[]:a.split(",");e=e.split(",");for(var m=0;m<e.length;m++)-1==h.indexOf(e[m])&&h.push(e[m]);a=h.toString();this.setInputValue(GQuoteSubscribe.inputParam.CODES,a)};this.delCodes=function(e){var h=null==a?[]:a.split(",");e=e.split(",");for(var m=
0;m<e.length;m++){var l=h.indexOf(e[m]);-1!=l&&h.splice(l,1)}a=h.toString();this.setInputValue(GQuoteSubscribe.inputParam.CODES,a)};this.setFields=function(e){b=e.toLocaleLowerCase();this.setInputValue(GQuoteSubscribe.inputParam.FIELDS,b)};this.addFields=function(e){var h=null==b?[]:b.split(",");e=e.toLocaleLowerCase().split(",");for(var m=0;m<e.length;m++)-1==h.indexOf(e[m])&&h.push(e[m]);b=h.toString();this.setInputValue(GQuoteSubscribe.inputParam.FIELDS,b)};this.delFields=function(e){var h=null==
b?[]:b.split(",");e=e.toLocaleLowerCase().split(",");for(var m=0;m<e.length;m++){var l=h.indexOf(e[m]);-1!=l&&h.splice(l,1)}b=h.toString();this.setInputValue(GQuoteSubscribe.inputParam.FIELDS,b)};this.request=function(){var e=this.checkParams();if(e){for(var h="",m=e[GQuoteSubscribe.inputParam.CODES].split(","),l=0;l<m.length;l++)l==m.length-1?h+="'"+m[l]+"'":h+="'"+m[l]+"',";this.setAPI("md.quote");this.setParam("fields",e[GQuoteSubscribe.inputParam.FIELDS]);this.setParam("condition","code in ("+
h+")");this.setParam("includeFlags",!0);f.call(this,e)}};this.clearParams=function(){b=a=null;g.call(this)}};$jscomp.inherits(GQuoteSubscribe,GRequestQuote);GQuoteSubscribe.inputParam={CODES:"codes",FIELDS:"fields"};
var GKLine=function(){GSeQuence.call(this);this.flagName="GKLine";var a=this.request,b=this.clearParams,f;this.setPeriod=function(g){this.setInputValue(GKLine.inputParam.PERIOD,g)};this.setCqMode=function(g){f=g;this.setInputValue(GKLine.inputParam.CQMODE,g)};this.getCqMode=function(){return f};this.setSubscribe=function(g){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,g)};this.setFields=function(g){this.setInputValue(GKLine.inputParam.FIELDS,g)};this.setDateRange=function(g,e){this.setInputValue(GKLine.inputParam.BEGINDATE,
g);this.setInputValue(GKLine.inputParam.ENDDATE,e)};this.request=function(){function g(p){switch(p){case "day":case "week":case "month":case "quarter":case "halfyear":case "year":return"md.quote/day";case "minute":return"md.quote/minute";case "minute5":return"md.quote/minute5";case "minute15":return"md.quote/minute15";case "minute30":return"md.quote/minute30";case "minute60":return"md.quote/minute60";case "minute120":return"md.quote/minute120"}}var e=this.checkParams();if(e){var h=e[GKLine.inputParam.PERIOD];
switch(h){case SDK_KLINE_PERIOD_1MINUTE:var m=g("minute");break;case SDK_KLINE_PERIOD_5MINUTES:m=g("minute5");break;case SDK_KLINE_PERIOD_15MINUTES:m=g("minute15");break;case SDK_KLINE_PERIOD_30MINUTES:m=g("minute30");break;case SDK_KLINE_PERIOD_60MINUTES:m=g("minute60");break;case SDK_KLINE_PERIOD_120MINUTES:m=g("minute120");break;case SDK_KLINE_PERIOD_DAY:case SDK_KLINE_PERIOD_WEEK:case SDK_KLINE_PERIOD_MONTH:case SDK_KLINE_PERIOD_QUARTER:case SDK_KLINE_PERIOD_YEAR:m=g("day");if("day"!=h)var l=
"freq='"+h+"', time='date', how='open:open, high:high,low:low,close:close'";break;default:return}this.setAPI(m);m=e[GKLine.inputParam.FIELDS];"$all"==m?this.setParam("fields","*"):this.setParam("fields",m);this.setParam("relations","factor,adjust:cq");this.setParam("resample",l);this.setParam("period",h);l=e[GSeQuence.inputParam.COUNT];if(0!==e[GSeQuence.inputParam.BEGIN]&&0!==l){l=new Date;m=String(l.getDate()).padStart(2,0);if([SDK_KLINE_PERIOD_1MINUTE,SDK_KLINE_PERIOD_5MINUTES,SDK_KLINE_PERIOD_15MINUTES,
SDK_KLINE_PERIOD_30MINUTES,SDK_KLINE_PERIOD_60MINUTES,SDK_KLINE_PERIOD_120MINUTES].includes(h)){var n=""+l.getFullYear()+String(l.getMonth()+1).padStart(2,0)+m;l.setMonth(l.getMonth()-3);h=""+l.getFullYear()+String(l.getMonth()+1).padStart(2,0)+m}else h="19700101";this.REQMODE=GKLINEREQMODE.REQ_LIMIT}else h=e[GKLine.inputParam.BEGINDATE],n=e[GKLine.inputParam.ENDDATE],e[GSeQuence.inputParam.BEGIN]=1,e[GSeQuence.inputParam.COUNT]=999999,this.REQMODE=GKLINEREQMODE.REQ_DATARANGE;h="date >= "+h;n&&(h+=
" and date <= "+n);this.setParam("date",h);this.setParam("includeFlags",!0);this.setParam("subscribe",e[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,e)}};this.clearParams=function(){f=null;b.call(this)};this.getFormulas=function(g,e){var h=GDataPackManager.sharedInstance().getDataPackWithId(this.getItemId());if(!h)return null;h=h.dataSourceResult;g=GEngineApply.sharedInstance().getFormulaData(h,g,e);g=JSON.parse(g);return GRequestManager.sharedInstance().createDataSet(g).dataSet}};
$jscomp.inherits(GKLine,GSeQuence);GKLine.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,PERIOD:"period",CQMODE:"cqMode",FIELDS:"fields",BEGINDATE:"beginDate",ENDDATE:"endDate"};
var GTrend=function(){GRequestQuote.call(this);this.flagName="GTrend";var a=this.request;this.setCode=function(b){this.setInputValue(GTrend.inputParam.CODE,b)};this.setFields=function(b){this.setInputValue(GTrend.inputParam.FIELDS,b)};this.setDays=function(b){this.setInputValue(GTrend.inputParam.DAYS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();if(b){this.setAPI("md.quote/trend");var f=b[GTrend.inputParam.FIELDS];
"$all"==f?this.setParam("fields","*"):this.setParam("fields",f);f=b[GTrend.inputParam.DAYS];1!=f?this.setParam("last",""+f):this.setParam("last",null);this.setParam("relations","exchTime");this.setParam("keys","'"+b[GTrend.inputParam.CODE]+"'");this.setParam("includeFlags",!0);this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,b)}};this.getFormulas=function(b,f){var g=GDataPackManager.sharedInstance().getDataPackWithId(this.getItemId());if(!g)return null;g=g.dataSourceResult;
b=GEngineApply.sharedInstance().getFormulaData(g,b,f);b=JSON.parse(b);return GRequestManager.sharedInstance().createDataSet(b).dataSet}};$jscomp.inherits(GTrend,GRequestQuote);GTrend.inputParam={CODE:"code",DAYS:"days",FIELDS:"fields"};
var GCallAution=function(){GRequestQuote.call(this);this.flagName="GCallAution";var a=this.request;this.setCode=function(b){this.setInputValue(GCallAution.inputParam.CODE,b)};this.setFields=function(b){this.setInputValue(GCallAution.inputParam.FIELDS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();if(b){this.setAPI("md.quote/auction");var f=b[GCallAution.inputParam.FIELDS];"$all"==f?this.setParam("fields",
"*"):this.setParam("fields",f);this.setParam("keys",b[GCallAution.inputParam.CODE]);this.setParam("includeFlags",!0);this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,b)}}};$jscomp.inherits(GCallAution,GRequestQuote);GCallAution.inputParam={CODE:"code",FIELDS:"fields"};
var GHisTrend=function(){GRequestQuote.call(this);this.flagName="GHisTrend";var a=this.request;this.setCode=function(b){this.setInputValue(GHisTrend.inputParam.CODE,b)};this.setDate=function(b){this.setInputValue(GHisTrend.inputParam.DATE,b)};this.setFields=function(b){this.setInputValue(GHisTrend.inputParam.FIELDS,b)};this.request=function(){var b=this.checkParams();if(b){this.setAPI("md.quote/trend");var f=b[GHisTrend.inputParam.FIELDS];"$all"==f?this.setParam("fields","*"):this.setParam("fields",
f);this.setParam("date","date = "+b[GHisTrend.inputParam.DATE]);this.setParam("relation","exchTime");this.setParam("keys","'"+b[GHisTrend.inputParam.CODE]+"'");this.setParam("includeFlags",!0);this.setParam("subscribe",!0);a.call(this,b)}}};$jscomp.inherits(GHisTrend,GRequestQuote);GHisTrend.inputParam={CODE:"code",DATE:"date",FIELDS:"fields"};
var GTick=function(){GSeQuence.call(this);this.flagName="GTick";this.fieldBackUp="";var a=this.request;this.setFields=function(b){this.setInputValue(GTick.inputParam.FIELDS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){this.fieldBackUp="";var b=this.checkParams();if(b){var f=b[GTick.inputParam.FIELDS].toLowerCase();if("$all"===f||"*"===f)f="time,price,volume,amount,deallots,stepbeginindex";f=f.split(",");for(var g=[],e=0;e<f.length;e++)"totaldeallots"!==
f[e]&&g.push(f[e]);f=g.join(",");if(-1!==g.indexOf("stepbeginindex")){this.fieldBackUp=f;f=[];for(e=0;e<g.length;e++)"stepbeginindex"!==g[e]&&f.push(g[e]);f.push("totaldeallots");-1===f.indexOf("deallots")&&f.push("deallots");f=f.join(",")}this.setParam("fields",f);this.setAPI("md.quote/tick");this.setParam("includeFlags",!0);this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,b)}}};$jscomp.inherits(GTick,GSeQuence);
GTick.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,FIELDS:"fields"};
var GPriceDistribution=function(){GSeQuence.call(this);this.flagName="GPriceDistribution";var a=this.request;this.setFields=function(b){this.setInputValue(GPriceDistribution.inputParam.FIELDS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();if(b){this.setAPI("md.quote/priceList");var f=b[GPriceDistribution.inputParam.FIELDS];"$all"==f?this.setParam("fields","*"):this.setParam("fields",f);this.setParam("includeFlags",
!0);this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,b)}}};$jscomp.inherits(GPriceDistribution,GSeQuence);GPriceDistribution.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,FIELDS:"fields"};
var GVolumeDistribution=function(){GRequestQuote.call(this);this.flagName="GVolumeDistribution";var a=this.request;this.setCode=function(b){this.setInputValue(GVolumeDistribution.inputParam.CODE,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();b&&(this.setParam("fields","Code,VolStatRangeArr,VolStatBuyVolArr,VolStatSellVolArr,VolStatNeuVolArr,VolStatBSVolMax"),this.setAPI("md.quote"),this.setParam("includeFlags",
!0),this.setParam("condition","code = '"+b[GVolumeDistribution.inputParam.CODE]+"'"),this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]),a.call(this,b))}};$jscomp.inherits(GVolumeDistribution,GRequestQuote);GVolumeDistribution.inputParam={CODE:"code"};
var GStep=function(){GSeQuence.call(this);this.flagName="GStep";this._isWITHDRAWAL=!1;this.levelFlag=null;this.confirmFields=[];var a=this.request;this.setFields=function(b){var f=this,g=STEPALLORDERFIELDS.map(function(e){return e[0].toLowerCase()});this.confirmFields=[];this.setInputValue(GStep.inputParam.FIELDS,b);"$all"===b?this.confirmFields=[].concat($jscomp.arrayFromIterable(g)):b.split(",").forEach(function(e){e=e.trim().toLowerCase();g.includes(e)&&f.confirmFields.push(e)})};this.setWithdrawal=
function(b){this._isWITHDRAWAL=b};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();b&&(b=GRequestManager.sharedInstance().getQueryLevel(b[GVolumeDistribution.inputParam.CODE]),this.promotionOrDemotion(b?b:QUOTELEVEL2,!0))};this.promotionOrDemotion=function(b,f){if(f||this.levelFlag!==b){this.levelFlag=b;f=this.getInputValue();var g=f[GStep.inputParam.FIELDS];"$all"==g?this.setParam("fields","*"):this.setParam("fields",
g);b===QUOTELEVEL1?this.setAPI("md.quote/tick"):b===QUOTELEVEL2&&this.setAPI("md.quote/step");this.setParam("includeFlags",!0);this.setParam("subscribe",f[GRequestQuote.inputParam.SUBSCRIBE]);a.call(this,f)}}};$jscomp.inherits(GStep,GSeQuence);GStep.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,FIELDS:"fields",WITHDRAWAL:"withdrawal"};
var GCancelOrder=function(){GSeQuence.call(this);this.flagName="GCancelOrder";var a=this.request;this.setFields=function(b){this.setInputValue(GCancelOrder.inputParam.FIELDS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){if(this.checkParams()){var b=this.getInputValue(),f=b[GCancelOrder.inputParam.FIELDS];"string"===typeof f?""===f?this.setParam("fields","time,CancelOrderNumber,price,volume"):this.setParam("fields",f):this.setParam("fields",
"time,CancelOrderNumber,price,volume");this.setAPI("md.quote/cancelorder");this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);this.setParam("includeFlags",!0);a.call(this,b)}}};$jscomp.inherits(GCancelOrder,GSeQuence);GCancelOrder.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,FIELDS:"fields"};
var GOrder=function(){GSeQuence.call(this);this.flagName="GOrder";var a=this.request;this.setFields=function(b){this.setInputValue(GOrder.inputParam.FIELDS,b)};this.setSubscribe=function(b){this.setInputValue(GRequestQuote.inputParam.SUBSCRIBE,b)};this.request=function(){var b=this.checkParams();if(b){var f=b[GOrder.inputParam.FIELDS];"$all"==f?this.setParam("fields","*"):this.setParam("fields",f);this.setAPI("md.quote/order");this.setParam("includeFlags",!0);this.setParam("subscribe",b[GRequestQuote.inputParam.SUBSCRIBE]);
a.call(this,b)}}};$jscomp.inherits(GOrder,GSeQuence);GOrder.inputParam={CODE:GSeQuence.inputParam.CODE,BEGIN:GSeQuence.inputParam.BEGIN,COUNT:GSeQuence.inputParam.COUNT,FIELDS:"fields"};
var GTradeQueue=function(){GRequestQuote.call(this);this.flagName="GTradeQueue";var a=this.request;this.setCode=function(b){this.setInputValue(GTradeQueue.inputParam.CODE,b)};this.setType=function(b){this.setInputValue(GTradeQueue.inputParam.TYPE,b)};this.request=function(){var b=this.checkParams();if(b){var f=b[GTradeQueue.inputParam.TYPE];f==SDK_TRADEQUEUE_TYPE_ALL?this.setParam("fields","AskVolumeQueue,BidVolumeQueue"):f==SDK_TRADEQUEUE_TYPE_ASK?this.setParam("fields","AskVolumeQueue"):this.setParam("fields",
"BidVolumeQueue");this.setAPI("md.quote");this.setParam("includeFlags",!0);this.setParam("condition","code = '"+b[GTradeQueue.inputParam.CODE]+"'");a.call(this,b)}}};$jscomp.inherits(GTradeQueue,GRequestQuote);GTradeQueue.inputParam={CODE:"code",TYPE:"type"};
var GMoneyFlow=function(){GRequestQuote.call(this);this.flagName="GMoneyFlow";var a=this.request;this.setCode=function(b){this.setInputValue(GMoneyFlow.inputParam.CODE,b)};this.request=function(){var b=this.checkParams();b&&(this.setParam("fields","Code,Sell_List,Buy_List,MainFundsNetinFlow"),this.setAPI("dd.quote"),this.setParam("includeFlags",!0),this.setParam("condition","code = '"+b[GMoneyFlow.inputParam.CODE]+"'"),a.call(this,b))}};$jscomp.inherits(GMoneyFlow,GRequestQuote);
GMoneyFlow.inputParam={CODE:"code"};var GUpDownDistribution=function(){GRequestQuote.call(this);this.flagName="GUpDownDistribution";var a=this.request;this.setCode=function(b){this.setInputValue(GUpDownDistribution.inputParam.CODE,b)};this.request=function(){var b=this.checkParams();b&&(this.setAPI("dd.quote"),this.setParam("fields","Code,RiseCount,SuspensionCount,FallCount,ScopeName,ScopeValue"),this.setParam("condition","code = '"+b[GUpDownDistribution.inputParam.CODE]+"'"),a.call(this,b))}};
$jscomp.inherits(GUpDownDistribution,GRequestQuote);GUpDownDistribution.inputParam={CODE:"code"};
var GSort=function(){GRequestQuote.call(this);this.flagName="GSort";var a=this.request;this.setSectorId=function(b){this.setInputValue(GSort.inputParam.SECTORID,b)};this.setCodes=function(b){this.setInputValue(GSort.inputParam.CODES,b)};this.setSortField=function(b,f){this.setInputValue(GSort.inputParam.SORTFIELD,b);this.setInputValue(GSort.inputParam.SORTTYPE,f)};this.setLimit=function(b,f){this.setInputValue(GSort.inputParam.BEGIN,b);this.setInputValue(GSort.inputParam.COUNT,f)};this.request=function(){var b=
this.checkParams();if(b){this.setAPI("md.quote");this.setParam("fields","code");var f="",g=b[GSort.inputParam.CODES],e=b[GSort.inputParam.SECTORID];if(null!=g){g=g.split(",");for(var h=0;h<g.length;h++)h==g.length-1?f+="'"+g[h]+"'":f+="'"+g[h]+"',"}this.setParam("condition",e?"code in (select code from rd.sector/composition('"+e+"'))":"code in ("+f+")");f=null;e=b[GSort.inputParam.SORTTYPE];g=b[GSort.inputParam.SORTFIELD];if(e==SDK_SORTTYPE_ASC||e==SDK_SORTTYPE_DESC)f=g+" "+e;e=b[GSort.inputParam.BEGIN];
g=b[GSort.inputParam.COUNT];this.setParam("orderby",f);this.setParam("limit",e+","+g);a.call(this,b)}}};$jscomp.inherits(GSort,GRequestQuote);GSort.inputParam={SECTORID:"sectorId",CODES:"codes",SORTFIELD:"sortField",SORTTYPE:"sortType",BEGIN:"begin",COUNT:"count"};
var GSectorConstituents=function(){GRequestQuote.call(this);this.flagName="GSectorConstituents";var a=this.request;this.setSectorId=function(b){this.setInputValue(GSectorConstituents.inputParam.SECTORID,b)};this.setLimit=function(b,f){this.setInputValue(GSectorConstituents.inputParam.BEGIN,b);this.setInputValue(GSectorConstituents.inputParam.COUNT,f)};this.request=function(){var b=this.checkParams();b&&(this.setParam("fields","code,name"),this.setAPI("md.quote"),this.setParam("condition","code in (select code from rd.sector/composition('"+
b[GSectorConstituents.inputParam.SECTORID]+"'))"),this.setParam("limit",b[GSectorConstituents.inputParam.BEGIN]+","+b[GSectorConstituents.inputParam.COUNT]),a.call(this,b))}};$jscomp.inherits(GSectorConstituents,GRequestQuote);GSectorConstituents.inputParam={SECTORID:"sectorId",BEGIN:"begin",COUNT:"count"};
var GIndexToSector=function(){GRequestQuote.call(this);this.flagName="GIndexToSector";var a=this.request;this.setCode=function(b){this.setInputValue(GIndexToSector.inputParam.CODE,b)};this.request=function(){var b=this.checkParams();if(b){var f=b[GIndexToSector.inputParam.CODE];this.setParam("fields","code,id,name");this.setAPI("rd.indexs");this.setParam("condition","code = '"+f+"'");a.call(this,b)}}};$jscomp.inherits(GIndexToSector,GRequestQuote);GIndexToSector.inputParam={CODE:"code"};
var GKLINEREQMODE=Object.freeze({REQ_LIMIT:1,REQ_DATARANGE:2}),paramCheckOption=Object.create({GQuoteSubscribe:{codes:{must:!0,type:EnumParamType.STRING,condition:{type:["check","array"],split:",",reg:/^([0-9a-z]+\.[0-9a-z]+,)*[0-9a-z]+\.[0-9a-z]+$/i,max:1E3}},fields:{must:!0,type:EnumParamType.STRING}},GUpDownDistribution:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}}},GKLine:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},
period:{must:!0,type:EnumParamType.STRING,condition:{type:"normal",matchValue:[SDK_KLINE_PERIOD_1MINUTE,SDK_KLINE_PERIOD_5MINUTES,SDK_KLINE_PERIOD_15MINUTES,SDK_KLINE_PERIOD_30MINUTES,SDK_KLINE_PERIOD_60MINUTES,SDK_KLINE_PERIOD_120MINUTES,SDK_KLINE_PERIOD_DAY,SDK_KLINE_PERIOD_WEEK,SDK_KLINE_PERIOD_MONTH,SDK_KLINE_PERIOD_QUARTER,SDK_KLINE_PERIOD_YEAR]}},cqMode:{must:!0,type:EnumParamType.STRING,condition:{type:"normal",matchValue:[SDK_KLINE_CQMODE_BACKWARD,SDK_KLINE_CQMODE_FORWARD,SDK_KLINE_CQMODE_NONE]}},
fields:{must:!1,type:EnumParamType.STRING,default:"$all"},beginDate:{must:!0,type:EnumParamType.STRING,condition:{type:"date",min:"19700101",lessEqual:"endDate"},union:["begin"],group:["endDate"],default:"-1"},endDate:{must:!0,type:EnumParamType.STRING,condition:{type:"date",min:"19700101"},union:["count"],group:["beginDate"],default:"-1"},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]},union:["beginDate"],group:["count"],default:0},count:{must:!0,type:EnumParamType.INTEGER,
condition:{min:1},union:["endDate"],group:["begin"],default:0},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GTrend:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},days:{must:!1,type:EnumParamType.INTEGER,condition:{min:1,max:10},default:1},fields:{must:!1,type:EnumParamType.STRING,default:"$all"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GCallAution:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},
fields:{must:!1,type:EnumParamType.STRING,default:"$all"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GHisTrend:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},date:{must:!0,type:EnumParamType.STRING,condition:{type:"date"}},fields:{must:!1,type:EnumParamType.STRING,default:"$all"}},GTradeQueue:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},type:{must:!1,type:EnumParamType.STRING,condition:{type:"normal",
matchValue:[SDK_TRADEQUEUE_TYPE_ALL,SDK_TRADEQUEUE_TYPE_ASK,SDK_TRADEQUEUE_TYPE_BID]},default:SDK_TRADEQUEUE_TYPE_ALL}},GOrder:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}},fields:{must:!1,type:EnumParamType.STRING,default:"$all"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GStep:{code:{must:!0,
type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}},fields:{must:!1,type:EnumParamType.STRING,default:"$all"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GCancelOrder:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,
specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}},fields:{must:!1,type:EnumParamType.STRING,default:"time,CancelOrderNumber,price,volume",condition:{invalid:["$all","*"]}},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GTick:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,
max:200}},fields:{must:!1,type:EnumParamType.STRING,default:"Time,Price,Volume"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GPriceDistribution:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}},fields:{must:!1,type:EnumParamType.STRING,default:"$all"},subscribe:{must:!1,type:EnumParamType.BOOLEAN,
default:!0}},GSectorConstituents:{sectorId:{must:!0,type:EnumParamType.STRING},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}}},GIndexToSector:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}}},GSort:{sectorId:{must:!0,union:["codes"],type:EnumParamType.STRING},codes:{must:!0,union:["sectorId"],type:EnumParamType.STRING,condition:{type:["check"],reg:/^([0-9a-z]+\.[0-9a-z]+,)*[0-9a-z]+\.[0-9a-z]+$/i}},
sortField:{must:!0,type:EnumParamType.STRING,condition:{type:"normal",matchValue:{value:"code name time tradingday volume amount percentchange last low high open preclose change pctchg_5m amplitude lotsize highlimit lowlimit deallots askprice1 bidprice1 askvolume1 bidvolume1 askvolumedelta1 bidvolumedelta1 askprice2 bidprice2 askvolume2 bidvolume2 askvolumedelta2 bidvolumedelta2 askprice3 bidprice3 askvolume3 bidvolume3 askvolumedelta3 bidvolumedelta3 askprice4 bidprice4 askvolume4 bidvolume4 askvolumedelta4 bidvolumedelta4 askprice5 bidprice5 askvolume5 bidvolume5 askvolumedelta5 bidvolumedelta5 iopv vwap volumedelta volumeratio pctchg_1m pctchg_15m buyvolume sellvolume sellbuyratio askordernumber bidordernumber lastshare netvalue interest clearingprice bidorderlots askorderlots prevclearingprice prevcontractposition contractposition risecount fallcount suspensioncount component_num marketvalue floatvalue mainfundsnetinflow blockid pb eps pe_ttm turnoverrate pctchg_ytd pctchg_3d pctchg_5d pctchg_10d pctchg_20d pctchg_60d pctchg_120d pctchg_250d mainfundsrate float totalshare floatvalueopen floatvaluepreclose low_52w high_52w listeddays floatvalueavg adjudgedmv avgvol5 naps premiumrate".split(" "),
ignoreCase:!0}}},sortType:{must:!0,type:EnumParamType.STRING,condition:{type:"normal",matchValue:[SDK_SORTTYPE_ASC,SDK_SORTTYPE_DESC,SDK_SORTTYPE_NONE]}},begin:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,specialArr:[-1]}},count:{must:!0,type:EnumParamType.INTEGER,condition:{min:1,max:200}},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GKeyWizard:{category:{must:!1,type:EnumParamType.STRING,default:SDK_KEYWIZARD_CATEGORY_ALL,condition:{type:"normal",matchValue:[SDK_KEYWIZARD_CATEGORY_ALL,
SDK_KEYWIZARD_CATEGORY_STOCK,SDK_KEYWIZARD_CATEGORY_INDEX,SDK_KEYWIZARD_CATEGORY_FUND,SDK_KEYWIZARD_CATEGORY_BOND,SDK_KEYWIZARD_CATEGORY_OPTION],mapValue:"012345".split("")}},market:{must:!1,type:EnumParamType.STRING,default:SDK_KEYWIZARD_MARKET_SHSZHK,condition:{type:"normal",matchValue:[SDK_KEYWIZARD_MARKET_SHSZHK],mapValue:["1"]}},fields:{must:!1,type:EnumParamType.STRING,default:"sufSecuCode,secuAbbr"},pageNo:{must:!0,type:EnumParamType.INTEGER,condition:{min:0}},pageSize:{must:!0,type:EnumParamType.INTEGER,
condition:{min:1}}},GVolumeDistribution:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}},subscribe:{must:!1,type:EnumParamType.BOOLEAN,default:!0}},GMoneyFlow:{code:{must:!0,type:EnumParamType.STRING,condition:{type:"check",reg:/^[0-9a-z]+\.[0-9a-z]+$/i}}},NStockInfo:{codes:{must:!0,type:EnumParamType.STRING,condition:{type:["check","array"],split:",",reg:/^([0-9a-z]+\.[0-9a-z]+,)*[0-9a-z]+\.[0-9a-z]+$/i}},fields:{must:!0,type:EnumParamType.STRING}},
GQuoteStatic:{codes:{must:!0,type:EnumParamType.STRING,condition:{type:["check","array"],split:",",reg:/^([0-9a-z]+\.[0-9a-z]+,)*[0-9a-z]+\.[0-9a-z]+$/i,max:1E3}},fields:{must:!0,type:EnumParamType.STRING}},GSimpleSnapshot:{codes:{must:!0,type:EnumParamType.STRING,condition:{type:["check","array"],split:",",reg:/^([0-9a-z]+\.[0-9a-z]+,)*[0-9a-z]+\.[0-9a-z]+$/i,max:4E3}},fields:{must:!0,type:EnumParamType.STRING}}});
function Calibration(a){function b(e){if(null!=NSDK_HOOK.getOnCallback())NSDK_HOOK.getOnCallback()(e);else{var h=new GResponse;h.itemId=e.id;h.data=e.data;h.seqId=e.seqId;h.statusCode=e.code;h.success=e.status;h.msg=e.msg;f.getDataCallback()&&f.getDataCallback()(h);NSDKLog.error("SZSE:(GRequestQuote.sendToClient)"+h.msg)}}var f=a,g={id:-1,data:{},seqId:"-1",code:STATU_CODE.MAINQUOTE_PARAM_CHECK_FAIL,status:!1,msg:""};this.check=function(e){var h={},m=paramCheckOption[f.flagName],l;for(l in m){var n=
m[l],p=CheckMustParams(e,l,n.union);if(1==n.must&&!p){g.id=f.getItemId();if(null!=n.union){e=n.union;for(h=0;h<e.length;h++)l+=","+e[h];g.msg=l+"\u53c2\u6570\u4e0d\u80fd\u540c\u65f6\u4e3a\u7a7a"}else g.msg=l+"\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a";b(g);GDataManager.sharedInstance().clearLastMsg(f.getItemId());return!1}if(p&&null!=e[l]){p=CheckInputParam(l,e[l],n.type,n.condition,e);if(n.group){n=n.group;for(var q=0;q<n.length;q++){var v=m[n[q]];v=CheckInputParam(n[q],e[n[q]],v.type,v.condition,e);
if(0==v.status)return g.id=f.getItemId(),g.msg=v.msg,b(g),GDataManager.sharedInstance().clearLastMsg(f.getItemId()),!1}}if(0==p.status)return g.id=f.getItemId(),g.msg=p.msg,b(g),GDataManager.sharedInstance().clearLastMsg(f.getItemId()),!1;h[l]=p.value}else null!=n.default&&(h[l]=n.default)}return h}}
var GQuoteStatic=function(){GRequestQuote.call(this);this.flagName="GQuoteStatic";var a=null,b=null,f=this.request,g=this.clearParams;this.setCodes=function(e){a=e;this.setInputValue(GQuoteStatic.inputParam.CODES,a)};this.addCodes=function(e){var h=null==a?[]:a.split(",");e=e.split(",");for(var m=0;m<e.length;m++)-1==h.indexOf(e[m])&&h.push(e[m]);a=h.toString();this.setInputValue(GQuoteStatic.inputParam.CODES,a)};this.delCodes=function(e){var h=null==a?[]:a.split(",");e=e.split(",");for(var m=0;m<
e.length;m++){var l=h.indexOf(e[m]);-1!=l&&h.splice(l,1)}a=h.toString();this.setInputValue(GQuoteStatic.inputParam.CODES,a)};this.setFields=function(e){b=e.toLocaleLowerCase();this.setInputValue(GQuoteStatic.inputParam.FIELDS,b)};this.addFields=function(e){var h=null==b?[]:b.split(",");e=e.toLocaleLowerCase().split(",");for(var m=0;m<e.length;m++)-1==h.indexOf(e[m])&&h.push(e[m]);b=h.toString();this.setInputValue(GQuoteStatic.inputParam.FIELDS,b)};this.delFields=function(e){var h=null==b?[]:b.split(",");
e=e.toLocaleLowerCase().split(",");for(var m=0;m<e.length;m++){var l=h.indexOf(e[m]);-1!=l&&h.splice(l,1)}b=h.toString();this.setInputValue(GQuoteStatic.inputParam.FIELDS,b)};this.request=function(){var e=this.checkParams();if(e){for(var h="",m=e[GQuoteStatic.inputParam.CODES].split(","),l=0;l<m.length;l++)l==m.length-1?h+="'"+m[l]+"'":h+="'"+m[l]+"',";this.setAPI("quoteStatic");this.setParam("fields",e[GQuoteStatic.inputParam.FIELDS]);this.setParam("condition","code in ("+h+")");this.setParam("includeFlags",
!0);f.call(this,e)}};this.clearParams=function(){b=a=null;g.call(this)}};$jscomp.inherits(GQuoteStatic,GRequestQuote);GQuoteStatic.inputParam={CODES:"codes",FIELDS:"fields"};
var GSimpleSnapshot=function(){GRequestQuote.call(this);this.flagName="GSimpleSnapshot";var a=null,b=null,f=this.request,g=this.clearParams;this.setCodes=function(e){a=e;this.setInputValue(GSimpleSnapshot.inputParam.CODES,a)};this.setFields=function(e){b=e.toLocaleLowerCase();this.setInputValue(GSimpleSnapshot.inputParam.FIELDS,b)};this.request=function(){var e=this.checkParams();if(e){for(var h="",m=e[GSimpleSnapshot.inputParam.CODES].split(","),l=0;l<m.length;l++)l==m.length-1?h+="'"+m[l]+"'":h+=
"'"+m[l]+"',";this.setAPI("simpleSnapshot");m=e[GSimpleSnapshot.inputParam.FIELDS];"$all"===m?this.setParam("fields","*"):this.setParam("fields",m);this.setParam("condition","code in ("+h+")");this.setParam("includeFlags",!0);f.call(this,e)}};this.clearParams=function(){b=a=null;g.call(this)}};$jscomp.inherits(GSimpleSnapshot,GRequestQuote);GSimpleSnapshot.inputParam={CODES:"codes",FIELDS:"fields"};var GRequestCustomQuote=function(){var a={},b=null,f=null,g=""+NSDK.count++;this.dataStatus;this.firstCallbackFlag=!0;this.setDataCallback=function(e){NSDKLog.info("SZSE:(GRequestCustomQuote.setDataCallback)\u8bbe\u7f6e\u6570\u636e\u56de\u8c03");f=e};this.setAPI=function(e){b=e};this.setParam=function(e,h){a[e]=h};this.request=function(){this.firstCallbackFlag=!0;GDataManager.sharedInstance().cancelPushData(g);this.dataStatus=null;var e={type:CONNECT_TYPE.CUSTOM_WS_TYPE,itemId:g,seqId:0,url:b,params:xDeepCopy(a),
subscribe:!0};GDataManager.sharedInstance().fireData(e);return 0};this.clearParams=function(){b=null;a={}};this.cancel=function(){GDataManager.sharedInstance().cancelPushData(g)};this.getDataCallback=function(){return f};this.getItemId=function(){return g};this.getRequestValue=function(){return a}};function NSDKInfo(){this.version="v1.3.0"}function GMessage(){this.message;this.code}function GLog(){this.level;this.msg;this.time}
var DEVICETYPE=Object.freeze({PC:201,MOBILE:101,UNKNOW:999}),STATU_CODE=Object.freeze({MAINQUOTE_CONNECT_SUCCESS:MAINQUOTE_CONNECT_SUCCESS,MAINQUOTE_DISCONNECT_NORMAL:MAINQUOTE_DISCONNECT_NORMAL,MAINQUOTE_DISCONNECT_ABNORMAL:MAINQUOTE_DISCONNECT_ABNORMAL,MAINQUOTE_CONNECT_FAILED:MAINQUOTE_CONNECT_FAILED,MAINQUOTE_DISCONNECT_FAILED:MAINQUOTE_DISCONNECT_FAILED,MAINQUOTE_CONN_CLOSED_BY_HOST:MAINQUOTE_CONN_CLOSED_BY_HOST,MAINQUOTE_RECONNECT_FAILED:MAINQUOTE_RECONNECT_FAILED,HTTPLOGIN_CHANGE_WEBSITE_FAILED:HTTPLOGIN_CHANGE_WEBSITE_FAILED,
MAINQUOTE_RECONNECT_SUCCESS:MAINQUOTE_RECONNECT_SUCCESS,SERVER_ERROR:SERVER_ERROR,MAINQUOTE_REFRESH_TOKEN_INVALID:MAINQUOTE_REFRESH_TOKEN_INVALID,MAINQUOTE_SYS_MSG:MAINQUOTE_SYS_MSG,MAINQUOTE_KICK_EACH_OTHER:MAINQUOTE_KICK_EACH_OTHER,MAINQUOTE_UNKNOW_CODE:MAINQUOTE_UNKNOW_CODE,MAINQUOTE_PARAM_CHECK_FAIL:MAINQUOTE_PARAM_CHECK_FAIL,MAINQUOTE_CONNECT_SIGN_FAILED:MAINQUOTE_CONNECT_SIGN_FAILED,HTTPLOGIN_RELOGIN:HTTPLOGIN_RELOGIN,HTTPLOGIN_CHANGE_WEBSITE:HTTPLOGIN_CHANGE_WEBSITE,HTTPREQUEST_ERROR_RETRY:HTTPREQUEST_ERROR_RETRY,
HTTPREQUEST_QUIT:HTTPREQUEST_QUIT,SUBSCRIBE_LIMIT:SUBSCRIBE_LIMIT,MAINQUOTE_UNUSE:MAINQUOTE_UNUSE,HTTOLOGIN_RECONNECT:HTTOLOGIN_RECONNECT});
function GStatus(){var a=this,b=0,f=0;this.listeners={};this.clearStatus=function(){this.auth=this.status=0};Object.defineProperty(this,"status",{set:function(g){var e={type:"status",value:g,oldValue:b};b=g;a.dispatchEvent(e)},get:function(){return b}});Object.defineProperty(this,"auth",{set:function(g){var e={type:"auth",value:g,oldValue:f};f=g;a.dispatchEvent(e)},get:function(){return f}});this.addEventListener=function(g,e){g in this.listeners||(this.listeners[g]=[]);this.listeners[g].push(e)};
this.removeEventListener=function(g,e){if(g in this.listeners)for(var h=this.listeners[g],m=0,l=h.length;m<l;m++)if(h[m]===e)return h.splice(m,1),this.removeEventListener(g,e)};this.dispatchEvent=function(g){if(g.type in this.listeners){var e=this.listeners[g.type];g.target=this;for(var h=0,m=e.length;h<m;h++)e[h].call(this,g)}}}
var NSDK=function(){var a={},b=new NSDKInfo,f=new GStatus;a.count=0;a.requestId=0;var g=null,e=null,h=null,m=!1;a.setNotificationCallback=function(l){NSDKLog.info("SZSE:(NSDK.setNotificationCallback)\u8bbe\u7f6e\u901a\u77e5\u56de\u8c03");g=l};a.setRealLogCallback=function(l){NSDKLog.info("SZSE:(NSDK.setRealLogCallback)\u8bbe\u7f6e\u65e5\u5fd7\u56de\u8c03");e=l};a.setSignCallback=function(l){NSDKLog.info("SZSE:(NSDK.setSignCallback)\u8bbe\u7f6e\u7b7e\u540d\u56de\u8c03");h=l};a.getNotification=function(){return g};
a.getRealLog=function(){return e};a.getSignFunction=function(){return h};a.getInfo=function(){return b};a.setSDKVersion=function(l){l.env&&l.version&&(this.platformSDKVersion=l)};a.getSDKVersion=function(){return this.platformSDKVersion?this.platformSDKVersion:{env:"web",version:"SDK-web-"+a.getInfo().version}};a.getConnect=function(){return f};a.connect=function(l,n,p,q){p=void 0===p?"default":p;q=void 0===q?null:q;if(m){var v,u,D;if((null==(v=q)?0:v.deviceId)&&"string"===typeof(null==(u=q)?void 0:
u.deviceId)&&""!==(null==(D=q)?void 0:D.deviceId)){var F;if(64<(null==(F=q)?void 0:F.deviceId.length))GSession.sharedInstance().pushMsg("\u8bbe\u5907ID\u957f\u5ea6\u8d85\u51fa\u4e0a\u9650",STATU_CODE.MAINQUOTE_CONNECT_FAILED);else if(NSDKLog.info("SZSE:(NSDK.connect)\u5f00\u59cb\u8fde\u63a5"),v=GSession.sharedInstance(),v.getConnectedFlag())NSDKLog.error("SZSE:(NSDK.connect)SDK\u91cd\u590d\u8fde\u63a5");else{v.setConnectedFlag(!0);NSDKLog.info("SZSE:(NSDK.connect)\u8fde\u63a5\u4fe1\u606f: "+JSON.stringify({userid:l,
authServer:p,other:q}));l={userId:l,accessToken:n,env:p};if(null!=q)for(var z in q)null!=q[z]&&"devicetype"!==z.toLowerCase()&&(l[z]=q[z]);v.login(l)}}else GSession.sharedInstance().pushMsg("\u8bbe\u5907ID\u4e0d\u80fd\u4e3a\u7a7a",STATU_CODE.MAINQUOTE_CONNECT_FAILED)}else GSession.sharedInstance().pushMsg("\u5efa\u7acb\u884c\u60c5\u8fde\u63a5\u5931\u8d25\uff1a\u65e0\u6548\u7684\u73af\u5883\u7c7b\u578b\u9009\u9879",STATU_CODE.MAINQUOTE_CONNECT_FAILED)};a.disconnect=function(){GSession.sharedInstance().loginOut();
NSDKLog.info("SZSE:(NSDK.disconnect)\u65ad\u5f00\u8fde\u63a5")};a.createRequestItem=function(l){try{NSDKLog.info("SZSE:(NSDK.createRequestItem) \u5f53\u524d\u8bf7\u6c42\u6570\u91cf\uff1a"+GRequestManager.getAllRequestItems().length);NSDKLog.info("SZSE:(NSDK.createRequestItem)\u5f00\u59cb\u521b\u5efa\u8bf7\u6c42\u5bf9\u8c61: "+l);var n=getEnvInfo();switch(l){case SDK_REQUEST_CUSTOMQUOTE:var p=new GRequestCustomQuote;break;case SDK_REQUEST_QUOTESUBSCRIBE:p=new GQuoteSubscribe;break;case SDK_REQUEST_UPDOWNDISTRIBUTION:p=
new GUpDownDistribution;break;case SDK_REQUEST_KLINE:p=new GKLine;break;case SDK_REQUEST_TICK:p=new GTick;break;case SDK_REQUEST_PRICEDISTRIBUTION:p=new GPriceDistribution;break;case SDK_REQUEST_TREND:p=new GTrend;break;case SDK_REQUEST_CALLAUTION:p=new GCallAution;break;case SDK_REQUEST_HISTREND:p=new GHisTrend;break;case SDK_REQUEST_SORT:p=new GSort;break;case SDK_REQUEST_SECTORCONSTITUENTS:p=new GSectorConstituents;break;case SDK_REQUEST_INDEXTOSECTOR:p=new GIndexToSector;break;case SDK_REQUEST_REQUESTCOMMON:p=
new GRequestCommon;break;case SDK_REQUEST_KEYWIZARD:p=new GKeyWizard;break;case SDK_REQUEST_STEP:p=new GStep;break;case SDK_REQUEST_CANCELORDER:p=new GCancelOrder;break;case SDK_REQUEST_ORDER:p=new GOrder;break;case SDK_REQUEST_TRADEQUEUE:p=new GTradeQueue;break;case SDK_REQUEST_VOLUMEDISTRIBUTION:p=new GVolumeDistribution;break;case SDK_REQUEST_MONEYFLOW:p=new GMoneyFlow;break;case SDK_REQUEST_NSTOCKINFO:p=new NStockInfo;break;case SDK_REQUEST_QUOTESTATIC:p=new GQuoteStatic;break;case SDK_REQUEST_GSIMPLESNAPSHOT:p=
new GSimpleSnapshot;break;default:console.info("SZSE:(NSDK.createRequestItem)\u6682\u4e0d\u63d0\u4f9b\u8bf7\u6c42\u5bf9\u8c61: "+l)}if(null!=p)return NSDKLog.info("SZSE:(NSDK.createRequestItem)\u8bf7\u6c42\u5bf9\u8c61\u521b\u5efa\u6210\u529f: {className:"+l+", itemId: "+p.getItemId()+"}"),GRequestManager.addItems(p),"web"!=n?{id:p.getItemId()}:p;NSDKLog.info("SZSE:(NSDK.createRequestItem)\u8bf7\u6c42\u5bf9\u8c61\u521b\u5efa\u5931\u8d25: "+l)}catch(q){NSDKLog.info("SZSE:(NSDK.createRequestItem)\u8bf7\u6c42\u5bf9\u8c61\u521b\u5efa\u5931\u8d25: "+
l+", \u5ef6\u8fdf 1s \u91cd\u65b0\u521b\u5efa"),setTimeout(function(){return a.createRequestItem(l)},1E3)}};a.destroyRequestItem=function(l){"sysmsg"!==l.getItemId()&&(NSDKLog.info("SZSE:(NSDK.destroyRequestItemById) \u5f53\u524d\u8bf7\u6c42\u6570\u91cf\uff1a"+GRequestManager.getAllRequestItems().length),NSDKLog.info("SZSE:(NSDK.destroyRequestItem)\u5f00\u59cb\u9500\u6bc1\u8bf7\u6c42\u5bf9\u8c61: "+((null==l?void 0:l.getItemId)&&l.getItemId())),null!=l&&null!=l.getItemId()&&a.destroyRequestItemById(l.getItemId()))};
a.destroyRequestItemById=function(l){NSDKLog.info("SZSE:(NSDK.destroyRequestItemById)\u6839\u636eid\u9500\u6bc1\u8bf7\u6c42\u5bf9\u8c61: "+l);if(null!=l){GRequestManager.deleteItemsWithId(l);var n=GDataPackManager.sharedInstance().delDataPackWithId(l);NSDKLog.info("SZSE:(NSDK.destroyRequestItemById)\u6839\u636e id \u9500\u6bc1\u8bf7\u6c42\u5bf9\u8c61\uff0c"+(n?"\u6210\u529f":"\u5931\u8d25")+": "+l)}};a.stopSubscribe=function(l){var n=a.getRequestItemsById(l);n=n?n:l;NSDKLog.info("SZSE:(NSDK.stopSubscribe)\u8bf7\u6c42\u5bf9\u8c61\u53d6\u6d88\u8ba2\u9605");
n.stop&&n.stop()};a.getAllRequestItems=function(){NSDKLog.info("SZSE:(NSDK.getAllRequestItems)\u83b7\u53d6\u6240\u6709\u8bf7\u6c42\u5bf9\u8c61");return GRequestManager.getAllRequestItems()};a.clearAllRequestItems=function(){NSDKLog.info("SZSE:(NSDK.clearAllRequestItems)\u6e05\u7a7a\u6240\u6709\u8bf7\u6c42\u5bf9\u8c61");for(var l=GRequestManager.sharedInstance().requestList,n=Object.keys(l),p=0;p<n.length;p++)a.destroyRequestItem(l[n[p]])};a.getRequestItemsById=function(l){return GRequestManager.getItemsWithId(l)};
a.enableSSL=function(l){GSession.isUseSSL=l};a.addEnvType=function(l){l=void 0===l?[]:l;NSDKLog.info("SZSE:(NSDK.addEnvType)\u6dfb\u52a0\u73af\u5883\u7c7b\u578b: "+JSON.stringify(l));GEnvConfig.addEnvType(l)};a.setEnvType=function(l){NSDKLog.info("SZSE:(NSDK.setEnvType)\u8bbe\u7f6e\u73af\u5883\u7c7b\u578b: "+l);return[].concat($jscomp.arrayFromIterable(GEnvConfig.envTypeNameList)).includes(l)?(GSession.envType=l,m=!0):m=!1};a.getAllEnvConfig=function(){var l=Object.assign({},GEnvConfig.config),n=
[],p;for(p in l){var q=l[p];n.push({name:p,httpHostName:q.httpHostName,wsHostName:q.wsHostName,customWsHostName:q.customWsHostName,siteList:q.siteList.map(function(v){return v.siteUrl})})}return n};a.stopWsConnectWait=function(){GQuoteWs.sharedInstance().stopWsConnectWait()};return a}();
